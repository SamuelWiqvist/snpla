Input args:
Dim: 2
seed: 47
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1552, grad_fn=<MeanBackward0>)
tensor(2.7396, grad_fn=<MeanBackward0>)
tensor([ 0.0218, -0.0874, -0.2130,  0.1275,  0.1864, -0.0495,  0.0977,  0.1348,
         0.0486,  0.0569], grad_fn=<MeanBackward1>)
tensor([1.0951, 1.0347, 0.8791, 0.9985, 1.0052, 1.0110, 0.9275, 0.9914, 1.0838,
        0.9408], grad_fn=<StdBackward1>)
tensor([-4.9919,  0.1892, -5.2920, -0.1840, -2.5589,  2.8505, -2.8551,  2.2167,
        -2.6582,  2.2511])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.365437918090821, eval loss: [NA]
Epoch: 1, loss: 7.126274377441407, eval loss: [NA]
Epoch: 2, loss: 7.033162799072266, eval loss: [NA]
Epoch: 3, loss: 6.987918463134766, eval loss: [NA]
Epoch: 4, loss: 6.946955657958984, eval loss: [NA]
Epoch: 5, loss: 6.94464010925293, eval loss: [NA]
Epoch: 6, loss: 6.9515902679443355, eval loss: [NA]
Epoch: 7, loss: 6.91790260925293, eval loss: [NA]
Epoch: 8, loss: 6.895659713745117, eval loss: [NA]
Epoch: 9, loss: 6.795431179809571, eval loss: [NA]
Epoch: 10, loss: 6.534916848754883, eval loss: [NA]
Epoch: 11, loss: 6.112776934814453, eval loss: [NA]
Epoch: 12, loss: 5.962806718444824, eval loss: [NA]
Epoch: 13, loss: 5.885031634521485, eval loss: [NA]
Epoch: 14, loss: 5.811971482849121, eval loss: [NA]
Epoch: 15, loss: 5.544795536804199, eval loss: [NA]
Epoch: 16, loss: 4.981708047485352, eval loss: [NA]
Epoch: 17, loss: 4.844515577697754, eval loss: [NA]
Epoch: 18, loss: 4.788243341064453, eval loss: [NA]
Epoch: 19, loss: 4.7333347061157225, eval loss: [NA]
Epoch: 20, loss: 4.700188827514649, eval loss: [NA]
Epoch: 21, loss: 4.697726377868652, eval loss: [NA]
Epoch: 22, loss: 4.642453787231445, eval loss: [NA]
Epoch: 23, loss: 4.661579093933105, eval loss: [NA]
Epoch: 24, loss: 4.671167337036133, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.09953151345253, eval loss: [NA]
Epoch: 1, loss: 0.8915406215190887, eval loss: [NA]
Epoch: 2, loss: 0.6728255709260702, eval loss: [NA]
Epoch: 3, loss: 0.5897439532727003, eval loss: [NA]
Epoch: 4, loss: 0.5417656330764293, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.182401385307312, eval loss: [NA]
Epoch: 1, loss: 8.137843797206878, eval loss: [NA]
Epoch: 2, loss: 8.12367163181305, eval loss: [NA]
Epoch: 3, loss: 8.085730476379394, eval loss: [NA]
Epoch: 4, loss: 8.116558680534363, eval loss: [NA]
Epoch: 5, loss: 8.057465779781342, eval loss: [NA]
Epoch: 6, loss: 8.115998721122741, eval loss: [NA]
Epoch: 7, loss: 8.082466323375701, eval loss: [NA]
Epoch: 8, loss: 8.051401133537292, eval loss: [NA]
Epoch: 9, loss: 8.064657573699952, eval loss: [NA]
Epoch: 10, loss: 8.099363431930541, eval loss: [NA]
Epoch: 11, loss: 8.098758509159088, eval loss: [NA]
Epoch: 12, loss: 8.084608457088471, eval loss: [NA]
Epoch: 13, loss: 8.089142189025878, eval loss: [NA]
Epoch: 14, loss: 8.072588384151459, eval loss: [NA]
Epoch: 15, loss: 8.071717567443848, eval loss: [NA]
Epoch: 16, loss: 8.069554240703583, eval loss: [NA]
Epoch: 17, loss: 8.10919163942337, eval loss: [NA]
Epoch: 18, loss: 8.07991755247116, eval loss: [NA]
Epoch: 19, loss: 8.065372641086578, eval loss: [NA]
Epoch: 20, loss: 8.05349817276001, eval loss: [NA]
Epoch: 21, loss: 8.04010996580124, eval loss: [NA]
Epoch: 22, loss: 8.08626972913742, eval loss: [NA]
Epoch: 23, loss: 8.051281254291535, eval loss: [NA]
Epoch: 24, loss: 8.020288288593292, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.719959304809571, eval loss: [NA]
Epoch: 1, loss: 4.678245280456543, eval loss: [NA]
Epoch: 2, loss: 4.672653392028809, eval loss: [NA]
Epoch: 3, loss: 4.641549569702148, eval loss: [NA]
Epoch: 4, loss: 4.651318194580078, eval loss: [NA]
Epoch: 5, loss: 4.625570137023926, eval loss: [NA]
Epoch: 6, loss: 4.64840082244873, eval loss: [NA]
Epoch: 7, loss: 4.586682713317871, eval loss: [NA]
Epoch: 8, loss: 4.61352742767334, eval loss: [NA]
Epoch: 9, loss: 4.599281689453125, eval loss: [NA]
Epoch: 10, loss: 4.580834701538086, eval loss: [NA]
Epoch: 11, loss: 4.583474598693847, eval loss: [NA]
Epoch: 12, loss: 4.586614700317383, eval loss: [NA]
Epoch: 13, loss: 4.5899671585083, eval loss: [NA]
Epoch: 14, loss: 4.63480908203125, eval loss: [NA]
Epoch: 15, loss: 4.599243556213379, eval loss: [NA]
Epoch: 16, loss: 4.579745545959472, eval loss: [NA]
Epoch: 17, loss: 4.533491885375977, eval loss: [NA]
Epoch: 18, loss: 4.191886717224121, eval loss: [NA]
Epoch: 19, loss: 3.9141822525024415, eval loss: [NA]
Epoch: 20, loss: 3.729420051574707, eval loss: [NA]
Epoch: 21, loss: 3.7182368606567384, eval loss: [NA]
Epoch: 22, loss: 3.6559447525024416, eval loss: [NA]
Epoch: 23, loss: 3.647300923156738, eval loss: [NA]
Epoch: 24, loss: 3.6237990341186523, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.199188787937164, eval loss: [NA]
Epoch: 1, loss: 7.187721519470215, eval loss: [NA]
Epoch: 2, loss: 7.208701503276825, eval loss: [NA]
Epoch: 3, loss: 7.222892050743103, eval loss: [NA]
Epoch: 4, loss: 7.2122036695480345, eval loss: [NA]
Epoch: 5, loss: 7.228162727355957, eval loss: [NA]
Epoch: 6, loss: 7.1854043030738834, eval loss: [NA]
Epoch: 7, loss: 7.230100700855255, eval loss: [NA]
Epoch: 8, loss: 7.221267960071564, eval loss: [NA]
Epoch: 9, loss: 7.209817097187043, eval loss: [NA]
Epoch: 10, loss: 7.2214671635627745, eval loss: [NA]
Epoch: 11, loss: 7.197643566131592, eval loss: [NA]
Epoch: 12, loss: 7.196790473461151, eval loss: [NA]
Epoch: 13, loss: 7.205109293460846, eval loss: [NA]
Epoch: 14, loss: 7.199593844413758, eval loss: [NA]
Epoch: 15, loss: 7.184072351455688, eval loss: [NA]
Epoch: 16, loss: 7.177032911777497, eval loss: [NA]
Epoch: 17, loss: 7.193601558208465, eval loss: [NA]
Epoch: 18, loss: 7.208385894298553, eval loss: [NA]
Epoch: 19, loss: 7.219821679592132, eval loss: [NA]
Epoch: 20, loss: 7.188883616924286, eval loss: [NA]
Epoch: 21, loss: 7.190275948047638, eval loss: [NA]
Epoch: 22, loss: 7.193976621627808, eval loss: [NA]
Epoch: 23, loss: 7.228616313934326, eval loss: [NA]
Epoch: 24, loss: 7.2137773942947385, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.6382752380371093, eval loss: [NA]
Epoch: 1, loss: 3.5994372329711912, eval loss: [NA]
Epoch: 2, loss: 3.5899471450805662, eval loss: [NA]
Epoch: 3, loss: 3.6085538314819336, eval loss: [NA]
Epoch: 4, loss: 3.593360858154297, eval loss: [NA]
Epoch: 5, loss: 3.567645236206055, eval loss: [NA]
Epoch: 6, loss: 3.55693516998291, eval loss: [NA]
Epoch: 7, loss: 3.563036135864258, eval loss: [NA]
Epoch: 8, loss: 3.541804165649414, eval loss: [NA]
Epoch: 9, loss: 3.563142755126953, eval loss: [NA]
Epoch: 10, loss: 3.5358434677124024, eval loss: [NA]
Epoch: 11, loss: 3.5495831939697267, eval loss: [NA]
Epoch: 12, loss: 3.5236780502319336, eval loss: [NA]
Epoch: 13, loss: 3.5606980728149416, eval loss: [NA]
Epoch: 14, loss: 3.54411130065918, eval loss: [NA]
Epoch: 15, loss: 3.5919250900268556, eval loss: [NA]
Epoch: 16, loss: 3.572145997619629, eval loss: [NA]
Epoch: 17, loss: 3.5249399276733397, eval loss: [NA]
Epoch: 18, loss: 3.5318037002563476, eval loss: [NA]
Epoch: 19, loss: 3.549582487487793, eval loss: [NA]
Epoch: 20, loss: 3.586973164367676, eval loss: [NA]
Epoch: 21, loss: 3.574681703186035, eval loss: [NA]
Epoch: 22, loss: 3.529904634094238, eval loss: [NA]
Epoch: 23, loss: 3.5327572036743162, eval loss: [NA]
Epoch: 24, loss: 3.523564128112793, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.134880504608154, eval loss: [NA]
Epoch: 1, loss: 7.146391296386719, eval loss: [NA]
Epoch: 2, loss: 7.151925024986267, eval loss: [NA]
Epoch: 3, loss: 7.157557175159455, eval loss: [NA]
Epoch: 4, loss: 7.134925036430359, eval loss: [NA]
Epoch: 5, loss: 7.133970229625702, eval loss: [NA]
Epoch: 6, loss: 7.123244862556458, eval loss: [NA]
Epoch: 7, loss: 7.155223159790039, eval loss: [NA]
Epoch: 8, loss: 7.1282217621803285, eval loss: [NA]
Epoch: 9, loss: 7.14963399887085, eval loss: [NA]
Epoch: 10, loss: 7.149968104362488, eval loss: [NA]
Epoch: 11, loss: 7.1344169330596925, eval loss: [NA]
Epoch: 12, loss: 7.1434484958648685, eval loss: [NA]
Epoch: 13, loss: 7.135255467891693, eval loss: [NA]
Epoch: 14, loss: 7.134193346500397, eval loss: [NA]
Epoch: 15, loss: 7.123695142269135, eval loss: [NA]
Epoch: 16, loss: 7.153181602954865, eval loss: [NA]
Epoch: 17, loss: 7.150868682861328, eval loss: [NA]
Epoch: 18, loss: 7.140123281478882, eval loss: [NA]
Epoch: 19, loss: 7.141632702350616, eval loss: [NA]
Epoch: 20, loss: 7.131686458587646, eval loss: [NA]
Epoch: 21, loss: 7.146798887252808, eval loss: [NA]
Epoch: 22, loss: 7.122222979068756, eval loss: [NA]
Epoch: 23, loss: 7.123502538204193, eval loss: [NA]
Epoch: 24, loss: 7.108839428424835, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.513792118835449, eval loss: [NA]
Epoch: 1, loss: 3.5329271774291993, eval loss: [NA]
Epoch: 2, loss: 3.5183882064819336, eval loss: [NA]
Epoch: 3, loss: 3.530659883117676, eval loss: [NA]
Epoch: 4, loss: 3.519730157470703, eval loss: [NA]
Epoch: 5, loss: 3.48649070892334, eval loss: [NA]
Epoch: 6, loss: 3.4861315811157225, eval loss: [NA]
Epoch: 7, loss: 3.506730647277832, eval loss: [NA]
Epoch: 8, loss: 3.4909819915771485, eval loss: [NA]
Epoch: 9, loss: 3.5155762603759766, eval loss: [NA]
Epoch: 10, loss: 3.5151801452636717, eval loss: [NA]
Epoch: 11, loss: 3.48730613861084, eval loss: [NA]
Epoch: 12, loss: 3.4750392990112307, eval loss: [NA]
Epoch: 13, loss: 3.4706428314208986, eval loss: [NA]
Epoch: 14, loss: 3.531587889099121, eval loss: [NA]
Epoch: 15, loss: 3.5140418991088866, eval loss: [NA]
Epoch: 16, loss: 3.5013575439453124, eval loss: [NA]
Epoch: 17, loss: 3.4882512084960937, eval loss: [NA]
Epoch: 18, loss: 3.48669266204834, eval loss: [NA]
Epoch: 19, loss: 3.4971330932617186, eval loss: [NA]
Epoch: 20, loss: 3.471846051025391, eval loss: [NA]
Epoch: 21, loss: 3.519083480834961, eval loss: [NA]
Epoch: 22, loss: 3.5121265640258787, eval loss: [NA]
Epoch: 23, loss: 3.4744585525512695, eval loss: [NA]
Epoch: 24, loss: 3.4646317932128907, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.094789710044861, eval loss: [NA]
Epoch: 1, loss: 7.105130460262298, eval loss: [NA]
Epoch: 2, loss: 7.09245888710022, eval loss: [NA]
Epoch: 3, loss: 7.079468920230865, eval loss: [NA]
Epoch: 4, loss: 7.079068210124969, eval loss: [NA]
Epoch: 5, loss: 7.072099814414978, eval loss: [NA]
Epoch: 6, loss: 7.069980647563934, eval loss: [NA]
Epoch: 7, loss: 7.074393434524536, eval loss: [NA]
Epoch: 8, loss: 7.06552440404892, eval loss: [NA]
Epoch: 9, loss: 7.081055359840393, eval loss: [NA]
Epoch: 10, loss: 7.0597753119468685, eval loss: [NA]
Epoch: 11, loss: 7.10962016582489, eval loss: [NA]
Epoch: 12, loss: 7.1241773200035095, eval loss: [NA]
Epoch: 13, loss: 7.092039337158203, eval loss: [NA]
Epoch: 14, loss: 7.074397032260895, eval loss: [NA]
Epoch: 15, loss: 7.068247761726379, eval loss: [NA]
Epoch: 16, loss: 7.06806969165802, eval loss: [NA]
Epoch: 17, loss: 7.0775482249259944, eval loss: [NA]
Epoch: 18, loss: 7.124886894226075, eval loss: [NA]
Epoch: 19, loss: 7.060979950428009, eval loss: [NA]
Epoch: 20, loss: 7.092938139438629, eval loss: [NA]
Epoch: 21, loss: 7.071481053829193, eval loss: [NA]
Epoch: 22, loss: 7.102572388648987, eval loss: [NA]
Epoch: 23, loss: 7.061027796268463, eval loss: [NA]
Epoch: 24, loss: 7.060132076740265, eval loss: [NA]

Runtime:423.67
[116362115728989.62, 0.3934, 0.1257, 0.2113]
[2.7396, 0.7307, 0.6208, 0.5876]
[2.1552, 0.8914, 0.759, 0.771]
tensor(0.7910, grad_fn=<MeanBackward0>)
tensor(0.6161, grad_fn=<MeanBackward0>)
tensor([-4.8675,  0.0249, -5.1415, -0.3096, -2.3637,  2.7299, -3.2824,  1.7786,
        -3.3448,  1.6383], grad_fn=<MeanBackward1>)
tensor([0.3373, 0.3421, 0.3368, 0.3505, 0.3109, 0.3396, 1.2561, 1.3368, 1.1915,
        1.2772], grad_fn=<StdBackward1>)
tensor([-4.9919,  0.1892, -5.2920, -0.1840, -2.5589,  2.8505, -2.8551,  2.2167,
        -2.6582,  2.2511])
KL div untrained: 85108392141479.73
KL div trained: 0.1992
