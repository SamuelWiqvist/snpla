Input args:
Dim: 2
seed: 8
seed_data: 10
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev
tensor(2.1897, grad_fn=<MeanBackward0>)
tensor(2.1540, grad_fn=<MeanBackward0>)
tensor([ 0.0268,  0.1480, -0.0215, -0.1530,  0.0435, -0.0724, -0.0088, -0.0801,
        -0.0923, -0.0458], grad_fn=<MeanBackward1>)
tensor([0.9563, 0.9375, 0.9467, 0.9407, 1.0539, 0.9109, 0.8882, 0.9239, 0.9481,
        1.0461], grad_fn=<StdBackward1>)
tensor([ 0.9260, -2.9856,  1.1985, -2.0846, -0.1463, -3.8626,  0.4379, -3.0580,
        -1.1963, -4.4669])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.483989141845703, eval loss: [NA]
Epoch: 1, loss: 7.054627362060547, eval loss: [NA]
Epoch: 2, loss: 6.93678801574707, eval loss: [NA]
Epoch: 3, loss: 6.9161789581298825, eval loss: [NA]
Epoch: 4, loss: 6.812522476196289, eval loss: [NA]
Epoch: 5, loss: 6.68651452331543, eval loss: [NA]
Epoch: 6, loss: 6.373838400268554, eval loss: [NA]
Epoch: 7, loss: 6.044082861328125, eval loss: [NA]
Epoch: 8, loss: 5.9327892578125, eval loss: [NA]
Epoch: 9, loss: 5.87314065246582, eval loss: [NA]
Epoch: 10, loss: 5.711494987487793, eval loss: [NA]
Epoch: 11, loss: 5.1836258361816405, eval loss: [NA]
Epoch: 12, loss: 5.0421638671875, eval loss: [NA]
Epoch: 13, loss: 4.932046485900879, eval loss: [NA]
Epoch: 14, loss: 4.895357177734375, eval loss: [NA]
Epoch: 15, loss: 4.864808361816406, eval loss: [NA]
Epoch: 16, loss: 4.843651449584961, eval loss: [NA]
Epoch: 17, loss: 4.836668464660645, eval loss: [NA]
Epoch: 18, loss: 4.7973485229492185, eval loss: [NA]
Epoch: 19, loss: 4.7864155731201175, eval loss: [NA]
Epoch: 20, loss: 4.790647940063477, eval loss: [NA]
Epoch: 21, loss: 4.762088049316406, eval loss: [NA]
Epoch: 22, loss: 4.7770402648925785, eval loss: [NA]
Epoch: 23, loss: 4.7677342956542965, eval loss: [NA]
Epoch: 24, loss: 4.730664492797851, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.088938979804516, eval loss: [NA]
Epoch: 1, loss: 0.8486433520913124, eval loss: [NA]
Epoch: 2, loss: 0.6681659495830536, eval loss: [NA]
Epoch: 3, loss: 0.5804528266191482, eval loss: [NA]
Epoch: 4, loss: 0.5465035383403302, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.050271596908569, eval loss: [NA]
Epoch: 1, loss: 7.033248784542084, eval loss: [NA]
Epoch: 2, loss: 7.016413989067078, eval loss: [NA]
Epoch: 3, loss: 7.017928054332733, eval loss: [NA]
Epoch: 4, loss: 7.016062572002411, eval loss: [NA]
Epoch: 5, loss: 7.021453330516815, eval loss: [NA]
Epoch: 6, loss: 7.010007574558258, eval loss: [NA]
Epoch: 7, loss: 7.015460731983185, eval loss: [NA]
Epoch: 8, loss: 7.006361167430878, eval loss: [NA]
Epoch: 9, loss: 6.993332238197326, eval loss: [NA]
Epoch: 10, loss: 7.0176614880561825, eval loss: [NA]
Epoch: 11, loss: 7.028653228282929, eval loss: [NA]
Epoch: 12, loss: 7.023894913196564, eval loss: [NA]
Epoch: 13, loss: 7.006601827144623, eval loss: [NA]
Epoch: 14, loss: 6.996523671150207, eval loss: [NA]
Epoch: 15, loss: 7.018574268817901, eval loss: [NA]
Epoch: 16, loss: 7.015817477703094, eval loss: [NA]
Epoch: 17, loss: 6.9995565557479855, eval loss: [NA]
Epoch: 18, loss: 7.02373066663742, eval loss: [NA]
Epoch: 19, loss: 6.994697289466858, eval loss: [NA]
Epoch: 20, loss: 7.0129834127426145, eval loss: [NA]
Epoch: 21, loss: 6.9961948037147526, eval loss: [NA]
Epoch: 22, loss: 7.020864601135254, eval loss: [NA]
Epoch: 23, loss: 6.989258596897125, eval loss: [NA]
Epoch: 24, loss: 6.99461706161499, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.834394453430176, eval loss: [NA]
Epoch: 1, loss: 4.770567387390137, eval loss: [NA]
Epoch: 2, loss: 4.753065243530274, eval loss: [NA]
Epoch: 3, loss: 4.770810479736328, eval loss: [NA]
Epoch: 4, loss: 4.77493113861084, eval loss: [NA]
Epoch: 5, loss: 4.782612660217286, eval loss: [NA]
Epoch: 6, loss: 4.758713035583496, eval loss: [NA]
Epoch: 7, loss: 4.738615411376953, eval loss: [NA]
Epoch: 8, loss: 4.739716255187989, eval loss: [NA]
Epoch: 9, loss: 4.729694856262207, eval loss: [NA]
Epoch: 10, loss: 4.674357484436035, eval loss: [NA]
Epoch: 11, loss: 4.573000074768067, eval loss: [NA]
Epoch: 12, loss: 4.5517779663085935, eval loss: [NA]
Epoch: 13, loss: 4.541706610107422, eval loss: [NA]
Epoch: 14, loss: 4.5541735427856445, eval loss: [NA]
Epoch: 15, loss: 4.542111331176758, eval loss: [NA]
Epoch: 16, loss: 4.57398936920166, eval loss: [NA]
Epoch: 17, loss: 4.540347351074219, eval loss: [NA]
Epoch: 18, loss: 4.532799659729004, eval loss: [NA]
Epoch: 19, loss: 4.5751157562255855, eval loss: [NA]
Epoch: 20, loss: 4.535293743896484, eval loss: [NA]
Epoch: 21, loss: 4.548457485961914, eval loss: [NA]
Epoch: 22, loss: 4.5028726089477535, eval loss: [NA]
Epoch: 23, loss: 4.49614759979248, eval loss: [NA]
Epoch: 24, loss: 4.313659916687012, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.493279795646668, eval loss: [NA]
Epoch: 1, loss: 6.461785111427307, eval loss: [NA]
Epoch: 2, loss: 6.454361867904663, eval loss: [NA]
Epoch: 3, loss: 6.484920485019684, eval loss: [NA]
Epoch: 4, loss: 6.480740606784821, eval loss: [NA]
Epoch: 5, loss: 6.496042068004608, eval loss: [NA]
Epoch: 6, loss: 6.459819519519806, eval loss: [NA]
Epoch: 7, loss: 6.455280115604401, eval loss: [NA]
Epoch: 8, loss: 6.4827127933502195, eval loss: [NA]
Epoch: 9, loss: 6.454310472011566, eval loss: [NA]
Epoch: 10, loss: 6.443628027439117, eval loss: [NA]
Epoch: 11, loss: 6.485095267295837, eval loss: [NA]
Epoch: 12, loss: 6.465267889499664, eval loss: [NA]
Epoch: 13, loss: 6.481111235618592, eval loss: [NA]
Epoch: 14, loss: 6.4651305603981015, eval loss: [NA]
Epoch: 15, loss: 6.462651946544647, eval loss: [NA]
Epoch: 16, loss: 6.460614800453186, eval loss: [NA]
Epoch: 17, loss: 6.4671210670471195, eval loss: [NA]
Epoch: 18, loss: 6.493070783615113, eval loss: [NA]
Epoch: 19, loss: 6.483322875499725, eval loss: [NA]
Epoch: 20, loss: 6.444696533679962, eval loss: [NA]
Epoch: 21, loss: 6.469446489810943, eval loss: [NA]
Epoch: 22, loss: 6.447806048393249, eval loss: [NA]
Epoch: 23, loss: 6.465097899436951, eval loss: [NA]
Epoch: 24, loss: 6.4944394373893735, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.9342732650756838, eval loss: [NA]
Epoch: 1, loss: 3.7554176834106445, eval loss: [NA]
Epoch: 2, loss: 3.630939158630371, eval loss: [NA]
Epoch: 3, loss: 3.63020118560791, eval loss: [NA]
Epoch: 4, loss: 3.6311230560302734, eval loss: [NA]
Epoch: 5, loss: 3.5526405883789063, eval loss: [NA]
Epoch: 6, loss: 3.552462463378906, eval loss: [NA]
Epoch: 7, loss: 3.551196368408203, eval loss: [NA]
Epoch: 8, loss: 3.561361557006836, eval loss: [NA]
Epoch: 9, loss: 3.589820812988281, eval loss: [NA]
Epoch: 10, loss: 3.5283794036865235, eval loss: [NA]
Epoch: 11, loss: 3.533150923156738, eval loss: [NA]
Epoch: 12, loss: 3.5592495254516603, eval loss: [NA]
Epoch: 13, loss: 3.545841586303711, eval loss: [NA]
Epoch: 14, loss: 3.5362908935546873, eval loss: [NA]
Epoch: 15, loss: 3.526492108154297, eval loss: [NA]
Epoch: 16, loss: 3.5359227386474608, eval loss: [NA]
Epoch: 17, loss: 3.503907124328613, eval loss: [NA]
Epoch: 18, loss: 3.4643467071533203, eval loss: [NA]
Epoch: 19, loss: 3.5311021408081054, eval loss: [NA]
Epoch: 20, loss: 3.53638791809082, eval loss: [NA]
Epoch: 21, loss: 3.51249520111084, eval loss: [NA]
Epoch: 22, loss: 3.5013972305297854, eval loss: [NA]
Epoch: 23, loss: 3.496781983947754, eval loss: [NA]
Epoch: 24, loss: 3.479836180114746, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.213393082618714, eval loss: [NA]
Epoch: 1, loss: 6.215968139171601, eval loss: [NA]
Epoch: 2, loss: 6.198320257663727, eval loss: [NA]
Epoch: 3, loss: 6.220152385234833, eval loss: [NA]
Epoch: 4, loss: 6.217364709377289, eval loss: [NA]
Epoch: 5, loss: 6.1963171076774595, eval loss: [NA]
Epoch: 6, loss: 6.230642538070679, eval loss: [NA]
Epoch: 7, loss: 6.228875403404236, eval loss: [NA]
Epoch: 8, loss: 6.22358149766922, eval loss: [NA]
Epoch: 9, loss: 6.197032091617584, eval loss: [NA]
Epoch: 10, loss: 6.2429122591018675, eval loss: [NA]
Epoch: 11, loss: 6.222526307106018, eval loss: [NA]
Epoch: 12, loss: 6.196037771701813, eval loss: [NA]
Epoch: 13, loss: 6.229134373664856, eval loss: [NA]
Epoch: 14, loss: 6.194516577720642, eval loss: [NA]
Epoch: 15, loss: 6.173348994255066, eval loss: [NA]
Epoch: 16, loss: 6.225252101421356, eval loss: [NA]
Epoch: 17, loss: 6.214216542243958, eval loss: [NA]
Epoch: 18, loss: 6.196181669235229, eval loss: [NA]
Epoch: 19, loss: 6.219315395355225, eval loss: [NA]
Epoch: 20, loss: 6.223467326164245, eval loss: [NA]
Epoch: 21, loss: 6.221102278232575, eval loss: [NA]
Epoch: 22, loss: 6.230096092224121, eval loss: [NA]
Epoch: 23, loss: 6.176583445072174, eval loss: [NA]
Epoch: 24, loss: 6.202698714733124, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.5795446014404297, eval loss: [NA]
Epoch: 1, loss: 3.5801793991088866, eval loss: [NA]
Epoch: 2, loss: 3.5313898040771483, eval loss: [NA]
Epoch: 3, loss: 3.547648352050781, eval loss: [NA]
Epoch: 4, loss: 3.55559083404541, eval loss: [NA]
Epoch: 5, loss: 3.5525420501708984, eval loss: [NA]
Epoch: 6, loss: 3.552041438293457, eval loss: [NA]
Epoch: 7, loss: 3.561146955871582, eval loss: [NA]
Epoch: 8, loss: 3.5460958786010743, eval loss: [NA]
Epoch: 9, loss: 3.538586637878418, eval loss: [NA]
Epoch: 10, loss: 3.5091329223632814, eval loss: [NA]
Epoch: 11, loss: 3.54807996673584, eval loss: [NA]
Epoch: 12, loss: 3.5076926971435545, eval loss: [NA]
Epoch: 13, loss: 3.5139242889404296, eval loss: [NA]
Epoch: 14, loss: 3.535712062072754, eval loss: [NA]
Epoch: 15, loss: 3.547251361083984, eval loss: [NA]
Epoch: 16, loss: 3.5416923416137696, eval loss: [NA]
Epoch: 17, loss: 3.54040096282959, eval loss: [NA]
Epoch: 18, loss: 3.496341926574707, eval loss: [NA]
Epoch: 19, loss: 3.5493254135131838, eval loss: [NA]
Epoch: 20, loss: 3.5438562561035156, eval loss: [NA]
Epoch: 21, loss: 3.528682833862305, eval loss: [NA]
Epoch: 22, loss: 3.5182418762207033, eval loss: [NA]
Epoch: 23, loss: 3.5280425460815428, eval loss: [NA]
Epoch: 24, loss: 3.5371929000854494, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.076713345050812, eval loss: [NA]
Epoch: 1, loss: 6.0962416410446165, eval loss: [NA]
Epoch: 2, loss: 6.089676692485809, eval loss: [NA]
Epoch: 3, loss: 6.0477401065826415, eval loss: [NA]
Epoch: 4, loss: 6.052733700275422, eval loss: [NA]
Epoch: 5, loss: 6.091097600460053, eval loss: [NA]
Epoch: 6, loss: 6.094864058494568, eval loss: [NA]
Epoch: 7, loss: 6.059678974151612, eval loss: [NA]
Epoch: 8, loss: 6.103704855442047, eval loss: [NA]
Epoch: 9, loss: 6.061494920253754, eval loss: [NA]
Epoch: 10, loss: 6.057745609283447, eval loss: [NA]
Epoch: 11, loss: 6.081590759754181, eval loss: [NA]
Epoch: 12, loss: 6.108671045303344, eval loss: [NA]
Epoch: 13, loss: 6.06724328994751, eval loss: [NA]
Epoch: 14, loss: 6.059504094123841, eval loss: [NA]
Epoch: 15, loss: 6.053230104446411, eval loss: [NA]
Epoch: 16, loss: 6.067088887691498, eval loss: [NA]
Epoch: 17, loss: 6.08565256357193, eval loss: [NA]
Epoch: 18, loss: 6.097615869045257, eval loss: [NA]
Epoch: 19, loss: 6.077030835151672, eval loss: [NA]
Epoch: 20, loss: 6.082633728981018, eval loss: [NA]
Epoch: 21, loss: 6.066388714313507, eval loss: [NA]
Epoch: 22, loss: 6.077028815746307, eval loss: [NA]
Epoch: 23, loss: 6.0840211820602415, eval loss: [NA]
Epoch: 24, loss: 6.0685808777809145, eval loss: [NA]

Runtime:386.25
[4.686086582595623e+19, 0.3393, 0.1505, 0.0911]
[2.154, 0.7764, 0.6857, 0.6403]
[2.1897, 0.9486, 0.8215, 0.7568]
tensor(0.7678, grad_fn=<MeanBackward0>)
tensor(0.6402, grad_fn=<MeanBackward0>)
tensor([ 0.7179, -2.7399,  0.7014, -2.7398,  0.6311, -2.8577,  0.3835, -3.1068,
        -1.0391, -4.5940], grad_fn=<MeanBackward1>)
tensor([0.3041, 0.3321, 1.2490, 1.3100, 1.2004, 1.2699, 0.3116, 0.3383, 0.3009,
        0.3209], grad_fn=<StdBackward1>)
tensor([ 0.9260, -2.9856,  1.1985, -2.0846, -0.1463, -3.8626,  0.4379, -3.0580,
        -1.1963, -4.4669])
KL div untrained: 7.2814509121785545e+19
KL div trained: 0.1474
