Input args:
Dim: 2
seed: 2
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1956, grad_fn=<MeanBackward0>)
tensor(1.2356, grad_fn=<MeanBackward0>)
tensor([-0.0702,  0.1224, -0.2654, -0.2498,  0.0023,  0.2239, -0.0629,  0.0347,
        -0.1260, -0.0971], grad_fn=<MeanBackward1>)
tensor([1.0389, 1.0533, 1.0460, 1.0424, 0.9031, 0.9455, 0.9099, 1.0012, 1.1042,
        0.9096], grad_fn=<StdBackward1>)
tensor([ 1.3391, -0.1074,  0.5010, -1.3290,  2.1069,  0.5312,  1.5520,  0.3921,
         0.4158, -1.3569])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 12.11984093322754, eval loss: [NA]
Epoch: 1, loss: 7.081073937988282, eval loss: [NA]
Epoch: 2, loss: 6.988763165283203, eval loss: [NA]
Epoch: 3, loss: 6.939344229125976, eval loss: [NA]
Epoch: 4, loss: 6.931917276000976, eval loss: [NA]
Epoch: 5, loss: 6.878427444458008, eval loss: [NA]
Epoch: 6, loss: 6.870979595947266, eval loss: [NA]
Epoch: 7, loss: 6.880572799682617, eval loss: [NA]
Epoch: 8, loss: 6.861857629394531, eval loss: [NA]
Epoch: 9, loss: 6.853374139404297, eval loss: [NA]
Epoch: 10, loss: 6.836551507568359, eval loss: [NA]
Epoch: 11, loss: 6.803098101806641, eval loss: [NA]
Epoch: 12, loss: 6.670492266845703, eval loss: [NA]
Epoch: 13, loss: 6.381385113525391, eval loss: [NA]
Epoch: 14, loss: 6.098481455993652, eval loss: [NA]
Epoch: 15, loss: 5.891374928283692, eval loss: [NA]
Epoch: 16, loss: 5.745686930847168, eval loss: [NA]
Epoch: 17, loss: 5.718327253723144, eval loss: [NA]
Epoch: 18, loss: 5.693375410461425, eval loss: [NA]
Epoch: 19, loss: 5.65895892944336, eval loss: [NA]
Epoch: 20, loss: 5.649820190429687, eval loss: [NA]
Epoch: 21, loss: 5.626900997924805, eval loss: [NA]
Epoch: 22, loss: 5.633991273498535, eval loss: [NA]
Epoch: 23, loss: 5.615390594482422, eval loss: [NA]
Epoch: 24, loss: 5.5850030731201175, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.9989138320088387, eval loss: [NA]
Epoch: 1, loss: 0.8365943136811257, eval loss: [NA]
Epoch: 2, loss: 0.6447428310662509, eval loss: [NA]
Epoch: 3, loss: 0.5481435813009738, eval loss: [NA]
Epoch: 4, loss: 0.5031612377613783, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.579013891220093, eval loss: [NA]
Epoch: 1, loss: 6.5592301034927365, eval loss: [NA]
Epoch: 2, loss: 6.560014464855194, eval loss: [NA]
Epoch: 3, loss: 6.577414722442627, eval loss: [NA]
Epoch: 4, loss: 6.569055395126343, eval loss: [NA]
Epoch: 5, loss: 6.55413697719574, eval loss: [NA]
Epoch: 6, loss: 6.571162936687469, eval loss: [NA]
Epoch: 7, loss: 6.562427890300751, eval loss: [NA]
Epoch: 8, loss: 6.58768750667572, eval loss: [NA]
Epoch: 9, loss: 6.548512313365936, eval loss: [NA]
Epoch: 10, loss: 6.550136096477509, eval loss: [NA]
Epoch: 11, loss: 6.567941017150879, eval loss: [NA]
Epoch: 12, loss: 6.5558327031135555, eval loss: [NA]
Epoch: 13, loss: 6.54927344083786, eval loss: [NA]
Epoch: 14, loss: 6.552998988628388, eval loss: [NA]
Epoch: 15, loss: 6.531979405879975, eval loss: [NA]
Epoch: 16, loss: 6.559023723602295, eval loss: [NA]
Epoch: 17, loss: 6.567503995895386, eval loss: [NA]
Epoch: 18, loss: 6.574813485145569, eval loss: [NA]
Epoch: 19, loss: 6.546215562820435, eval loss: [NA]
Epoch: 20, loss: 6.55440530538559, eval loss: [NA]
Epoch: 21, loss: 6.551646430492401, eval loss: [NA]
Epoch: 22, loss: 6.560390319824219, eval loss: [NA]
Epoch: 23, loss: 6.552189643383026, eval loss: [NA]
Epoch: 24, loss: 6.556354038715362, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.567405207824707, eval loss: [NA]
Epoch: 1, loss: 5.55602325592041, eval loss: [NA]
Epoch: 2, loss: 5.5411342361450195, eval loss: [NA]
Epoch: 3, loss: 5.535727282714844, eval loss: [NA]
Epoch: 4, loss: 5.531877166748047, eval loss: [NA]
Epoch: 5, loss: 5.518997381591797, eval loss: [NA]
Epoch: 6, loss: 5.528556871032714, eval loss: [NA]
Epoch: 7, loss: 5.548702456665039, eval loss: [NA]
Epoch: 8, loss: 5.507750332641602, eval loss: [NA]
Epoch: 9, loss: 5.513796678161621, eval loss: [NA]
Epoch: 10, loss: 5.511957203674316, eval loss: [NA]
Epoch: 11, loss: 5.530301078796387, eval loss: [NA]
Epoch: 12, loss: 5.541269381713867, eval loss: [NA]
Epoch: 13, loss: 5.515953541564941, eval loss: [NA]
Epoch: 14, loss: 5.5270262069702145, eval loss: [NA]
Epoch: 15, loss: 5.498306564331054, eval loss: [NA]
Epoch: 16, loss: 5.5088944885253905, eval loss: [NA]
Epoch: 17, loss: 5.52734580078125, eval loss: [NA]
Epoch: 18, loss: 5.466609396362305, eval loss: [NA]
Epoch: 19, loss: 5.51194119720459, eval loss: [NA]
Epoch: 20, loss: 5.520678248596192, eval loss: [NA]
Epoch: 21, loss: 5.528173153686524, eval loss: [NA]
Epoch: 22, loss: 5.4968462036132815, eval loss: [NA]
Epoch: 23, loss: 5.540408435058594, eval loss: [NA]
Epoch: 24, loss: 5.5175197830200196, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.173979616165161, eval loss: [NA]
Epoch: 1, loss: 6.177222754955292, eval loss: [NA]
Epoch: 2, loss: 6.179562032222748, eval loss: [NA]
Epoch: 3, loss: 6.184956247806549, eval loss: [NA]
Epoch: 4, loss: 6.165299000740052, eval loss: [NA]
Epoch: 5, loss: 6.191432476043701, eval loss: [NA]
Epoch: 6, loss: 6.1849126362800595, eval loss: [NA]
Epoch: 7, loss: 6.172852294445038, eval loss: [NA]
Epoch: 8, loss: 6.159421951770782, eval loss: [NA]
Epoch: 9, loss: 6.176409938335419, eval loss: [NA]
Epoch: 10, loss: 6.191135985851288, eval loss: [NA]
Epoch: 11, loss: 6.174708878993988, eval loss: [NA]
Epoch: 12, loss: 6.1831716895103455, eval loss: [NA]
Epoch: 13, loss: 6.175665755271911, eval loss: [NA]
Epoch: 14, loss: 6.183082802295685, eval loss: [NA]
Epoch: 15, loss: 6.180292601585388, eval loss: [NA]
Epoch: 16, loss: 6.162283921241761, eval loss: [NA]
Epoch: 17, loss: 6.1712245273590085, eval loss: [NA]
Epoch: 18, loss: 6.1803210258483885, eval loss: [NA]
Epoch: 19, loss: 6.16109266281128, eval loss: [NA]
Epoch: 20, loss: 6.181188817024231, eval loss: [NA]
Epoch: 21, loss: 6.176041927337646, eval loss: [NA]
Epoch: 22, loss: 6.186444146633148, eval loss: [NA]
Epoch: 23, loss: 6.17672660112381, eval loss: [NA]
Epoch: 24, loss: 6.181932134628296, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 5.493307400512696, eval loss: [NA]
Epoch: 1, loss: 5.464328146362305, eval loss: [NA]
Epoch: 2, loss: 5.482800790405274, eval loss: [NA]
Epoch: 3, loss: 5.4552205078125, eval loss: [NA]
Epoch: 4, loss: 5.4820967910766605, eval loss: [NA]
Epoch: 5, loss: 5.4831470733642576, eval loss: [NA]
Epoch: 6, loss: 5.481787951660157, eval loss: [NA]
Epoch: 7, loss: 5.462687226867676, eval loss: [NA]
Epoch: 8, loss: 5.430519091796875, eval loss: [NA]
Epoch: 9, loss: 5.081022760009765, eval loss: [NA]
Epoch: 10, loss: 4.7506799774169925, eval loss: [NA]
Epoch: 11, loss: 4.670146719360352, eval loss: [NA]
Epoch: 12, loss: 4.637624255371094, eval loss: [NA]
Epoch: 13, loss: 4.596642420959473, eval loss: [NA]
Epoch: 14, loss: 4.57575100402832, eval loss: [NA]
Epoch: 15, loss: 4.576552500915527, eval loss: [NA]
Epoch: 16, loss: 4.546933952331543, eval loss: [NA]
Epoch: 17, loss: 4.535960337829589, eval loss: [NA]
Epoch: 18, loss: 4.548552073669434, eval loss: [NA]
Epoch: 19, loss: 4.544061360168457, eval loss: [NA]
Epoch: 20, loss: 4.495912055969239, eval loss: [NA]
Epoch: 21, loss: 4.489370118713379, eval loss: [NA]
Epoch: 22, loss: 4.510146774291992, eval loss: [NA]
Epoch: 23, loss: 4.509884817504883, eval loss: [NA]
Epoch: 24, loss: 4.495336936950683, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.230922393798828, eval loss: [NA]
Epoch: 1, loss: 5.216072018146515, eval loss: [NA]
Epoch: 2, loss: 5.2454474782943725, eval loss: [NA]
Epoch: 3, loss: 5.220710299015045, eval loss: [NA]
Epoch: 4, loss: 5.223353943824768, eval loss: [NA]
Epoch: 5, loss: 5.2200284099578855, eval loss: [NA]
Epoch: 6, loss: 5.2344158744812015, eval loss: [NA]
Epoch: 7, loss: 5.210814270973206, eval loss: [NA]
Epoch: 8, loss: 5.2160277891159055, eval loss: [NA]
Epoch: 9, loss: 5.193269546031952, eval loss: [NA]
Epoch: 10, loss: 5.208246004581452, eval loss: [NA]
Epoch: 11, loss: 5.227851092815399, eval loss: [NA]
Epoch: 12, loss: 5.226313865184784, eval loss: [NA]
Epoch: 13, loss: 5.214336812496185, eval loss: [NA]
Epoch: 14, loss: 5.230389139652252, eval loss: [NA]
Epoch: 15, loss: 5.244898555278778, eval loss: [NA]
Epoch: 16, loss: 5.227284550666809, eval loss: [NA]
Epoch: 17, loss: 5.218544557094574, eval loss: [NA]
Epoch: 18, loss: 5.2012605023384095, eval loss: [NA]
Epoch: 19, loss: 5.214410028457642, eval loss: [NA]
Epoch: 20, loss: 5.227378406524658, eval loss: [NA]
Epoch: 21, loss: 5.215308451652527, eval loss: [NA]
Epoch: 22, loss: 5.204304208755493, eval loss: [NA]
Epoch: 23, loss: 5.20635924577713, eval loss: [NA]
Epoch: 24, loss: 5.2004524517059325, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 4.5124170745849606, eval loss: [NA]
Epoch: 1, loss: 4.514490849304199, eval loss: [NA]
Epoch: 2, loss: 4.50185966796875, eval loss: [NA]
Epoch: 3, loss: 4.483191583251953, eval loss: [NA]
Epoch: 4, loss: 4.4826275161743165, eval loss: [NA]
Epoch: 5, loss: 4.489242378234863, eval loss: [NA]
Epoch: 6, loss: 4.467384875488281, eval loss: [NA]
Epoch: 7, loss: 4.476285801696777, eval loss: [NA]
Epoch: 8, loss: 4.42864383392334, eval loss: [NA]
Epoch: 9, loss: 4.151986320495605, eval loss: [NA]
Epoch: 10, loss: 3.84849666595459, eval loss: [NA]
Epoch: 11, loss: 3.763023651123047, eval loss: [NA]
Epoch: 12, loss: 3.69548055267334, eval loss: [NA]
Epoch: 13, loss: 3.59356268157959, eval loss: [NA]
Epoch: 14, loss: 3.542687158203125, eval loss: [NA]
Epoch: 15, loss: 3.5631725341796874, eval loss: [NA]
Epoch: 16, loss: 3.5210505447387694, eval loss: [NA]
Epoch: 17, loss: 3.5504389389038087, eval loss: [NA]
Epoch: 18, loss: 3.5146128784179687, eval loss: [NA]
Epoch: 19, loss: 3.500623211669922, eval loss: [NA]
Epoch: 20, loss: 3.524708837890625, eval loss: [NA]
Epoch: 21, loss: 3.4851880020141603, eval loss: [NA]
Epoch: 22, loss: 3.4863788619995115, eval loss: [NA]
Epoch: 23, loss: 3.5268274826049804, eval loss: [NA]
Epoch: 24, loss: 3.490997004699707, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 4.52602403640747, eval loss: [NA]
Epoch: 1, loss: 4.522148990631104, eval loss: [NA]
Epoch: 2, loss: 4.560581681728363, eval loss: [NA]
Epoch: 3, loss: 4.55280219078064, eval loss: [NA]
Epoch: 4, loss: 4.550894584655762, eval loss: [NA]
Epoch: 5, loss: 4.529286243915558, eval loss: [NA]
Epoch: 6, loss: 4.53208226442337, eval loss: [NA]
Epoch: 7, loss: 4.551079862117767, eval loss: [NA]
Epoch: 8, loss: 4.531771056652069, eval loss: [NA]
Epoch: 9, loss: 4.56527163028717, eval loss: [NA]
Epoch: 10, loss: 4.539103338718414, eval loss: [NA]
Epoch: 11, loss: 4.561091623306274, eval loss: [NA]
Epoch: 12, loss: 4.5667830991745, eval loss: [NA]
Epoch: 13, loss: 4.539611783027649, eval loss: [NA]
Epoch: 14, loss: 4.544182076454162, eval loss: [NA]
Epoch: 15, loss: 4.520707340240478, eval loss: [NA]
Epoch: 16, loss: 4.556103539466858, eval loss: [NA]
Epoch: 17, loss: 4.531021163463593, eval loss: [NA]
Epoch: 18, loss: 4.528395478725433, eval loss: [NA]
Epoch: 19, loss: 4.564811956882477, eval loss: [NA]
Epoch: 20, loss: 4.562384538650512, eval loss: [NA]
Epoch: 21, loss: 4.532611074447632, eval loss: [NA]
Epoch: 22, loss: 4.535477595329285, eval loss: [NA]
Epoch: 23, loss: 4.5504023504257205, eval loss: [NA]
Epoch: 24, loss: 4.539506249427795, eval loss: [NA]

Runtime:389.29
[3.8939532525976616e+16, 1.0568, 1.1113, 0.3781]
[1.2356, 0.9413, 0.9206, 0.803]
[2.1956, 1.0781, 1.0813, 0.9244]
tensor(0.7799, grad_fn=<MeanBackward0>)
tensor(0.6648, grad_fn=<MeanBackward0>)
tensor([ 1.3190, -0.0220,  0.7668, -0.5706,  0.9262, -0.4454,  1.5955,  0.2955,
         0.2991, -1.0775], grad_fn=<MeanBackward1>)
tensor([0.3243, 0.3270, 1.2444, 1.2933, 1.2016, 1.3211, 0.3255, 0.3710, 0.3100,
        0.3331], grad_fn=<StdBackward1>)
tensor([ 1.3391, -0.1074,  0.5010, -1.3290,  2.1069,  0.5312,  1.5520,  0.3921,
         0.4158, -1.3569])
KL div untrained: 3.171226828591334e+16
KL div trained: 0.1489
