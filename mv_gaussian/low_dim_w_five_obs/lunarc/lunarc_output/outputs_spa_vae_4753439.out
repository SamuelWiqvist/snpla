/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1958, grad_fn=<MeanBackward0>)
tensor(3.3128, grad_fn=<MeanBackward0>)
tensor([ 0.3175,  0.0105,  0.2206, -0.0039, -0.1017,  0.2058,  0.2144, -0.1906,
         0.1168, -0.1233], grad_fn=<MeanBackward1>)
tensor([1.0049, 0.9541, 1.0431, 0.9524, 0.9978, 1.1075, 0.9616, 0.9663, 0.9318,
        1.0879], grad_fn=<StdBackward1>)
tensor([-6.3982, -4.8545, -3.3454, -1.6092, -5.9239, -3.9370, -2.4774, -0.2256,
        -1.9124, -0.2989])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.624758627319336, eval loss: [NA]
Epoch: 1, loss: 7.097892019653321, eval loss: [NA]
Epoch: 2, loss: 7.018170230102539, eval loss: [NA]
Epoch: 3, loss: 6.967340924072266, eval loss: [NA]
Epoch: 4, loss: 6.974791836547851, eval loss: [NA]
Epoch: 5, loss: 6.9194145751953124, eval loss: [NA]
Epoch: 6, loss: 6.836844580078125, eval loss: [NA]
Epoch: 7, loss: 6.562060171508789, eval loss: [NA]
Epoch: 8, loss: 6.292110195922851, eval loss: [NA]
Epoch: 9, loss: 5.790496331787109, eval loss: [NA]
Epoch: 10, loss: 5.11424691772461, eval loss: [NA]
Epoch: 11, loss: 4.909236315917969, eval loss: [NA]
Epoch: 12, loss: 4.841686856079102, eval loss: [NA]
Epoch: 13, loss: 4.795268832397461, eval loss: [NA]
Epoch: 14, loss: 4.735423832702637, eval loss: [NA]
Epoch: 15, loss: 4.73783797454834, eval loss: [NA]
Epoch: 16, loss: 4.70005951385498, eval loss: [NA]
Epoch: 17, loss: 4.582662281799316, eval loss: [NA]
Epoch: 18, loss: 4.167259980773926, eval loss: [NA]
Epoch: 19, loss: 3.8750406524658203, eval loss: [NA]
Epoch: 20, loss: 3.8291792205810546, eval loss: [NA]
Epoch: 21, loss: 3.807130209350586, eval loss: [NA]
Epoch: 22, loss: 3.716208918762207, eval loss: [NA]
Epoch: 23, loss: 3.641188153076172, eval loss: [NA]
Epoch: 24, loss: 3.5750257293701173, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.9302601420879364, eval loss: [NA]
Epoch: 1, loss: 0.8117102934420108, eval loss: [NA]
Epoch: 2, loss: 0.6485557945072651, eval loss: [NA]
Epoch: 3, loss: 0.5927756226062775, eval loss: [NA]
Epoch: 4, loss: 0.5474509900808334, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 15.181541275978088, eval loss: [NA]
Epoch: 1, loss: 15.06999324798584, eval loss: [NA]
Epoch: 2, loss: 15.041788172721862, eval loss: [NA]
Epoch: 3, loss: 15.054295129776001, eval loss: [NA]
Epoch: 4, loss: 15.063747820854188, eval loss: [NA]
Epoch: 5, loss: 15.057806434631347, eval loss: [NA]
Epoch: 6, loss: 15.035389809608459, eval loss: [NA]
Epoch: 7, loss: 15.064532718658448, eval loss: [NA]
Epoch: 8, loss: 15.039633712768556, eval loss: [NA]
Epoch: 9, loss: 15.021841793060302, eval loss: [NA]
Epoch: 10, loss: 15.03644441127777, eval loss: [NA]
Epoch: 11, loss: 15.02490698337555, eval loss: [NA]
Epoch: 12, loss: 15.035142769813538, eval loss: [NA]
Epoch: 13, loss: 15.025969109535218, eval loss: [NA]
Epoch: 14, loss: 15.050384883880616, eval loss: [NA]
Epoch: 15, loss: 15.045436716079712, eval loss: [NA]
Epoch: 16, loss: 15.041785626411437, eval loss: [NA]
Epoch: 17, loss: 15.024341382980346, eval loss: [NA]
Epoch: 18, loss: 15.010885424613953, eval loss: [NA]
Epoch: 19, loss: 15.033507256507873, eval loss: [NA]
Epoch: 20, loss: 15.04849425792694, eval loss: [NA]
Epoch: 21, loss: 15.014208545684815, eval loss: [NA]
Epoch: 22, loss: 15.02604845046997, eval loss: [NA]
Epoch: 23, loss: 15.02768048286438, eval loss: [NA]
Epoch: 24, loss: 15.019540386199951, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.516869078063965, eval loss: [NA]
Epoch: 1, loss: 3.454567364501953, eval loss: [NA]
Epoch: 2, loss: 3.350407827758789, eval loss: [NA]
Epoch: 3, loss: 3.1049334426879884, eval loss: [NA]
Epoch: 4, loss: 2.837606936645508, eval loss: [NA]
Epoch: 5, loss: 2.7276669357299803, eval loss: [NA]
Epoch: 6, loss: 2.675087718200684, eval loss: [NA]
Epoch: 7, loss: 2.6916944396972657, eval loss: [NA]
Epoch: 8, loss: 2.6970879623413087, eval loss: [NA]
Epoch: 9, loss: 2.62542419128418, eval loss: [NA]
Epoch: 10, loss: 2.5606981185913087, eval loss: [NA]
Epoch: 11, loss: 2.59480574798584, eval loss: [NA]
Epoch: 12, loss: 2.539362446594238, eval loss: [NA]
Epoch: 13, loss: 2.5372681472778322, eval loss: [NA]
Epoch: 14, loss: 2.537389796447754, eval loss: [NA]
Epoch: 15, loss: 2.4961804138183594, eval loss: [NA]
Epoch: 16, loss: 2.4660169158935545, eval loss: [NA]
Epoch: 17, loss: 2.492708428955078, eval loss: [NA]
Epoch: 18, loss: 2.455778028869629, eval loss: [NA]
Epoch: 19, loss: 2.4446681945800783, eval loss: [NA]
Epoch: 20, loss: 2.4404677810668947, eval loss: [NA]
Epoch: 21, loss: 2.5350390396118163, eval loss: [NA]
Epoch: 22, loss: 2.4701898712158203, eval loss: [NA]
Epoch: 23, loss: 2.3576706848144533, eval loss: [NA]
Epoch: 24, loss: 2.4274377517700194, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.90121720790863, eval loss: [NA]
Epoch: 1, loss: 10.893976664543152, eval loss: [NA]
Epoch: 2, loss: 10.879812865257263, eval loss: [NA]
Epoch: 3, loss: 10.890491061210632, eval loss: [NA]
Epoch: 4, loss: 10.837265844345092, eval loss: [NA]
Epoch: 5, loss: 10.826506299972534, eval loss: [NA]
Epoch: 6, loss: 10.866649608612061, eval loss: [NA]
Epoch: 7, loss: 10.860879225730896, eval loss: [NA]
Epoch: 8, loss: 10.871287989616395, eval loss: [NA]
Epoch: 9, loss: 10.856332387924194, eval loss: [NA]
Epoch: 10, loss: 10.879540629386902, eval loss: [NA]
Epoch: 11, loss: 10.878764610290528, eval loss: [NA]
Epoch: 12, loss: 10.868770422935485, eval loss: [NA]
Epoch: 13, loss: 10.878514695167542, eval loss: [NA]
Epoch: 14, loss: 10.882787518501281, eval loss: [NA]
Epoch: 15, loss: 10.849973096847535, eval loss: [NA]
Epoch: 16, loss: 10.851784725189209, eval loss: [NA]
Epoch: 17, loss: 10.876793208122253, eval loss: [NA]
Epoch: 18, loss: 10.894683594703674, eval loss: [NA]
Epoch: 19, loss: 10.90466688632965, eval loss: [NA]
Epoch: 20, loss: 10.8392045211792, eval loss: [NA]
Epoch: 21, loss: 10.845012397766114, eval loss: [NA]
Epoch: 22, loss: 10.855021290779113, eval loss: [NA]
Epoch: 23, loss: 10.858918447494506, eval loss: [NA]
Epoch: 24, loss: 10.878803977966308, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 2.457290478515625, eval loss: [NA]
Epoch: 1, loss: 2.4061334884643553, eval loss: [NA]
Epoch: 2, loss: 2.4201328994750977, eval loss: [NA]
Epoch: 3, loss: 2.3917709396362303, eval loss: [NA]
Epoch: 4, loss: 2.416527325439453, eval loss: [NA]
Epoch: 5, loss: 2.4262088806152344, eval loss: [NA]
Epoch: 6, loss: 2.397631120300293, eval loss: [NA]
Epoch: 7, loss: 2.4169525802612304, eval loss: [NA]
Epoch: 8, loss: 2.3978010498046873, eval loss: [NA]
Epoch: 9, loss: 2.365944125366211, eval loss: [NA]
Epoch: 10, loss: 2.378011488342285, eval loss: [NA]
Epoch: 11, loss: 2.378776902770996, eval loss: [NA]
Epoch: 12, loss: 2.3896103912353515, eval loss: [NA]
Epoch: 13, loss: 2.3706950988769533, eval loss: [NA]
Epoch: 14, loss: 2.397821827697754, eval loss: [NA]
Epoch: 15, loss: 2.3953431259155273, eval loss: [NA]
Epoch: 16, loss: 2.438008575439453, eval loss: [NA]
Epoch: 17, loss: 2.3849252487182615, eval loss: [NA]
Epoch: 18, loss: 2.3688295639038084, eval loss: [NA]
Epoch: 19, loss: 2.3675384704589844, eval loss: [NA]
Epoch: 20, loss: 2.3703739059448243, eval loss: [NA]
Epoch: 21, loss: 2.3709100494384767, eval loss: [NA]
Epoch: 22, loss: 2.3416336639404296, eval loss: [NA]
Epoch: 23, loss: 2.342242465209961, eval loss: [NA]
Epoch: 24, loss: 2.417732014465332, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.089552164077759, eval loss: [NA]
Epoch: 1, loss: 11.127177147865295, eval loss: [NA]
Epoch: 2, loss: 11.099145650863647, eval loss: [NA]
Epoch: 3, loss: 11.11719778060913, eval loss: [NA]
Epoch: 4, loss: 11.110784435272217, eval loss: [NA]
Epoch: 5, loss: 11.107051339149475, eval loss: [NA]
Epoch: 6, loss: 11.115563426017761, eval loss: [NA]
Epoch: 7, loss: 11.07061282157898, eval loss: [NA]
Epoch: 8, loss: 11.083866171836853, eval loss: [NA]
Epoch: 9, loss: 11.109008927345275, eval loss: [NA]
Epoch: 10, loss: 11.104445309638978, eval loss: [NA]
Epoch: 11, loss: 11.088767414093018, eval loss: [NA]
Epoch: 12, loss: 11.10314019203186, eval loss: [NA]
Epoch: 13, loss: 11.141196389198303, eval loss: [NA]
Epoch: 14, loss: 11.097141494750977, eval loss: [NA]
Epoch: 15, loss: 11.107937908172607, eval loss: [NA]
Epoch: 16, loss: 11.067343339920043, eval loss: [NA]
Epoch: 17, loss: 11.087513484954833, eval loss: [NA]
Epoch: 18, loss: 11.091147971153259, eval loss: [NA]
Epoch: 19, loss: 11.084883923530578, eval loss: [NA]
Epoch: 20, loss: 11.095266366004944, eval loss: [NA]
Epoch: 21, loss: 11.111934328079224, eval loss: [NA]
Epoch: 22, loss: 11.135988411903382, eval loss: [NA]
Epoch: 23, loss: 11.117072205543518, eval loss: [NA]
Epoch: 24, loss: 11.10431529045105, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 2.3722545318603516, eval loss: [NA]
Epoch: 1, loss: 2.342545486450195, eval loss: [NA]
Epoch: 2, loss: 2.364244857788086, eval loss: [NA]
Epoch: 3, loss: 2.3429148849487307, eval loss: [NA]
Epoch: 4, loss: 2.3438477462768557, eval loss: [NA]
Epoch: 5, loss: 2.3632050827026365, eval loss: [NA]
Epoch: 6, loss: 2.355308561706543, eval loss: [NA]
Epoch: 7, loss: 2.3290839965820314, eval loss: [NA]
Epoch: 8, loss: 2.332946862792969, eval loss: [NA]
Epoch: 9, loss: 2.345574418640137, eval loss: [NA]
Epoch: 10, loss: 2.3357969329833983, eval loss: [NA]
Epoch: 11, loss: 2.3284398773193358, eval loss: [NA]
Epoch: 12, loss: 2.308937030029297, eval loss: [NA]
Epoch: 13, loss: 2.3378638122558595, eval loss: [NA]
Epoch: 14, loss: 2.3348176727294923, eval loss: [NA]
Epoch: 15, loss: 2.313221504211426, eval loss: [NA]
Epoch: 16, loss: 2.310325929260254, eval loss: [NA]
Epoch: 17, loss: 2.321825569152832, eval loss: [NA]
Epoch: 18, loss: 2.3433459381103514, eval loss: [NA]
Epoch: 19, loss: 2.322790768432617, eval loss: [NA]
Epoch: 20, loss: 2.3011871765136718, eval loss: [NA]
Epoch: 21, loss: 2.380901516723633, eval loss: [NA]
Epoch: 22, loss: 2.3054087295532226, eval loss: [NA]
Epoch: 23, loss: 2.3355739166259766, eval loss: [NA]
Epoch: 24, loss: 2.315340773010254, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.754936380386352, eval loss: [NA]
Epoch: 1, loss: 10.742592959403991, eval loss: [NA]
Epoch: 2, loss: 10.74216594696045, eval loss: [NA]
Epoch: 3, loss: 10.71366777896881, eval loss: [NA]
Epoch: 4, loss: 10.706121129989624, eval loss: [NA]
Epoch: 5, loss: 10.745016241073609, eval loss: [NA]
Epoch: 6, loss: 10.7268154668808, eval loss: [NA]
Epoch: 7, loss: 10.7332461643219, eval loss: [NA]
Epoch: 8, loss: 10.698481540679932, eval loss: [NA]
Epoch: 9, loss: 10.748649883270264, eval loss: [NA]
Epoch: 10, loss: 10.754292349815369, eval loss: [NA]
Epoch: 11, loss: 10.759702410697937, eval loss: [NA]
Epoch: 12, loss: 10.752678546905518, eval loss: [NA]
Epoch: 13, loss: 10.753094038963319, eval loss: [NA]
Epoch: 14, loss: 10.6893967628479, eval loss: [NA]
Epoch: 15, loss: 10.748264875411987, eval loss: [NA]
Epoch: 16, loss: 10.717636575698853, eval loss: [NA]
Epoch: 17, loss: 10.747840504646302, eval loss: [NA]
Epoch: 18, loss: 10.752762122154236, eval loss: [NA]
Epoch: 19, loss: 10.751398344039917, eval loss: [NA]
Epoch: 20, loss: 10.719279685020446, eval loss: [NA]
Epoch: 21, loss: 10.718941793441772, eval loss: [NA]
Epoch: 22, loss: 10.762241797447205, eval loss: [NA]
Epoch: 23, loss: 10.735440759658813, eval loss: [NA]
Epoch: 24, loss: 10.710131072998047, eval loss: [NA]

Runtime:381.13
[100669988130.6189, 0.2638, 0.1251, 0.1252]
[3.3128, 0.9798, 0.646, 0.6569]
[2.1958, 0.6691, 0.5404, 0.5524]
tensor(0.5476, grad_fn=<MeanBackward0>)
tensor(0.6363, grad_fn=<MeanBackward0>)
tensor([-6.4582, -4.7772, -3.4200, -1.4595, -5.6503, -3.8256, -2.4895, -0.4639,
        -4.0169, -2.0940], grad_fn=<MeanBackward1>)
tensor([0.3251, 0.3350, 0.3187, 0.3334, 0.3494, 0.3490, 0.3038, 0.3330, 1.1924,
        1.3306], grad_fn=<StdBackward1>)
tensor([-6.3982, -4.8545, -3.3454, -1.6092, -5.9239, -3.9370, -2.4774, -0.2256,
        -1.9124, -0.2989])
KL div untrained: 100550494128.3828
KL div trained: 0.0856
