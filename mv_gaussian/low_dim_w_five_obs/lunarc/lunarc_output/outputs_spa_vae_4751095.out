/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1708, grad_fn=<MeanBackward0>)
tensor(2.5073, grad_fn=<MeanBackward0>)
tensor([ 0.0762, -0.0392,  0.2001, -0.1107,  0.2271,  0.0320, -0.0049,  0.1850,
         0.2128,  0.1578], grad_fn=<MeanBackward1>)
tensor([0.8797, 1.0463, 0.9870, 0.9817, 1.1571, 0.9245, 1.0125, 0.8914, 1.0011,
        1.0603], grad_fn=<StdBackward1>)
tensor([-2.0528, -3.3627, -1.7006, -3.0799, -0.2618, -1.2785, -2.3681, -3.6668,
        -2.7483, -3.0060])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.56924091796875, eval loss: [NA]
Epoch: 1, loss: 7.1131670227050785, eval loss: [NA]
Epoch: 2, loss: 7.01835673828125, eval loss: [NA]
Epoch: 3, loss: 6.947199234008789, eval loss: [NA]
Epoch: 4, loss: 6.9220109497070315, eval loss: [NA]
Epoch: 5, loss: 6.895156918334961, eval loss: [NA]
Epoch: 6, loss: 6.8379252227783205, eval loss: [NA]
Epoch: 7, loss: 6.576987319946289, eval loss: [NA]
Epoch: 8, loss: 6.259638934326172, eval loss: [NA]
Epoch: 9, loss: 5.993412115478516, eval loss: [NA]
Epoch: 10, loss: 5.924091607666016, eval loss: [NA]
Epoch: 11, loss: 5.875338198852539, eval loss: [NA]
Epoch: 12, loss: 5.833780656433105, eval loss: [NA]
Epoch: 13, loss: 5.826949728393554, eval loss: [NA]
Epoch: 14, loss: 5.804126167297364, eval loss: [NA]
Epoch: 15, loss: 5.78688276977539, eval loss: [NA]
Epoch: 16, loss: 5.820415023803711, eval loss: [NA]
Epoch: 17, loss: 5.762123426818848, eval loss: [NA]
Epoch: 18, loss: 5.760892544555664, eval loss: [NA]
Epoch: 19, loss: 5.777025886535645, eval loss: [NA]
Epoch: 20, loss: 5.757512734985352, eval loss: [NA]
Epoch: 21, loss: 5.76558345489502, eval loss: [NA]
Epoch: 22, loss: 5.7513926879882815, eval loss: [NA]
Epoch: 23, loss: 5.7531001739501955, eval loss: [NA]
Epoch: 24, loss: 5.732765367126465, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 16971670504.123161, eval loss: [NA]
Epoch: 1, loss: 6.692562687397003, eval loss: [NA]
Epoch: 2, loss: 6.686640245914459, eval loss: [NA]
Epoch: 3, loss: 6.668518645763397, eval loss: [NA]
Epoch: 4, loss: 6.672398040294647, eval loss: [NA]
Epoch: 5, loss: 6.664778563976288, eval loss: [NA]
Epoch: 6, loss: 6.655218865871429, eval loss: [NA]
Epoch: 7, loss: 6.6862406516075135, eval loss: [NA]
Epoch: 8, loss: 6.648286573886871, eval loss: [NA]
Epoch: 9, loss: 6.681521458625793, eval loss: [NA]
Epoch: 10, loss: 6.669172012805939, eval loss: [NA]
Epoch: 11, loss: 6.646960785388947, eval loss: [NA]
Epoch: 12, loss: 6.66974228143692, eval loss: [NA]
Epoch: 13, loss: 6.664273390769958, eval loss: [NA]
Epoch: 14, loss: 6.6860319209098815, eval loss: [NA]
Epoch: 15, loss: 6.686389536857605, eval loss: [NA]
Epoch: 16, loss: 6.665423014163971, eval loss: [NA]
Epoch: 17, loss: 6.671004946231842, eval loss: [NA]
Epoch: 18, loss: 6.685524003505707, eval loss: [NA]
Epoch: 19, loss: 6.668867797851562, eval loss: [NA]
Epoch: 20, loss: 6.692426118850708, eval loss: [NA]
Epoch: 21, loss: 6.675228452682495, eval loss: [NA]
Epoch: 22, loss: 6.674230902194977, eval loss: [NA]
Epoch: 23, loss: 6.668805978298187, eval loss: [NA]
Epoch: 24, loss: 6.684326214790344, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.725801809692383, eval loss: [NA]
Epoch: 1, loss: 5.68933832244873, eval loss: [NA]
Epoch: 2, loss: 5.664186027526855, eval loss: [NA]
Epoch: 3, loss: 5.661106602478028, eval loss: [NA]
Epoch: 4, loss: 5.670226324462891, eval loss: [NA]
Epoch: 5, loss: 5.651155282592773, eval loss: [NA]
Epoch: 6, loss: 5.668999951171875, eval loss: [NA]
Epoch: 7, loss: 5.6538195602417, eval loss: [NA]
Epoch: 8, loss: 5.654146876525879, eval loss: [NA]
Epoch: 9, loss: 5.648745960998535, eval loss: [NA]
Epoch: 10, loss: 5.678610891723633, eval loss: [NA]
Epoch: 11, loss: 5.662413256835937, eval loss: [NA]
Epoch: 12, loss: 5.664357545471192, eval loss: [NA]
Epoch: 13, loss: 5.654590922546387, eval loss: [NA]
Epoch: 14, loss: 5.666307122802734, eval loss: [NA]
Epoch: 15, loss: 5.678531266784668, eval loss: [NA]
Epoch: 16, loss: 5.631380804443359, eval loss: [NA]
Epoch: 17, loss: 5.65319744720459, eval loss: [NA]
Epoch: 18, loss: 5.654373266601563, eval loss: [NA]
Epoch: 19, loss: 5.64511827545166, eval loss: [NA]
Epoch: 20, loss: 5.643101170349121, eval loss: [NA]
Epoch: 21, loss: 5.647776570129395, eval loss: [NA]
Epoch: 22, loss: 5.658118092346191, eval loss: [NA]
Epoch: 23, loss: 5.665845242309571, eval loss: [NA]
Epoch: 24, loss: 5.6590491424560545, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.581777601242066, eval loss: [NA]
Epoch: 1, loss: 6.602107319831848, eval loss: [NA]
Epoch: 2, loss: 6.587244682312011, eval loss: [NA]
Epoch: 3, loss: 6.595135986804962, eval loss: [NA]
Epoch: 4, loss: 6.576407914161682, eval loss: [NA]
Epoch: 5, loss: 6.60381323337555, eval loss: [NA]
Epoch: 6, loss: 6.592706618309021, eval loss: [NA]
Epoch: 7, loss: 6.595188963413238, eval loss: [NA]
Epoch: 8, loss: 6.598254780769349, eval loss: [NA]
Epoch: 9, loss: 6.5881884598732, eval loss: [NA]
Epoch: 10, loss: 6.605557651519775, eval loss: [NA]
Epoch: 11, loss: 6.62340850353241, eval loss: [NA]
Epoch: 12, loss: 6.610517106056213, eval loss: [NA]
Epoch: 13, loss: 6.576180608272552, eval loss: [NA]
Epoch: 14, loss: 6.57606742143631, eval loss: [NA]
Epoch: 15, loss: 6.605148370265961, eval loss: [NA]
Epoch: 16, loss: 6.607170062065125, eval loss: [NA]
Epoch: 17, loss: 6.606749641895294, eval loss: [NA]
Epoch: 18, loss: 6.607827503681182, eval loss: [NA]
Epoch: 19, loss: 6.596472809314728, eval loss: [NA]
Epoch: 20, loss: 6.587689661979676, eval loss: [NA]
Epoch: 21, loss: 6.609299631118774, eval loss: [NA]
Epoch: 22, loss: 6.588188526630401, eval loss: [NA]
Epoch: 23, loss: 6.591541254520417, eval loss: [NA]
Epoch: 24, loss: 6.615558636188507, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 5.658837840270996, eval loss: [NA]
Epoch: 1, loss: 5.664795195007324, eval loss: [NA]
Epoch: 2, loss: 5.635920031738281, eval loss: [NA]
Epoch: 3, loss: 5.651865155029297, eval loss: [NA]
Epoch: 4, loss: 5.651235960388184, eval loss: [NA]
Epoch: 5, loss: 5.643036328125, eval loss: [NA]
Epoch: 6, loss: 5.663421026611328, eval loss: [NA]
Epoch: 7, loss: 5.643749684143066, eval loss: [NA]
Epoch: 8, loss: 5.635773352050781, eval loss: [NA]
Epoch: 9, loss: 5.638036776733398, eval loss: [NA]
Epoch: 10, loss: 5.656293881225586, eval loss: [NA]
Epoch: 11, loss: 5.640806764221192, eval loss: [NA]
Epoch: 12, loss: 5.66178028717041, eval loss: [NA]
Epoch: 13, loss: 5.631247581481934, eval loss: [NA]
Epoch: 14, loss: 5.6224910888671875, eval loss: [NA]
Epoch: 15, loss: 5.632252301025391, eval loss: [NA]
Epoch: 16, loss: 5.633448742675781, eval loss: [NA]
Epoch: 17, loss: 5.654425112915039, eval loss: [NA]
Epoch: 18, loss: 5.658868328857422, eval loss: [NA]
Epoch: 19, loss: 5.639053797912598, eval loss: [NA]
Epoch: 20, loss: 5.661019367980957, eval loss: [NA]
Epoch: 21, loss: 5.660042121887207, eval loss: [NA]
Epoch: 22, loss: 5.616489433288574, eval loss: [NA]
Epoch: 23, loss: 5.617799031066895, eval loss: [NA]
Epoch: 24, loss: 5.640929766845703, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.488324468135834, eval loss: [NA]
Epoch: 1, loss: 6.487750263214111, eval loss: [NA]
Epoch: 2, loss: 6.484406204223633, eval loss: [NA]
Epoch: 3, loss: 6.467972285747528, eval loss: [NA]
Epoch: 4, loss: 6.469436173439026, eval loss: [NA]
Epoch: 5, loss: 6.487241148948669, eval loss: [NA]
Epoch: 6, loss: 6.46833375453949, eval loss: [NA]
Epoch: 7, loss: 6.480660693645477, eval loss: [NA]
Epoch: 8, loss: 6.473709149360657, eval loss: [NA]
Epoch: 9, loss: 6.4965623545646665, eval loss: [NA]
Epoch: 10, loss: 6.463799288272858, eval loss: [NA]
Epoch: 11, loss: 6.474219172000885, eval loss: [NA]
Epoch: 12, loss: 6.468585162162781, eval loss: [NA]
Epoch: 13, loss: 6.467440962791443, eval loss: [NA]
Epoch: 14, loss: 6.4755702352523805, eval loss: [NA]
Epoch: 15, loss: 6.463461549282074, eval loss: [NA]
Epoch: 16, loss: 6.4694587516784665, eval loss: [NA]
Epoch: 17, loss: 6.475557672977447, eval loss: [NA]
Epoch: 18, loss: 6.466113092899323, eval loss: [NA]
Epoch: 19, loss: 6.4560361671447755, eval loss: [NA]
Epoch: 20, loss: 6.470859224796295, eval loss: [NA]
Epoch: 21, loss: 6.477099103927612, eval loss: [NA]
Epoch: 22, loss: 6.469315028190612, eval loss: [NA]
Epoch: 23, loss: 6.470348732471466, eval loss: [NA]
Epoch: 24, loss: 6.497392172813416, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 5.660979545593261, eval loss: [NA]
Epoch: 1, loss: 5.646459025573731, eval loss: [NA]
Epoch: 2, loss: 5.666713465881347, eval loss: [NA]
Epoch: 3, loss: 5.657604605102539, eval loss: [NA]
Epoch: 4, loss: 5.6640680862426755, eval loss: [NA]
Epoch: 5, loss: 5.648576748657226, eval loss: [NA]
Epoch: 6, loss: 5.666177764892578, eval loss: [NA]
Epoch: 7, loss: 5.650966682434082, eval loss: [NA]
Epoch: 8, loss: 5.6592473114013675, eval loss: [NA]
Epoch: 9, loss: 5.680875634765625, eval loss: [NA]
Epoch: 10, loss: 5.672781108093262, eval loss: [NA]
Epoch: 11, loss: 5.669970700073242, eval loss: [NA]
Epoch: 12, loss: 5.649124125671387, eval loss: [NA]
Epoch: 13, loss: 5.656404382324219, eval loss: [NA]
Epoch: 14, loss: 5.672944534301758, eval loss: [NA]
Epoch: 15, loss: 5.656840042114258, eval loss: [NA]
Epoch: 16, loss: 5.659205325317383, eval loss: [NA]
Epoch: 17, loss: 5.6558096252441405, eval loss: [NA]
Epoch: 18, loss: 5.657094209289551, eval loss: [NA]
Epoch: 19, loss: 5.648061865234375, eval loss: [NA]
Epoch: 20, loss: 5.644214692687989, eval loss: [NA]
Epoch: 21, loss: 5.669313247680664, eval loss: [NA]
Epoch: 22, loss: 5.6486033294677735, eval loss: [NA]
Epoch: 23, loss: 5.655893586730957, eval loss: [NA]
Epoch: 24, loss: 5.657805986022949, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.570740432739258, eval loss: [NA]
Epoch: 1, loss: 6.552531201839447, eval loss: [NA]
Epoch: 2, loss: 6.572247457504273, eval loss: [NA]
Epoch: 3, loss: 6.56623859167099, eval loss: [NA]
Epoch: 4, loss: 6.540403206348419, eval loss: [NA]
Epoch: 5, loss: 6.565451607704163, eval loss: [NA]
Epoch: 6, loss: 6.570417449474335, eval loss: [NA]
Epoch: 7, loss: 6.55924290895462, eval loss: [NA]
Epoch: 8, loss: 6.567483170032501, eval loss: [NA]
Epoch: 9, loss: 6.558385388851166, eval loss: [NA]
Epoch: 10, loss: 6.562609517574311, eval loss: [NA]
Epoch: 11, loss: 6.564650177955627, eval loss: [NA]
Epoch: 12, loss: 6.561489980220795, eval loss: [NA]
Epoch: 13, loss: 6.548473069667816, eval loss: [NA]
Epoch: 14, loss: 6.569167227745056, eval loss: [NA]
Epoch: 15, loss: 6.567876801490784, eval loss: [NA]
Epoch: 16, loss: 6.550652797222138, eval loss: [NA]
Epoch: 17, loss: 6.573474700450897, eval loss: [NA]
Epoch: 18, loss: 6.562408390045166, eval loss: [NA]
Epoch: 19, loss: 6.571101748943329, eval loss: [NA]
Epoch: 20, loss: 6.564760971069336, eval loss: [NA]
Epoch: 21, loss: 6.578356256484986, eval loss: [NA]
Epoch: 22, loss: 6.552522995471954, eval loss: [NA]
Epoch: 23, loss: 6.568459711074829, eval loss: [NA]
Epoch: 24, loss: 6.56526563167572, eval loss: [NA]

Runtime:415.83
[3506495201.3522, 0.9324, 1.1011, 0.9637]
[2.5073, 0.8957, 0.8878, 0.8931]
[2.1708, 1.1019, 1.1083, 1.0945]
tensor(1.0878, grad_fn=<MeanBackward0>)
tensor(0.8834, grad_fn=<MeanBackward0>)
tensor([-1.8223, -2.7730, -1.8912, -2.9156, -0.3063, -1.1592, -1.9006, -2.8444,
        -1.7826, -2.8058], grad_fn=<MeanBackward1>)
tensor([1.1577, 1.2794, 1.1342, 1.2378, 0.3278, 0.3369, 1.0819, 1.1729, 1.1526,
        1.2313], grad_fn=<StdBackward1>)
tensor([-2.0528, -3.3627, -1.7006, -3.0799, -0.2618, -1.2785, -2.3681, -3.6668,
        -2.7483, -3.0060])
KL div untrained: 27440389.962
KL div trained: 1.3041
