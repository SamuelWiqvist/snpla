/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1958, grad_fn=<MeanBackward0>)
tensor(3.3128, grad_fn=<MeanBackward0>)
tensor([ 0.3175,  0.0105,  0.2206, -0.0039, -0.1017,  0.2058,  0.2144, -0.1906,
         0.1168, -0.1233], grad_fn=<MeanBackward1>)
tensor([1.0049, 0.9541, 1.0431, 0.9524, 0.9978, 1.1075, 0.9616, 0.9663, 0.9318,
        1.0879], grad_fn=<StdBackward1>)
tensor([-6.3982, -4.8545, -3.3454, -1.6092, -5.9239, -3.9370, -2.4774, -0.2256,
        -1.9124, -0.2989])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.624758627319336, eval loss: [NA]
Epoch: 1, loss: 7.097892019653321, eval loss: [NA]
Epoch: 2, loss: 7.018170230102539, eval loss: [NA]
Epoch: 3, loss: 6.967340924072266, eval loss: [NA]
Epoch: 4, loss: 6.974791836547851, eval loss: [NA]
Epoch: 5, loss: 6.9194145751953124, eval loss: [NA]
Epoch: 6, loss: 6.836844580078125, eval loss: [NA]
Epoch: 7, loss: 6.562060171508789, eval loss: [NA]
Epoch: 8, loss: 6.292110195922851, eval loss: [NA]
Epoch: 9, loss: 5.790496331787109, eval loss: [NA]
Epoch: 10, loss: 5.11424691772461, eval loss: [NA]
Epoch: 11, loss: 4.909236315917969, eval loss: [NA]
Epoch: 12, loss: 4.841686856079102, eval loss: [NA]
Epoch: 13, loss: 4.795268832397461, eval loss: [NA]
Epoch: 14, loss: 4.735423832702637, eval loss: [NA]
Epoch: 15, loss: 4.73783797454834, eval loss: [NA]
Epoch: 16, loss: 4.70005951385498, eval loss: [NA]
Epoch: 17, loss: 4.582662281799316, eval loss: [NA]
Epoch: 18, loss: 4.167259980773926, eval loss: [NA]
Epoch: 19, loss: 3.8750406524658203, eval loss: [NA]
Epoch: 20, loss: 3.8291792205810546, eval loss: [NA]
Epoch: 21, loss: 3.807130209350586, eval loss: [NA]
Epoch: 22, loss: 3.716208918762207, eval loss: [NA]
Epoch: 23, loss: 3.641188153076172, eval loss: [NA]
Epoch: 24, loss: 3.5750257293701173, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 2260.3497699165346, eval loss: [NA]
Epoch: 1, loss: 16.48679177284241, eval loss: [NA]
Epoch: 2, loss: 15.632349457740784, eval loss: [NA]
Epoch: 3, loss: 15.294405369758605, eval loss: [NA]
Epoch: 4, loss: 15.154342308044434, eval loss: [NA]
Epoch: 5, loss: 15.14096206188202, eval loss: [NA]
Epoch: 6, loss: 15.101838326454162, eval loss: [NA]
Epoch: 7, loss: 15.053643326759339, eval loss: [NA]
Epoch: 8, loss: 15.042026991844176, eval loss: [NA]
Epoch: 9, loss: 15.021207127571106, eval loss: [NA]
Epoch: 10, loss: 15.003044171333313, eval loss: [NA]
Epoch: 11, loss: 15.012469091415404, eval loss: [NA]
Epoch: 12, loss: 15.014467072486877, eval loss: [NA]
Epoch: 13, loss: 15.05743402004242, eval loss: [NA]
Epoch: 14, loss: 15.055258684158325, eval loss: [NA]
Epoch: 15, loss: 15.045943427085877, eval loss: [NA]
Epoch: 16, loss: 15.008938293457032, eval loss: [NA]
Epoch: 17, loss: 15.009635639190673, eval loss: [NA]
Epoch: 18, loss: 15.023062205314636, eval loss: [NA]
Epoch: 19, loss: 15.011967678070068, eval loss: [NA]
Epoch: 20, loss: 15.050151152610779, eval loss: [NA]
Epoch: 21, loss: 15.063741097450256, eval loss: [NA]
Epoch: 22, loss: 15.008999562263488, eval loss: [NA]
Epoch: 23, loss: 15.033582344055176, eval loss: [NA]
Epoch: 24, loss: 14.99994791507721, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.4965175994873046, eval loss: [NA]
Epoch: 1, loss: 3.4690856048583982, eval loss: [NA]
Epoch: 2, loss: 3.3975461013793944, eval loss: [NA]
Epoch: 3, loss: 3.0718571502685545, eval loss: [NA]
Epoch: 4, loss: 2.8793045837402342, eval loss: [NA]
Epoch: 5, loss: 2.732513954162598, eval loss: [NA]
Epoch: 6, loss: 2.7525960479736327, eval loss: [NA]
Epoch: 7, loss: 2.6851872604370115, eval loss: [NA]
Epoch: 8, loss: 2.6417132766723634, eval loss: [NA]
Epoch: 9, loss: 2.63360870513916, eval loss: [NA]
Epoch: 10, loss: 2.6347445068359376, eval loss: [NA]
Epoch: 11, loss: 2.5949194534301756, eval loss: [NA]
Epoch: 12, loss: 2.593682928466797, eval loss: [NA]
Epoch: 13, loss: 2.53992967376709, eval loss: [NA]
Epoch: 14, loss: 2.4864677322387694, eval loss: [NA]
Epoch: 15, loss: 2.506927639770508, eval loss: [NA]
Epoch: 16, loss: 2.4705, eval loss: [NA]
Epoch: 17, loss: 2.4883770950317383, eval loss: [NA]
Epoch: 18, loss: 2.5233881103515623, eval loss: [NA]
Epoch: 19, loss: 2.429550975036621, eval loss: [NA]
Epoch: 20, loss: 2.442860461425781, eval loss: [NA]
Epoch: 21, loss: 2.4422622024536134, eval loss: [NA]
Epoch: 22, loss: 2.4484661544799806, eval loss: [NA]
Epoch: 23, loss: 2.440934098815918, eval loss: [NA]
Epoch: 24, loss: 2.4159838272094727, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.389391560554504, eval loss: [NA]
Epoch: 1, loss: 11.373835649490356, eval loss: [NA]
Epoch: 2, loss: 11.361463584899901, eval loss: [NA]
Epoch: 3, loss: 11.348322434425354, eval loss: [NA]
Epoch: 4, loss: 11.35785804271698, eval loss: [NA]
Epoch: 5, loss: 11.318291244506836, eval loss: [NA]
Epoch: 6, loss: 11.317085456848144, eval loss: [NA]
Epoch: 7, loss: 11.344622921943664, eval loss: [NA]
Epoch: 8, loss: 11.342274646759034, eval loss: [NA]
Epoch: 9, loss: 11.348487186431885, eval loss: [NA]
Epoch: 10, loss: 11.341294722557068, eval loss: [NA]
Epoch: 11, loss: 11.32414430618286, eval loss: [NA]
Epoch: 12, loss: 11.321076169013978, eval loss: [NA]
Epoch: 13, loss: 11.30982834815979, eval loss: [NA]
Epoch: 14, loss: 11.363387308120728, eval loss: [NA]
Epoch: 15, loss: 11.36537901878357, eval loss: [NA]
Epoch: 16, loss: 11.32737135887146, eval loss: [NA]
Epoch: 17, loss: 11.3262983751297, eval loss: [NA]
Epoch: 18, loss: 11.37629541873932, eval loss: [NA]
Epoch: 19, loss: 11.34850489616394, eval loss: [NA]
Epoch: 20, loss: 11.375752058029175, eval loss: [NA]
Epoch: 21, loss: 11.310209159851075, eval loss: [NA]
Epoch: 22, loss: 11.354865260124207, eval loss: [NA]
Epoch: 23, loss: 11.355584568977356, eval loss: [NA]
Epoch: 24, loss: 11.319068579673766, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 2.462718632507324, eval loss: [NA]
Epoch: 1, loss: 2.47803358001709, eval loss: [NA]
Epoch: 2, loss: 2.5060856201171875, eval loss: [NA]
Epoch: 3, loss: 2.4589153579711915, eval loss: [NA]
Epoch: 4, loss: 2.393959217834473, eval loss: [NA]
Epoch: 5, loss: 2.4558312362670898, eval loss: [NA]
Epoch: 6, loss: 2.4424897323608397, eval loss: [NA]
Epoch: 7, loss: 2.427689221191406, eval loss: [NA]
Epoch: 8, loss: 2.3974443099975584, eval loss: [NA]
Epoch: 9, loss: 2.4060213119506835, eval loss: [NA]
Epoch: 10, loss: 2.3943279830932616, eval loss: [NA]
Epoch: 11, loss: 2.3932232315063477, eval loss: [NA]
Epoch: 12, loss: 2.3795339965820315, eval loss: [NA]
Epoch: 13, loss: 2.4008661514282226, eval loss: [NA]
Epoch: 14, loss: 2.397499319458008, eval loss: [NA]
Epoch: 15, loss: 2.378372514343262, eval loss: [NA]
Epoch: 16, loss: 2.4081971893310548, eval loss: [NA]
Epoch: 17, loss: 2.4099144058227537, eval loss: [NA]
Epoch: 18, loss: 2.4129014801025392, eval loss: [NA]
Epoch: 19, loss: 2.387517044067383, eval loss: [NA]
Epoch: 20, loss: 2.369634390258789, eval loss: [NA]
Epoch: 21, loss: 2.3437458786010743, eval loss: [NA]
Epoch: 22, loss: 2.3912389404296874, eval loss: [NA]
Epoch: 23, loss: 2.347226678466797, eval loss: [NA]
Epoch: 24, loss: 2.3549622192382813, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.073549861907958, eval loss: [NA]
Epoch: 1, loss: 11.061596331596375, eval loss: [NA]
Epoch: 2, loss: 11.087408461570739, eval loss: [NA]
Epoch: 3, loss: 11.062222323417664, eval loss: [NA]
Epoch: 4, loss: 11.064270124435424, eval loss: [NA]
Epoch: 5, loss: 11.06603467464447, eval loss: [NA]
Epoch: 6, loss: 11.043107604980468, eval loss: [NA]
Epoch: 7, loss: 11.081635847091675, eval loss: [NA]
Epoch: 8, loss: 11.049954209327698, eval loss: [NA]
Epoch: 9, loss: 11.05822274208069, eval loss: [NA]
Epoch: 10, loss: 11.07343047618866, eval loss: [NA]
Epoch: 11, loss: 11.06921543121338, eval loss: [NA]
Epoch: 12, loss: 11.054431796073914, eval loss: [NA]
Epoch: 13, loss: 11.080222067832947, eval loss: [NA]
Epoch: 14, loss: 11.076835346221923, eval loss: [NA]
Epoch: 15, loss: 11.052542028427125, eval loss: [NA]
Epoch: 16, loss: 11.076347827911377, eval loss: [NA]
Epoch: 17, loss: 11.048591771125793, eval loss: [NA]
Epoch: 18, loss: 11.050936021804809, eval loss: [NA]
Epoch: 19, loss: 11.062847719192504, eval loss: [NA]
Epoch: 20, loss: 11.073861503601075, eval loss: [NA]
Epoch: 21, loss: 11.05751673221588, eval loss: [NA]
Epoch: 22, loss: 11.058729286193847, eval loss: [NA]
Epoch: 23, loss: 11.091520872116089, eval loss: [NA]
Epoch: 24, loss: 11.049329376220703, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 2.3712929626464843, eval loss: [NA]
Epoch: 1, loss: 2.3250868896484373, eval loss: [NA]
Epoch: 2, loss: 2.3387678833007812, eval loss: [NA]
Epoch: 3, loss: 2.326916748046875, eval loss: [NA]
Epoch: 4, loss: 2.336338121032715, eval loss: [NA]
Epoch: 5, loss: 2.3364963928222657, eval loss: [NA]
Epoch: 6, loss: 2.3363228378295897, eval loss: [NA]
Epoch: 7, loss: 2.3738366592407227, eval loss: [NA]
Epoch: 8, loss: 2.365507737731934, eval loss: [NA]
Epoch: 9, loss: 2.324811325073242, eval loss: [NA]
Epoch: 10, loss: 2.330723583984375, eval loss: [NA]
Epoch: 11, loss: 2.3148908004760744, eval loss: [NA]
Epoch: 12, loss: 2.3029786071777343, eval loss: [NA]
Epoch: 13, loss: 2.312465106201172, eval loss: [NA]
Epoch: 14, loss: 2.3214233840942384, eval loss: [NA]
Epoch: 15, loss: 2.342603161621094, eval loss: [NA]
Epoch: 16, loss: 2.3197537109375, eval loss: [NA]
Epoch: 17, loss: 2.3373725143432615, eval loss: [NA]
Epoch: 18, loss: 2.334347378540039, eval loss: [NA]
Epoch: 19, loss: 2.3303899963378907, eval loss: [NA]
Epoch: 20, loss: 2.335115478515625, eval loss: [NA]
Epoch: 21, loss: 2.307040756225586, eval loss: [NA]
Epoch: 22, loss: 2.330293133544922, eval loss: [NA]
Epoch: 23, loss: 2.304588151550293, eval loss: [NA]
Epoch: 24, loss: 2.2936109756469727, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.455170073509215, eval loss: [NA]
Epoch: 1, loss: 11.470351176261902, eval loss: [NA]
Epoch: 2, loss: 11.438888602256775, eval loss: [NA]
Epoch: 3, loss: 11.421669487953187, eval loss: [NA]
Epoch: 4, loss: 11.401431584358216, eval loss: [NA]
Epoch: 5, loss: 11.452499389648438, eval loss: [NA]
Epoch: 6, loss: 11.418731331825256, eval loss: [NA]
Epoch: 7, loss: 11.390307369232177, eval loss: [NA]
Epoch: 8, loss: 11.464804010391235, eval loss: [NA]
Epoch: 9, loss: 11.3936234998703, eval loss: [NA]
Epoch: 10, loss: 11.40757478237152, eval loss: [NA]
Epoch: 11, loss: 11.450548815727235, eval loss: [NA]
Epoch: 12, loss: 11.402578344345093, eval loss: [NA]
Epoch: 13, loss: 11.403367872238158, eval loss: [NA]
Epoch: 14, loss: 11.423248538970947, eval loss: [NA]
Epoch: 15, loss: 11.408388676643371, eval loss: [NA]
Epoch: 16, loss: 11.438221764564513, eval loss: [NA]
Epoch: 17, loss: 11.410213985443114, eval loss: [NA]
Epoch: 18, loss: 11.435404057502746, eval loss: [NA]
Epoch: 19, loss: 11.422716355323791, eval loss: [NA]
Epoch: 20, loss: 11.432025957107545, eval loss: [NA]
Epoch: 21, loss: 11.399530525207519, eval loss: [NA]
Epoch: 22, loss: 11.42001681804657, eval loss: [NA]
Epoch: 23, loss: 11.44066729068756, eval loss: [NA]
Epoch: 24, loss: 11.42690031528473, eval loss: [NA]

Runtime:378.12
[100669988130.6189, 0.2584, 0.0687, 0.1014]
[3.3128, 0.9871, 0.6285, 0.6758]
[2.1958, 0.6667, 0.5409, 0.5361]
tensor(0.5418, grad_fn=<MeanBackward0>)
tensor(0.6928, grad_fn=<MeanBackward0>)
tensor([-6.4072, -4.7203, -3.4258, -1.4871, -5.7507, -4.0073, -2.5534, -0.4728,
        -4.3042, -2.4131], grad_fn=<MeanBackward1>)
tensor([0.3352, 0.3494, 0.3369, 0.3432, 0.3497, 0.3803, 0.3313, 0.3469, 1.0992,
        1.1891], grad_fn=<StdBackward1>)
tensor([-6.3982, -4.8545, -3.3454, -1.6092, -5.9239, -3.9370, -2.4774, -0.2256,
        -1.9124, -0.2989])
KL div untrained: 100550494128.3828
KL div trained: 0.1035
