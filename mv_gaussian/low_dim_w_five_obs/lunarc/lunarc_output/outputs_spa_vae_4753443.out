/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1708, grad_fn=<MeanBackward0>)
tensor(2.5073, grad_fn=<MeanBackward0>)
tensor([ 0.0762, -0.0392,  0.2001, -0.1107,  0.2271,  0.0320, -0.0049,  0.1850,
         0.2128,  0.1578], grad_fn=<MeanBackward1>)
tensor([0.8797, 1.0463, 0.9870, 0.9817, 1.1571, 0.9245, 1.0125, 0.8914, 1.0011,
        1.0603], grad_fn=<StdBackward1>)
tensor([-2.0528, -3.3627, -1.7006, -3.0799, -0.2618, -1.2785, -2.3681, -3.6668,
        -2.7483, -3.0060])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.56924091796875, eval loss: [NA]
Epoch: 1, loss: 7.1131670227050785, eval loss: [NA]
Epoch: 2, loss: 7.01835673828125, eval loss: [NA]
Epoch: 3, loss: 6.947199234008789, eval loss: [NA]
Epoch: 4, loss: 6.9220109497070315, eval loss: [NA]
Epoch: 5, loss: 6.895156918334961, eval loss: [NA]
Epoch: 6, loss: 6.8379252227783205, eval loss: [NA]
Epoch: 7, loss: 6.576987319946289, eval loss: [NA]
Epoch: 8, loss: 6.259638934326172, eval loss: [NA]
Epoch: 9, loss: 5.993412115478516, eval loss: [NA]
Epoch: 10, loss: 5.924091607666016, eval loss: [NA]
Epoch: 11, loss: 5.875338198852539, eval loss: [NA]
Epoch: 12, loss: 5.833780656433105, eval loss: [NA]
Epoch: 13, loss: 5.826949728393554, eval loss: [NA]
Epoch: 14, loss: 5.804126167297364, eval loss: [NA]
Epoch: 15, loss: 5.78688276977539, eval loss: [NA]
Epoch: 16, loss: 5.820415023803711, eval loss: [NA]
Epoch: 17, loss: 5.762123426818848, eval loss: [NA]
Epoch: 18, loss: 5.760892544555664, eval loss: [NA]
Epoch: 19, loss: 5.777025886535645, eval loss: [NA]
Epoch: 20, loss: 5.757512734985352, eval loss: [NA]
Epoch: 21, loss: 5.76558345489502, eval loss: [NA]
Epoch: 22, loss: 5.7513926879882815, eval loss: [NA]
Epoch: 23, loss: 5.7531001739501955, eval loss: [NA]
Epoch: 24, loss: 5.732765367126465, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.918903521001339, eval loss: [NA]
Epoch: 1, loss: 0.8445567978918552, eval loss: [NA]
Epoch: 2, loss: 0.6434364315867424, eval loss: [NA]
Epoch: 3, loss: 0.5929158665239811, eval loss: [NA]
Epoch: 4, loss: 0.5540211959928274, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.697402679920197, eval loss: [NA]
Epoch: 1, loss: 6.705534698963166, eval loss: [NA]
Epoch: 2, loss: 6.7078941798210145, eval loss: [NA]
Epoch: 3, loss: 6.701396350860596, eval loss: [NA]
Epoch: 4, loss: 6.677199983596802, eval loss: [NA]
Epoch: 5, loss: 6.69488748550415, eval loss: [NA]
Epoch: 6, loss: 6.715076932907104, eval loss: [NA]
Epoch: 7, loss: 6.708792095184326, eval loss: [NA]
Epoch: 8, loss: 6.67468175649643, eval loss: [NA]
Epoch: 9, loss: 6.702672805786133, eval loss: [NA]
Epoch: 10, loss: 6.686371960639954, eval loss: [NA]
Epoch: 11, loss: 6.685968854427338, eval loss: [NA]
Epoch: 12, loss: 6.688886966705322, eval loss: [NA]
Epoch: 13, loss: 6.692286460399628, eval loss: [NA]
Epoch: 14, loss: 6.693404693603515, eval loss: [NA]
Epoch: 15, loss: 6.68198734998703, eval loss: [NA]
Epoch: 16, loss: 6.676623415946961, eval loss: [NA]
Epoch: 17, loss: 6.672942323684692, eval loss: [NA]
Epoch: 18, loss: 6.688058648109436, eval loss: [NA]
Epoch: 19, loss: 6.675249025821686, eval loss: [NA]
Epoch: 20, loss: 6.679347405433655, eval loss: [NA]
Epoch: 21, loss: 6.658306694030761, eval loss: [NA]
Epoch: 22, loss: 6.681751291751862, eval loss: [NA]
Epoch: 23, loss: 6.6699738025665285, eval loss: [NA]
Epoch: 24, loss: 6.666099302768707, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.745830381774902, eval loss: [NA]
Epoch: 1, loss: 5.737770634460449, eval loss: [NA]
Epoch: 2, loss: 5.734917944335938, eval loss: [NA]
Epoch: 3, loss: 5.72637395324707, eval loss: [NA]
Epoch: 4, loss: 5.715982667541504, eval loss: [NA]
Epoch: 5, loss: 5.699676203918457, eval loss: [NA]
Epoch: 6, loss: 5.76510572052002, eval loss: [NA]
Epoch: 7, loss: 5.7147408309936525, eval loss: [NA]
Epoch: 8, loss: 5.7163807418823245, eval loss: [NA]
Epoch: 9, loss: 5.717502151489258, eval loss: [NA]
Epoch: 10, loss: 5.709284817504883, eval loss: [NA]
Epoch: 11, loss: 5.706033389282227, eval loss: [NA]
Epoch: 12, loss: 5.695174644470215, eval loss: [NA]
Epoch: 13, loss: 5.708082360839843, eval loss: [NA]
Epoch: 14, loss: 5.712421971130371, eval loss: [NA]
Epoch: 15, loss: 5.705303500366211, eval loss: [NA]
Epoch: 16, loss: 5.715202116394043, eval loss: [NA]
Epoch: 17, loss: 5.704094793701172, eval loss: [NA]
Epoch: 18, loss: 5.696032652282715, eval loss: [NA]
Epoch: 19, loss: 5.718045385742188, eval loss: [NA]
Epoch: 20, loss: 5.694717935180664, eval loss: [NA]
Epoch: 21, loss: 5.70727942199707, eval loss: [NA]
Epoch: 22, loss: 5.681549087524414, eval loss: [NA]
Epoch: 23, loss: 5.698615643310547, eval loss: [NA]
Epoch: 24, loss: 5.696190362548828, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.648426485061646, eval loss: [NA]
Epoch: 1, loss: 6.618743538856506, eval loss: [NA]
Epoch: 2, loss: 6.634620461463928, eval loss: [NA]
Epoch: 3, loss: 6.631520431041718, eval loss: [NA]
Epoch: 4, loss: 6.632935633659363, eval loss: [NA]
Epoch: 5, loss: 6.656650159358978, eval loss: [NA]
Epoch: 6, loss: 6.625288510322571, eval loss: [NA]
Epoch: 7, loss: 6.653510665893554, eval loss: [NA]
Epoch: 8, loss: 6.627683758735657, eval loss: [NA]
Epoch: 9, loss: 6.612389380931854, eval loss: [NA]
Epoch: 10, loss: 6.620792849063873, eval loss: [NA]
Epoch: 11, loss: 6.652675495147705, eval loss: [NA]
Epoch: 12, loss: 6.65050576210022, eval loss: [NA]
Epoch: 13, loss: 6.654026126861572, eval loss: [NA]
Epoch: 14, loss: 6.630489838123322, eval loss: [NA]
Epoch: 15, loss: 6.642859137058258, eval loss: [NA]
Epoch: 16, loss: 6.645288205146789, eval loss: [NA]
Epoch: 17, loss: 6.630153095722198, eval loss: [NA]
Epoch: 18, loss: 6.63457358121872, eval loss: [NA]
Epoch: 19, loss: 6.6308460664749145, eval loss: [NA]
Epoch: 20, loss: 6.6257229113578795, eval loss: [NA]
Epoch: 21, loss: 6.641634688377381, eval loss: [NA]
Epoch: 22, loss: 6.639813730716705, eval loss: [NA]
Epoch: 23, loss: 6.645249886512756, eval loss: [NA]
Epoch: 24, loss: 6.625394475460053, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 5.6717013748168945, eval loss: [NA]
Epoch: 1, loss: 5.682347723388672, eval loss: [NA]
Epoch: 2, loss: 5.6766245010375975, eval loss: [NA]
Epoch: 3, loss: 5.683248497009277, eval loss: [NA]
Epoch: 4, loss: 5.661603709411621, eval loss: [NA]
Epoch: 5, loss: 5.650945736694336, eval loss: [NA]
Epoch: 6, loss: 5.674411494445801, eval loss: [NA]
Epoch: 7, loss: 5.667656196594239, eval loss: [NA]
Epoch: 8, loss: 5.667934262084961, eval loss: [NA]
Epoch: 9, loss: 5.659304725646972, eval loss: [NA]
Epoch: 10, loss: 5.6772927597045895, eval loss: [NA]
Epoch: 11, loss: 5.659762899780273, eval loss: [NA]
Epoch: 12, loss: 5.656492121887207, eval loss: [NA]
Epoch: 13, loss: 5.659326364135742, eval loss: [NA]
Epoch: 14, loss: 5.655101133728027, eval loss: [NA]
Epoch: 15, loss: 5.67610454864502, eval loss: [NA]
Epoch: 16, loss: 5.644455232238769, eval loss: [NA]
Epoch: 17, loss: 5.649760147094726, eval loss: [NA]
Epoch: 18, loss: 5.666594506835938, eval loss: [NA]
Epoch: 19, loss: 5.661018255615234, eval loss: [NA]
Epoch: 20, loss: 5.68545009765625, eval loss: [NA]
Epoch: 21, loss: 5.673718061828613, eval loss: [NA]
Epoch: 22, loss: 5.660715084838867, eval loss: [NA]
Epoch: 23, loss: 5.644508480834961, eval loss: [NA]
Epoch: 24, loss: 5.6535103866577145, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.633002333641052, eval loss: [NA]
Epoch: 1, loss: 6.613920159339905, eval loss: [NA]
Epoch: 2, loss: 6.636116008758545, eval loss: [NA]
Epoch: 3, loss: 6.600966897010803, eval loss: [NA]
Epoch: 4, loss: 6.62609852552414, eval loss: [NA]
Epoch: 5, loss: 6.614945960044861, eval loss: [NA]
Epoch: 6, loss: 6.61549546957016, eval loss: [NA]
Epoch: 7, loss: 6.606884560585022, eval loss: [NA]
Epoch: 8, loss: 6.618234748840332, eval loss: [NA]
Epoch: 9, loss: 6.624995584487915, eval loss: [NA]
Epoch: 10, loss: 6.606525530815125, eval loss: [NA]
Epoch: 11, loss: 6.59543555021286, eval loss: [NA]
Epoch: 12, loss: 6.612224483489991, eval loss: [NA]
Epoch: 13, loss: 6.615808634757996, eval loss: [NA]
Epoch: 14, loss: 6.608734815120697, eval loss: [NA]
Epoch: 15, loss: 6.637121157646179, eval loss: [NA]
Epoch: 16, loss: 6.611068212985993, eval loss: [NA]
Epoch: 17, loss: 6.611183059215546, eval loss: [NA]
Epoch: 18, loss: 6.6180648469924925, eval loss: [NA]
Epoch: 19, loss: 6.624186902046204, eval loss: [NA]
Epoch: 20, loss: 6.61516875743866, eval loss: [NA]
Epoch: 21, loss: 6.62319186925888, eval loss: [NA]
Epoch: 22, loss: 6.606274976730346, eval loss: [NA]
Epoch: 23, loss: 6.624036977291107, eval loss: [NA]
Epoch: 24, loss: 6.61770756483078, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 5.685598767089844, eval loss: [NA]
Epoch: 1, loss: 5.662908103942871, eval loss: [NA]
Epoch: 2, loss: 5.6630264831542965, eval loss: [NA]
Epoch: 3, loss: 5.6646050918579105, eval loss: [NA]
Epoch: 4, loss: 5.683317526245117, eval loss: [NA]
Epoch: 5, loss: 5.674098463439941, eval loss: [NA]
Epoch: 6, loss: 5.681981047058105, eval loss: [NA]
Epoch: 7, loss: 5.6720246429443355, eval loss: [NA]
Epoch: 8, loss: 5.66374799041748, eval loss: [NA]
Epoch: 9, loss: 5.673235949707031, eval loss: [NA]
Epoch: 10, loss: 5.663214585876465, eval loss: [NA]
Epoch: 11, loss: 5.686242887878418, eval loss: [NA]
Epoch: 12, loss: 5.664938850402832, eval loss: [NA]
Epoch: 13, loss: 5.664903642272949, eval loss: [NA]
Epoch: 14, loss: 5.66749771270752, eval loss: [NA]
Epoch: 15, loss: 5.659442735290527, eval loss: [NA]
Epoch: 16, loss: 5.675489086914062, eval loss: [NA]
Epoch: 17, loss: 5.664512547302246, eval loss: [NA]
Epoch: 18, loss: 5.669416809082032, eval loss: [NA]
Epoch: 19, loss: 5.651201327514649, eval loss: [NA]
Epoch: 20, loss: 5.664447673034668, eval loss: [NA]
Epoch: 21, loss: 5.6693186172485355, eval loss: [NA]
Epoch: 22, loss: 5.657659048461914, eval loss: [NA]
Epoch: 23, loss: 5.649874238586426, eval loss: [NA]
Epoch: 24, loss: 5.655805194091797, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.37805853843689, eval loss: [NA]
Epoch: 1, loss: 6.3581225776672365, eval loss: [NA]
Epoch: 2, loss: 6.373066039085388, eval loss: [NA]
Epoch: 3, loss: 6.383766937255859, eval loss: [NA]
Epoch: 4, loss: 6.362860946655274, eval loss: [NA]
Epoch: 5, loss: 6.360979647636413, eval loss: [NA]
Epoch: 6, loss: 6.3890311861038205, eval loss: [NA]
Epoch: 7, loss: 6.365799813270569, eval loss: [NA]
Epoch: 8, loss: 6.389527039527893, eval loss: [NA]
Epoch: 9, loss: 6.376388401985168, eval loss: [NA]
Epoch: 10, loss: 6.373548197746277, eval loss: [NA]
Epoch: 11, loss: 6.389077215194702, eval loss: [NA]
Epoch: 12, loss: 6.373971402645111, eval loss: [NA]
Epoch: 13, loss: 6.370292880535126, eval loss: [NA]
Epoch: 14, loss: 6.369528384208679, eval loss: [NA]
Epoch: 15, loss: 6.378215203285217, eval loss: [NA]
Epoch: 16, loss: 6.369866709709168, eval loss: [NA]
Epoch: 17, loss: 6.362407145500183, eval loss: [NA]
Epoch: 18, loss: 6.373239762783051, eval loss: [NA]
Epoch: 19, loss: 6.373025600910187, eval loss: [NA]
Epoch: 20, loss: 6.37286963224411, eval loss: [NA]
Epoch: 21, loss: 6.379104874134064, eval loss: [NA]
Epoch: 22, loss: 6.356798362731934, eval loss: [NA]
Epoch: 23, loss: 6.382924520969391, eval loss: [NA]
Epoch: 24, loss: 6.362352735996247, eval loss: [NA]

Runtime:380.95
[3506495201.3522, 1.1267, 1.1024, 1.0091]
[2.5073, 0.8915, 0.8827, 0.9014]
[2.1708, 1.1027, 1.1049, 1.1024]
tensor(1.1214, grad_fn=<MeanBackward0>)
tensor(0.8675, grad_fn=<MeanBackward0>)
tensor([-1.9583, -2.9843, -1.8205, -2.8617, -0.3748, -1.2777, -1.9099, -2.8895,
        -1.7872, -2.8458], grad_fn=<MeanBackward1>)
tensor([1.1220, 1.2243, 1.1424, 1.2545, 0.3254, 0.3407, 1.0843, 1.1910, 1.1541,
        1.2212], grad_fn=<StdBackward1>)
tensor([-2.0528, -3.3627, -1.7006, -3.0799, -0.2618, -1.2785, -2.3681, -3.6668,
        -2.7483, -3.0060])
KL div untrained: 27440389.962
KL div trained: 0.932
