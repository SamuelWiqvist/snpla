Input args:
Dim: 2
seed: 36
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1956, grad_fn=<MeanBackward0>)
tensor(1.5936, grad_fn=<MeanBackward0>)
tensor([ 0.0597, -0.1875,  0.1452, -0.0792,  0.2012, -0.1066,  0.1793,  0.0362,
        -0.1538, -0.0322], grad_fn=<MeanBackward1>)
tensor([1.0133, 0.9787, 1.0148, 1.0630, 0.9241, 1.0735, 1.0295, 1.0679, 0.8655,
        0.9923], grad_fn=<StdBackward1>)
tensor([ 1.6057,  0.4357,  1.8099,  0.7685, -1.2603, -2.3599,  2.8133,  1.9470,
         1.0886, -0.6347])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.041100527954102, eval loss: [NA]
Epoch: 1, loss: 7.088815045166015, eval loss: [NA]
Epoch: 2, loss: 6.9933568939208985, eval loss: [NA]
Epoch: 3, loss: 6.922470877075195, eval loss: [NA]
Epoch: 4, loss: 6.900976086425781, eval loss: [NA]
Epoch: 5, loss: 6.914983731079102, eval loss: [NA]
Epoch: 6, loss: 6.839686102294922, eval loss: [NA]
Epoch: 7, loss: 6.737165710449219, eval loss: [NA]
Epoch: 8, loss: 6.275189958190918, eval loss: [NA]
Epoch: 9, loss: 5.386532156372071, eval loss: [NA]
Epoch: 10, loss: 4.982934317016602, eval loss: [NA]
Epoch: 11, loss: 4.785644526672363, eval loss: [NA]
Epoch: 12, loss: 4.794496989440918, eval loss: [NA]
Epoch: 13, loss: 4.747093508911133, eval loss: [NA]
Epoch: 14, loss: 4.688833854675293, eval loss: [NA]
Epoch: 15, loss: 4.648569731140137, eval loss: [NA]
Epoch: 16, loss: 4.631553895568848, eval loss: [NA]
Epoch: 17, loss: 4.612907411193848, eval loss: [NA]
Epoch: 18, loss: 4.516316194152832, eval loss: [NA]
Epoch: 19, loss: 4.220674397277832, eval loss: [NA]
Epoch: 20, loss: 3.935973880004883, eval loss: [NA]
Epoch: 21, loss: 3.8335783004760744, eval loss: [NA]
Epoch: 22, loss: 3.7749538757324217, eval loss: [NA]
Epoch: 23, loss: 3.750530744934082, eval loss: [NA]
Epoch: 24, loss: 3.698836878967285, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.0610555627942087, eval loss: [NA]
Epoch: 1, loss: 0.8459056816995144, eval loss: [NA]
Epoch: 2, loss: 0.63523164793849, eval loss: [NA]
Epoch: 3, loss: 0.660272226408124, eval loss: [NA]
Epoch: 4, loss: 0.5505332933366298, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.847019128799438, eval loss: [NA]
Epoch: 1, loss: 6.834438641071319, eval loss: [NA]
Epoch: 2, loss: 6.846891491413117, eval loss: [NA]
Epoch: 3, loss: 6.831833839416504, eval loss: [NA]
Epoch: 4, loss: 6.838859272003174, eval loss: [NA]
Epoch: 5, loss: 6.83976322889328, eval loss: [NA]
Epoch: 6, loss: 6.880273380279541, eval loss: [NA]
Epoch: 7, loss: 6.804122655391693, eval loss: [NA]
Epoch: 8, loss: 6.870282962322235, eval loss: [NA]
Epoch: 9, loss: 6.8359470105171205, eval loss: [NA]
Epoch: 10, loss: 6.793652212619781, eval loss: [NA]
Epoch: 11, loss: 6.826757283210754, eval loss: [NA]
Epoch: 12, loss: 6.8439641642570495, eval loss: [NA]
Epoch: 13, loss: 6.821021149158478, eval loss: [NA]
Epoch: 14, loss: 6.838299551010132, eval loss: [NA]
Epoch: 15, loss: 6.8151472425460815, eval loss: [NA]
Epoch: 16, loss: 6.796147239208222, eval loss: [NA]
Epoch: 17, loss: 6.851214377880097, eval loss: [NA]
Epoch: 18, loss: 6.82996677160263, eval loss: [NA]
Epoch: 19, loss: 6.850357677936554, eval loss: [NA]
Epoch: 20, loss: 6.829383916854859, eval loss: [NA]
Epoch: 21, loss: 6.810994729995728, eval loss: [NA]
Epoch: 22, loss: 6.836577706336975, eval loss: [NA]
Epoch: 23, loss: 6.847723982334137, eval loss: [NA]
Epoch: 24, loss: 6.832763659954071, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.6877114822387695, eval loss: [NA]
Epoch: 1, loss: 3.6526559906005858, eval loss: [NA]
Epoch: 2, loss: 3.6112520584106447, eval loss: [NA]
Epoch: 3, loss: 3.604274464416504, eval loss: [NA]
Epoch: 4, loss: 3.635123504638672, eval loss: [NA]
Epoch: 5, loss: 3.602528727722168, eval loss: [NA]
Epoch: 6, loss: 3.621788604736328, eval loss: [NA]
Epoch: 7, loss: 3.6073883880615236, eval loss: [NA]
Epoch: 8, loss: 3.5722910552978515, eval loss: [NA]
Epoch: 9, loss: 3.5825618911743162, eval loss: [NA]
Epoch: 10, loss: 3.5986915084838866, eval loss: [NA]
Epoch: 11, loss: 3.604355352783203, eval loss: [NA]
Epoch: 12, loss: 3.597730647277832, eval loss: [NA]
Epoch: 13, loss: 3.6363005615234374, eval loss: [NA]
Epoch: 14, loss: 3.600134144592285, eval loss: [NA]
Epoch: 15, loss: 3.6118812271118164, eval loss: [NA]
Epoch: 16, loss: 3.5797706283569335, eval loss: [NA]
Epoch: 17, loss: 3.5642959243774412, eval loss: [NA]
Epoch: 18, loss: 3.5585298248291015, eval loss: [NA]
Epoch: 19, loss: 3.579541389465332, eval loss: [NA]
Epoch: 20, loss: 3.609716954040527, eval loss: [NA]
Epoch: 21, loss: 3.583461166381836, eval loss: [NA]
Epoch: 22, loss: 3.545948179626465, eval loss: [NA]
Epoch: 23, loss: 3.5818169357299805, eval loss: [NA]
Epoch: 24, loss: 3.5488995498657228, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.344558579921722, eval loss: [NA]
Epoch: 1, loss: 6.355811557769775, eval loss: [NA]
Epoch: 2, loss: 6.34925215959549, eval loss: [NA]
Epoch: 3, loss: 6.345584824085235, eval loss: [NA]
Epoch: 4, loss: 6.336973514556885, eval loss: [NA]
Epoch: 5, loss: 6.366235945224762, eval loss: [NA]
Epoch: 6, loss: 6.3756714224815365, eval loss: [NA]
Epoch: 7, loss: 6.342005386352539, eval loss: [NA]
Epoch: 8, loss: 6.359398715496063, eval loss: [NA]
Epoch: 9, loss: 6.354472436904907, eval loss: [NA]
Epoch: 10, loss: 6.344363129138946, eval loss: [NA]
Epoch: 11, loss: 6.35445571899414, eval loss: [NA]
Epoch: 12, loss: 6.330048477649688, eval loss: [NA]
Epoch: 13, loss: 6.360881991386414, eval loss: [NA]
Epoch: 14, loss: 6.3456297516822815, eval loss: [NA]
Epoch: 15, loss: 6.341954152584076, eval loss: [NA]
Epoch: 16, loss: 6.350275053977966, eval loss: [NA]
Epoch: 17, loss: 6.3538636302948, eval loss: [NA]
Epoch: 18, loss: 6.346846139430999, eval loss: [NA]
Epoch: 19, loss: 6.3363658618927, eval loss: [NA]
Epoch: 20, loss: 6.342697746753693, eval loss: [NA]
Epoch: 21, loss: 6.369776220321655, eval loss: [NA]
Epoch: 22, loss: 6.336464555263519, eval loss: [NA]
Epoch: 23, loss: 6.337135918140412, eval loss: [NA]
Epoch: 24, loss: 6.346022574901581, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.479967576599121, eval loss: [NA]
Epoch: 1, loss: 3.5284090423583985, eval loss: [NA]
Epoch: 2, loss: 3.494475634765625, eval loss: [NA]
Epoch: 3, loss: 3.5464065216064453, eval loss: [NA]
Epoch: 4, loss: 3.4896328704833985, eval loss: [NA]
Epoch: 5, loss: 3.480541604614258, eval loss: [NA]
Epoch: 6, loss: 3.4955779754638674, eval loss: [NA]
Epoch: 7, loss: 3.502191174316406, eval loss: [NA]
Epoch: 8, loss: 3.5083012619018556, eval loss: [NA]
Epoch: 9, loss: 3.48691417388916, eval loss: [NA]
Epoch: 10, loss: 3.50720506439209, eval loss: [NA]
Epoch: 11, loss: 3.496317190551758, eval loss: [NA]
Epoch: 12, loss: 3.486545489501953, eval loss: [NA]
Epoch: 13, loss: 3.4809413650512697, eval loss: [NA]
Epoch: 14, loss: 3.5085309463500978, eval loss: [NA]
Epoch: 15, loss: 3.502672650146484, eval loss: [NA]
Epoch: 16, loss: 3.4919134368896483, eval loss: [NA]
Epoch: 17, loss: 3.481040251159668, eval loss: [NA]
Epoch: 18, loss: 3.524747979736328, eval loss: [NA]
Epoch: 19, loss: 3.46544296875, eval loss: [NA]
Epoch: 20, loss: 3.4737467422485353, eval loss: [NA]
Epoch: 21, loss: 3.457751853942871, eval loss: [NA]
Epoch: 22, loss: 3.4765729461669923, eval loss: [NA]
Epoch: 23, loss: 3.4552994705200195, eval loss: [NA]
Epoch: 24, loss: 3.4753520263671875, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.332273652553559, eval loss: [NA]
Epoch: 1, loss: 6.329884827136993, eval loss: [NA]
Epoch: 2, loss: 6.323593833446503, eval loss: [NA]
Epoch: 3, loss: 6.33461633682251, eval loss: [NA]
Epoch: 4, loss: 6.343646631240845, eval loss: [NA]
Epoch: 5, loss: 6.306060492992401, eval loss: [NA]
Epoch: 6, loss: 6.317102506160736, eval loss: [NA]
Epoch: 7, loss: 6.31866902589798, eval loss: [NA]
Epoch: 8, loss: 6.334729382991791, eval loss: [NA]
Epoch: 9, loss: 6.331730778217316, eval loss: [NA]
Epoch: 10, loss: 6.314437744617462, eval loss: [NA]
Epoch: 11, loss: 6.341357927322388, eval loss: [NA]
Epoch: 12, loss: 6.322066483497619, eval loss: [NA]
Epoch: 13, loss: 6.327174806594849, eval loss: [NA]
Epoch: 14, loss: 6.317157576084137, eval loss: [NA]
Epoch: 15, loss: 6.326036608219146, eval loss: [NA]
Epoch: 16, loss: 6.337183654308319, eval loss: [NA]
Epoch: 17, loss: 6.335509467124939, eval loss: [NA]
Epoch: 18, loss: 6.335573809146881, eval loss: [NA]
Epoch: 19, loss: 6.3241547584533695, eval loss: [NA]
Epoch: 20, loss: 6.331544518470764, eval loss: [NA]
Epoch: 21, loss: 6.326804492473602, eval loss: [NA]
Epoch: 22, loss: 6.324385507106781, eval loss: [NA]
Epoch: 23, loss: 6.329360897541046, eval loss: [NA]
Epoch: 24, loss: 6.348492584228516, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4888316360473635, eval loss: [NA]
Epoch: 1, loss: 3.5011337158203126, eval loss: [NA]
Epoch: 2, loss: 3.4822069213867186, eval loss: [NA]
Epoch: 3, loss: 3.4752890716552733, eval loss: [NA]
Epoch: 4, loss: 3.492618002319336, eval loss: [NA]
Epoch: 5, loss: 3.4793389266967774, eval loss: [NA]
Epoch: 6, loss: 3.4700183181762694, eval loss: [NA]
Epoch: 7, loss: 3.4615279067993163, eval loss: [NA]
Epoch: 8, loss: 3.4871626846313477, eval loss: [NA]
Epoch: 9, loss: 3.4819244003295897, eval loss: [NA]
Epoch: 10, loss: 3.4635439056396486, eval loss: [NA]
Epoch: 11, loss: 3.443011006164551, eval loss: [NA]
Epoch: 12, loss: 3.4780080215454103, eval loss: [NA]
Epoch: 13, loss: 3.470016157531738, eval loss: [NA]
Epoch: 14, loss: 3.44858113861084, eval loss: [NA]
Epoch: 15, loss: 3.487159306335449, eval loss: [NA]
Epoch: 16, loss: 3.4728975204467774, eval loss: [NA]
Epoch: 17, loss: 3.468059696960449, eval loss: [NA]
Epoch: 18, loss: 3.4501852279663088, eval loss: [NA]
Epoch: 19, loss: 3.465150239562988, eval loss: [NA]
Epoch: 20, loss: 3.479781105041504, eval loss: [NA]
Epoch: 21, loss: 3.4496632949829102, eval loss: [NA]
Epoch: 22, loss: 3.4626980377197265, eval loss: [NA]
Epoch: 23, loss: 3.476563084411621, eval loss: [NA]
Epoch: 24, loss: 3.4760086639404295, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.392943873405456, eval loss: [NA]
Epoch: 1, loss: 6.406750607490539, eval loss: [NA]
Epoch: 2, loss: 6.384146375656128, eval loss: [NA]
Epoch: 3, loss: 6.389870691299438, eval loss: [NA]
Epoch: 4, loss: 6.388952450752258, eval loss: [NA]
Epoch: 5, loss: 6.383617405891418, eval loss: [NA]
Epoch: 6, loss: 6.399639706611634, eval loss: [NA]
Epoch: 7, loss: 6.3944849371910095, eval loss: [NA]
Epoch: 8, loss: 6.375793879032135, eval loss: [NA]
Epoch: 9, loss: 6.382868390083313, eval loss: [NA]
Epoch: 10, loss: 6.38070937871933, eval loss: [NA]
Epoch: 11, loss: 6.405556273460388, eval loss: [NA]
Epoch: 12, loss: 6.373887324333191, eval loss: [NA]
Epoch: 13, loss: 6.386926636695862, eval loss: [NA]
Epoch: 14, loss: 6.383892343044281, eval loss: [NA]
Epoch: 15, loss: 6.393172833919525, eval loss: [NA]
Epoch: 16, loss: 6.384043245315552, eval loss: [NA]
Epoch: 17, loss: 6.37162216424942, eval loss: [NA]
Epoch: 18, loss: 6.38250299692154, eval loss: [NA]
Epoch: 19, loss: 6.395405728816986, eval loss: [NA]
Epoch: 20, loss: 6.395753405094147, eval loss: [NA]
Epoch: 21, loss: 6.399079337120056, eval loss: [NA]
Epoch: 22, loss: 6.400233089923859, eval loss: [NA]
Epoch: 23, loss: 6.385522651672363, eval loss: [NA]
Epoch: 24, loss: 6.399681363105774, eval loss: [NA]

Runtime:425.08
[1839061544832.4375, 0.2374, 0.1957, 0.196]
[1.5936, 0.6157, 0.5902, 0.5888]
[2.1956, 0.7641, 0.7249, 0.7541]
tensor(0.7356, grad_fn=<MeanBackward0>)
tensor(0.5934, grad_fn=<MeanBackward0>)
tensor([ 1.2458,  0.0525,  1.9202,  0.7982, -1.0089, -2.3561,  2.9540,  1.7959,
         1.0762, -0.1003], grad_fn=<MeanBackward1>)
tensor([1.1853, 1.3047, 0.3304, 0.3535, 0.3450, 0.3592, 0.3318, 0.3785, 1.1870,
        1.2783], grad_fn=<StdBackward1>)
tensor([ 1.6057,  0.4357,  1.8099,  0.7685, -1.2603, -2.3599,  2.8133,  1.9470,
         1.0886, -0.6347])
KL div untrained: 1742910381336.9614
KL div trained: 0.1842
