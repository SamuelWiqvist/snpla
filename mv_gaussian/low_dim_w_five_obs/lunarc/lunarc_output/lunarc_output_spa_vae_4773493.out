Input args:
Dim: 2
seed: 19
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1884, grad_fn=<MeanBackward0>)
tensor(1.2335, grad_fn=<MeanBackward0>)
tensor([-0.0397, -0.0513,  0.0599, -0.1092,  0.1769,  0.0436, -0.2276, -0.0992,
         0.1087, -0.0666], grad_fn=<MeanBackward1>)
tensor([1.0399, 0.8642, 0.8872, 1.0326, 1.1400, 0.9582, 1.0589, 1.0147, 0.9971,
        1.0605], grad_fn=<StdBackward1>)
tensor([-0.0072, -0.7409, -0.3332, -1.7425,  1.0863, -0.5056,  0.6439,  0.8013,
        -1.2521, -2.4919])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.419601016235351, eval loss: [NA]
Epoch: 1, loss: 7.104735534667968, eval loss: [NA]
Epoch: 2, loss: 7.013710339355469, eval loss: [NA]
Epoch: 3, loss: 6.987805227661132, eval loss: [NA]
Epoch: 4, loss: 6.945561337280274, eval loss: [NA]
Epoch: 5, loss: 6.825379293823242, eval loss: [NA]
Epoch: 6, loss: 6.6691828674316405, eval loss: [NA]
Epoch: 7, loss: 6.288170559692383, eval loss: [NA]
Epoch: 8, loss: 5.967922611999512, eval loss: [NA]
Epoch: 9, loss: 5.381351051330566, eval loss: [NA]
Epoch: 10, loss: 5.092722074890137, eval loss: [NA]
Epoch: 11, loss: 5.040489640808105, eval loss: [NA]
Epoch: 12, loss: 4.971879472351074, eval loss: [NA]
Epoch: 13, loss: 4.901031896972656, eval loss: [NA]
Epoch: 14, loss: 4.829477867126465, eval loss: [NA]
Epoch: 15, loss: 4.781054158020019, eval loss: [NA]
Epoch: 16, loss: 4.747748654174805, eval loss: [NA]
Epoch: 17, loss: 4.752512638854981, eval loss: [NA]
Epoch: 18, loss: 4.695999606323242, eval loss: [NA]
Epoch: 19, loss: 4.731998239135742, eval loss: [NA]
Epoch: 20, loss: 4.662054570007324, eval loss: [NA]
Epoch: 21, loss: 4.690191827392578, eval loss: [NA]
Epoch: 22, loss: 4.630042636108398, eval loss: [NA]
Epoch: 23, loss: 4.63900521850586, eval loss: [NA]
Epoch: 24, loss: 4.608742835998535, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.430538749098778, eval loss: [NA]
Epoch: 1, loss: 0.9796550953388214, eval loss: [NA]
Epoch: 2, loss: 0.6806433956325054, eval loss: [NA]
Epoch: 3, loss: 0.6134098751842976, eval loss: [NA]
Epoch: 4, loss: 0.5859005530923604, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.065019755363464, eval loss: [NA]
Epoch: 1, loss: 8.032954277992248, eval loss: [NA]
Epoch: 2, loss: 8.025218479633331, eval loss: [NA]
Epoch: 3, loss: 7.988486669063568, eval loss: [NA]
Epoch: 4, loss: 8.00899287223816, eval loss: [NA]
Epoch: 5, loss: 8.023760874271392, eval loss: [NA]
Epoch: 6, loss: 8.021506555080414, eval loss: [NA]
Epoch: 7, loss: 8.023361186981202, eval loss: [NA]
Epoch: 8, loss: 7.990000686645508, eval loss: [NA]
Epoch: 9, loss: 8.002852437496186, eval loss: [NA]
Epoch: 10, loss: 8.002520868778229, eval loss: [NA]
Epoch: 11, loss: 7.991310706138611, eval loss: [NA]
Epoch: 12, loss: 7.997714955806732, eval loss: [NA]
Epoch: 13, loss: 8.032811093330384, eval loss: [NA]
Epoch: 14, loss: 7.998453345298767, eval loss: [NA]
Epoch: 15, loss: 8.03695900440216, eval loss: [NA]
Epoch: 16, loss: 8.042579667568207, eval loss: [NA]
Epoch: 17, loss: 8.042464125156403, eval loss: [NA]
Epoch: 18, loss: 8.01948932170868, eval loss: [NA]
Epoch: 19, loss: 8.025520305633545, eval loss: [NA]
Epoch: 20, loss: 8.036797819137574, eval loss: [NA]
Epoch: 21, loss: 8.006977772712707, eval loss: [NA]
Epoch: 22, loss: 8.033487787246704, eval loss: [NA]
Epoch: 23, loss: 8.033428287506103, eval loss: [NA]
Epoch: 24, loss: 8.023131825923919, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.539419999694824, eval loss: [NA]
Epoch: 1, loss: 4.543226295471191, eval loss: [NA]
Epoch: 2, loss: 4.4946048553466795, eval loss: [NA]
Epoch: 3, loss: 4.498563931274414, eval loss: [NA]
Epoch: 4, loss: 4.484370468139648, eval loss: [NA]
Epoch: 5, loss: 4.518315924072265, eval loss: [NA]
Epoch: 6, loss: 4.4894375793457035, eval loss: [NA]
Epoch: 7, loss: 4.482955143737793, eval loss: [NA]
Epoch: 8, loss: 4.530096730041504, eval loss: [NA]
Epoch: 9, loss: 4.504567733764649, eval loss: [NA]
Epoch: 10, loss: 4.506054960632325, eval loss: [NA]
Epoch: 11, loss: 4.500997463989258, eval loss: [NA]
Epoch: 12, loss: 4.490382614135743, eval loss: [NA]
Epoch: 13, loss: 4.500630339050293, eval loss: [NA]
Epoch: 14, loss: 4.495490299987793, eval loss: [NA]
Epoch: 15, loss: 4.479890588378907, eval loss: [NA]
Epoch: 16, loss: 4.4919855010986325, eval loss: [NA]
Epoch: 17, loss: 4.487638406372071, eval loss: [NA]
Epoch: 18, loss: 4.496230406188965, eval loss: [NA]
Epoch: 19, loss: 4.514186042785645, eval loss: [NA]
Epoch: 20, loss: 4.485400343322754, eval loss: [NA]
Epoch: 21, loss: 4.521422947692871, eval loss: [NA]
Epoch: 22, loss: 4.4812048751831055, eval loss: [NA]
Epoch: 23, loss: 4.468880264282227, eval loss: [NA]
Epoch: 24, loss: 4.459993415832519, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.955423657894134, eval loss: [NA]
Epoch: 1, loss: 7.939714429378509, eval loss: [NA]
Epoch: 2, loss: 7.9184892773628235, eval loss: [NA]
Epoch: 3, loss: 7.931325786113739, eval loss: [NA]
Epoch: 4, loss: 7.929316277503967, eval loss: [NA]
Epoch: 5, loss: 7.915635921955109, eval loss: [NA]
Epoch: 6, loss: 7.913730142116546, eval loss: [NA]
Epoch: 7, loss: 7.961792211532593, eval loss: [NA]
Epoch: 8, loss: 7.951778311729431, eval loss: [NA]
Epoch: 9, loss: 7.956814346313476, eval loss: [NA]
Epoch: 10, loss: 7.917873423099518, eval loss: [NA]
Epoch: 11, loss: 7.956004168987274, eval loss: [NA]
Epoch: 12, loss: 7.938658287525177, eval loss: [NA]
Epoch: 13, loss: 7.950083906650543, eval loss: [NA]
Epoch: 14, loss: 7.920909337997436, eval loss: [NA]
Epoch: 15, loss: 7.939463458061218, eval loss: [NA]
Epoch: 16, loss: 7.931450839042664, eval loss: [NA]
Epoch: 17, loss: 7.9249047183990475, eval loss: [NA]
Epoch: 18, loss: 7.9019837260246275, eval loss: [NA]
Epoch: 19, loss: 7.939423258304596, eval loss: [NA]
Epoch: 20, loss: 7.956801240444183, eval loss: [NA]
Epoch: 21, loss: 7.913947625160217, eval loss: [NA]
Epoch: 22, loss: 7.947317707538605, eval loss: [NA]
Epoch: 23, loss: 7.920306043624878, eval loss: [NA]
Epoch: 24, loss: 7.905214133262635, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 4.475857379150391, eval loss: [NA]
Epoch: 1, loss: 4.437293907165527, eval loss: [NA]
Epoch: 2, loss: 4.444201101684571, eval loss: [NA]
Epoch: 3, loss: 4.471858779907227, eval loss: [NA]
Epoch: 4, loss: 4.4476379287719725, eval loss: [NA]
Epoch: 5, loss: 4.4474450149536136, eval loss: [NA]
Epoch: 6, loss: 4.443638334655762, eval loss: [NA]
Epoch: 7, loss: 4.255280746459961, eval loss: [NA]
Epoch: 8, loss: 3.897577033996582, eval loss: [NA]
Epoch: 9, loss: 3.790108908081055, eval loss: [NA]
Epoch: 10, loss: 3.6650089096069336, eval loss: [NA]
Epoch: 11, loss: 3.5694638565063475, eval loss: [NA]
Epoch: 12, loss: 3.5548628158569335, eval loss: [NA]
Epoch: 13, loss: 3.5161568939208983, eval loss: [NA]
Epoch: 14, loss: 3.5570151290893555, eval loss: [NA]
Epoch: 15, loss: 3.5173022674560546, eval loss: [NA]
Epoch: 16, loss: 3.516425505065918, eval loss: [NA]
Epoch: 17, loss: 3.528632470703125, eval loss: [NA]
Epoch: 18, loss: 3.5164680145263674, eval loss: [NA]
Epoch: 19, loss: 3.508255213928223, eval loss: [NA]
Epoch: 20, loss: 3.4840149307250976, eval loss: [NA]
Epoch: 21, loss: 3.4786168792724608, eval loss: [NA]
Epoch: 22, loss: 3.519007263183594, eval loss: [NA]
Epoch: 23, loss: 3.518142427062988, eval loss: [NA]
Epoch: 24, loss: 3.497438171386719, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.056060824394226, eval loss: [NA]
Epoch: 1, loss: 8.038224532604218, eval loss: [NA]
Epoch: 2, loss: 8.09241051197052, eval loss: [NA]
Epoch: 3, loss: 8.058136699199677, eval loss: [NA]
Epoch: 4, loss: 8.022017011642456, eval loss: [NA]
Epoch: 5, loss: 8.070001814365387, eval loss: [NA]
Epoch: 6, loss: 8.056063256263734, eval loss: [NA]
Epoch: 7, loss: 8.028176679611207, eval loss: [NA]
Epoch: 8, loss: 8.041781182289123, eval loss: [NA]
Epoch: 9, loss: 8.045141220092773, eval loss: [NA]
Epoch: 10, loss: 8.052409892082215, eval loss: [NA]
Epoch: 11, loss: 8.00595146894455, eval loss: [NA]
Epoch: 12, loss: 8.017489647865295, eval loss: [NA]
Epoch: 13, loss: 8.047764284610748, eval loss: [NA]
Epoch: 14, loss: 8.033496770858765, eval loss: [NA]
Epoch: 15, loss: 8.01495628118515, eval loss: [NA]
Epoch: 16, loss: 8.054709377288818, eval loss: [NA]
Epoch: 17, loss: 8.04667711019516, eval loss: [NA]
Epoch: 18, loss: 8.050676016807556, eval loss: [NA]
Epoch: 19, loss: 8.028288309574128, eval loss: [NA]
Epoch: 20, loss: 8.034921061992645, eval loss: [NA]
Epoch: 21, loss: 8.006213626861573, eval loss: [NA]
Epoch: 22, loss: 8.03407348871231, eval loss: [NA]
Epoch: 23, loss: 8.038567719459534, eval loss: [NA]
Epoch: 24, loss: 8.033480486869813, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.508818115234375, eval loss: [NA]
Epoch: 1, loss: 3.4667246002197265, eval loss: [NA]
Epoch: 2, loss: 3.468206022644043, eval loss: [NA]
Epoch: 3, loss: 3.4673928482055665, eval loss: [NA]
Epoch: 4, loss: 3.5053699462890626, eval loss: [NA]
Epoch: 5, loss: 3.5026344482421874, eval loss: [NA]
Epoch: 6, loss: 3.4727919784545898, eval loss: [NA]
Epoch: 7, loss: 3.472710501098633, eval loss: [NA]
Epoch: 8, loss: 3.4764278549194336, eval loss: [NA]
Epoch: 9, loss: 3.466257405090332, eval loss: [NA]
Epoch: 10, loss: 3.472829139709473, eval loss: [NA]
Epoch: 11, loss: 3.449626509094238, eval loss: [NA]
Epoch: 12, loss: 3.464643603515625, eval loss: [NA]
Epoch: 13, loss: 3.488022215270996, eval loss: [NA]
Epoch: 14, loss: 3.4555052352905276, eval loss: [NA]
Epoch: 15, loss: 3.4759296005249025, eval loss: [NA]
Epoch: 16, loss: 3.499058435058594, eval loss: [NA]
Epoch: 17, loss: 3.458727670288086, eval loss: [NA]
Epoch: 18, loss: 3.4371441940307617, eval loss: [NA]
Epoch: 19, loss: 3.4639745056152345, eval loss: [NA]
Epoch: 20, loss: 3.461367956542969, eval loss: [NA]
Epoch: 21, loss: 3.4561319763183596, eval loss: [NA]
Epoch: 22, loss: 3.48484794921875, eval loss: [NA]
Epoch: 23, loss: 3.464585662841797, eval loss: [NA]
Epoch: 24, loss: 3.435924752807617, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.4945295977592465, eval loss: [NA]
Epoch: 1, loss: 7.505840077400207, eval loss: [NA]
Epoch: 2, loss: 7.49974949836731, eval loss: [NA]
Epoch: 3, loss: 7.499412424564362, eval loss: [NA]
Epoch: 4, loss: 7.499035036563873, eval loss: [NA]
Epoch: 5, loss: 7.506642582416535, eval loss: [NA]
Epoch: 6, loss: 7.4721917319297795, eval loss: [NA]
Epoch: 7, loss: 7.487022559642792, eval loss: [NA]
Epoch: 8, loss: 7.485881741046906, eval loss: [NA]
Epoch: 9, loss: 7.488603494167328, eval loss: [NA]
Epoch: 10, loss: 7.486620833873749, eval loss: [NA]
Epoch: 11, loss: 7.498167436122895, eval loss: [NA]
Epoch: 12, loss: 7.490626692771912, eval loss: [NA]
Epoch: 13, loss: 7.500648002624512, eval loss: [NA]
Epoch: 14, loss: 7.479847264289856, eval loss: [NA]
Epoch: 15, loss: 7.495199868679046, eval loss: [NA]
Epoch: 16, loss: 7.4842970132827755, eval loss: [NA]
Epoch: 17, loss: 7.49465919971466, eval loss: [NA]
Epoch: 18, loss: 7.470890667438507, eval loss: [NA]
Epoch: 19, loss: 7.479079358577728, eval loss: [NA]
Epoch: 20, loss: 7.486902272701263, eval loss: [NA]
Epoch: 21, loss: 7.490312159061432, eval loss: [NA]
Epoch: 22, loss: 7.48756541967392, eval loss: [NA]
Epoch: 23, loss: 7.48637927532196, eval loss: [NA]
Epoch: 24, loss: 7.502636828422546, eval loss: [NA]

Runtime:411.7
[1.6946208988618376e+16, 0.4438, 0.3973, 0.1434]
[1.2335, 0.7996, 0.7975, 0.6866]
[2.1884, 0.865, 0.8899, 0.7651]
tensor(0.7608, grad_fn=<MeanBackward0>)
tensor(0.6800, grad_fn=<MeanBackward0>)
tensor([-0.1347, -0.6953, -0.1320, -0.7851, -0.0822, -0.6752,  0.9486,  0.4042,
        -1.5005, -2.2077], grad_fn=<MeanBackward1>)
tensor([0.3278, 0.3400, 1.2011, 1.3406, 1.2668, 1.3252, 0.3155, 0.3222, 0.3079,
        0.3333], grad_fn=<StdBackward1>)
tensor([-0.0072, -0.7409, -0.3332, -1.7425,  1.0863, -0.5056,  0.6439,  0.8013,
        -1.2521, -2.4919])
KL div untrained: 2.141443356901578e+16
KL div trained: 0.1407
