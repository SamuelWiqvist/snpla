/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1821, grad_fn=<MeanBackward0>)
tensor(3.0382, grad_fn=<MeanBackward0>)
tensor([ 0.2079,  0.0783,  0.0932, -0.0863,  0.2650, -0.1161,  0.0703,  0.0849,
         0.2169,  0.1928], grad_fn=<MeanBackward1>)
tensor([0.9344, 0.9846, 1.1045, 1.1180, 0.9250, 1.1412, 1.0032, 0.9845, 0.9546,
        1.1073], grad_fn=<StdBackward1>)
tensor([ 0.1527,  5.0296, -0.1720,  4.1212,  1.6518,  6.0040,  0.5523,  4.8475,
         0.9799,  5.5771])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.359817364501954, eval loss: [NA]
Epoch: 1, loss: 7.034242736816406, eval loss: [NA]
Epoch: 2, loss: 6.946281488037109, eval loss: [NA]
Epoch: 3, loss: 6.894840161132812, eval loss: [NA]
Epoch: 4, loss: 6.870933721923828, eval loss: [NA]
Epoch: 5, loss: 6.735977090454101, eval loss: [NA]
Epoch: 6, loss: 6.298501446533203, eval loss: [NA]
Epoch: 7, loss: 5.453647871398926, eval loss: [NA]
Epoch: 8, loss: 5.077699104309082, eval loss: [NA]
Epoch: 9, loss: 4.891500427246093, eval loss: [NA]
Epoch: 10, loss: 4.822751161193848, eval loss: [NA]
Epoch: 11, loss: 4.761954296875, eval loss: [NA]
Epoch: 12, loss: 4.720689077758789, eval loss: [NA]
Epoch: 13, loss: 4.702152026367187, eval loss: [NA]
Epoch: 14, loss: 4.678745295715332, eval loss: [NA]
Epoch: 15, loss: 4.6637244873046875, eval loss: [NA]
Epoch: 16, loss: 4.6528580825805665, eval loss: [NA]
Epoch: 17, loss: 4.627437300109864, eval loss: [NA]
Epoch: 18, loss: 4.6110755020141605, eval loss: [NA]
Epoch: 19, loss: 4.6326653762817385, eval loss: [NA]
Epoch: 20, loss: 4.5542488845825195, eval loss: [NA]
Epoch: 21, loss: 4.567252229309082, eval loss: [NA]
Epoch: 22, loss: 4.295126547241211, eval loss: [NA]
Epoch: 23, loss: 3.8988807205200193, eval loss: [NA]
Epoch: 24, loss: 3.7542479370117188, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 32.68376917362213, eval loss: [NA]
Epoch: 1, loss: 6.3643832015991215, eval loss: [NA]
Epoch: 2, loss: 6.3316347742080685, eval loss: [NA]
Epoch: 3, loss: 6.284936633110046, eval loss: [NA]
Epoch: 4, loss: 6.27348887681961, eval loss: [NA]
Epoch: 5, loss: 6.291080801486969, eval loss: [NA]
Epoch: 6, loss: 6.283469455242157, eval loss: [NA]
Epoch: 7, loss: 6.319334492683411, eval loss: [NA]
Epoch: 8, loss: 6.291282622814179, eval loss: [NA]
Epoch: 9, loss: 6.298850047588348, eval loss: [NA]
Epoch: 10, loss: 6.303692545890808, eval loss: [NA]
Epoch: 11, loss: 6.298883790969849, eval loss: [NA]
Epoch: 12, loss: 6.2840953016281125, eval loss: [NA]
Epoch: 13, loss: 6.2934576964378355, eval loss: [NA]
Epoch: 14, loss: 6.310745942592621, eval loss: [NA]
Epoch: 15, loss: 6.321580557823181, eval loss: [NA]
Epoch: 16, loss: 6.2931657099723814, eval loss: [NA]
Epoch: 17, loss: 6.282052171230316, eval loss: [NA]
Epoch: 18, loss: 6.30355782032013, eval loss: [NA]
Epoch: 19, loss: 6.303456463813782, eval loss: [NA]
Epoch: 20, loss: 6.324560849666596, eval loss: [NA]
Epoch: 21, loss: 6.318470892906189, eval loss: [NA]
Epoch: 22, loss: 6.297952342033386, eval loss: [NA]
Epoch: 23, loss: 6.307167911529541, eval loss: [NA]
Epoch: 24, loss: 6.299600341320038, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.968930958557129, eval loss: [NA]
Epoch: 1, loss: 3.7643896575927736, eval loss: [NA]
Epoch: 2, loss: 3.7394634201049803, eval loss: [NA]
Epoch: 3, loss: 3.696391995239258, eval loss: [NA]
Epoch: 4, loss: 3.721516436767578, eval loss: [NA]
Epoch: 5, loss: 3.6666470611572266, eval loss: [NA]
Epoch: 6, loss: 3.6709873611450194, eval loss: [NA]
Epoch: 7, loss: 3.6473153472900393, eval loss: [NA]
Epoch: 8, loss: 3.634186756896973, eval loss: [NA]
Epoch: 9, loss: 3.641758587646484, eval loss: [NA]
Epoch: 10, loss: 3.660187623596191, eval loss: [NA]
Epoch: 11, loss: 3.633567973327637, eval loss: [NA]
Epoch: 12, loss: 3.6406045608520508, eval loss: [NA]
Epoch: 13, loss: 3.612056948852539, eval loss: [NA]
Epoch: 14, loss: 3.6200457458496094, eval loss: [NA]
Epoch: 15, loss: 3.596357192993164, eval loss: [NA]
Epoch: 16, loss: 3.6328883102416993, eval loss: [NA]
Epoch: 17, loss: 3.620111363220215, eval loss: [NA]
Epoch: 18, loss: 3.593069041442871, eval loss: [NA]
Epoch: 19, loss: 3.605904299926758, eval loss: [NA]
Epoch: 20, loss: 3.6055224868774416, eval loss: [NA]
Epoch: 21, loss: 3.6348195693969725, eval loss: [NA]
Epoch: 22, loss: 3.5932649597167967, eval loss: [NA]
Epoch: 23, loss: 3.6093951354980467, eval loss: [NA]
Epoch: 24, loss: 3.6198880813598633, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.93190566778183, eval loss: [NA]
Epoch: 1, loss: 5.902656855583191, eval loss: [NA]
Epoch: 2, loss: 5.895914363861084, eval loss: [NA]
Epoch: 3, loss: 5.928505573272705, eval loss: [NA]
Epoch: 4, loss: 5.898671927452088, eval loss: [NA]
Epoch: 5, loss: 5.916981575489044, eval loss: [NA]
Epoch: 6, loss: 5.909099609851837, eval loss: [NA]
Epoch: 7, loss: 5.918430712223053, eval loss: [NA]
Epoch: 8, loss: 5.906152412891388, eval loss: [NA]
Epoch: 9, loss: 5.915756552219391, eval loss: [NA]
Epoch: 10, loss: 5.898016691207886, eval loss: [NA]
Epoch: 11, loss: 5.906567852497101, eval loss: [NA]
Epoch: 12, loss: 5.941534867286682, eval loss: [NA]
Epoch: 13, loss: 5.914259657859803, eval loss: [NA]
Epoch: 14, loss: 5.924315822124481, eval loss: [NA]
Epoch: 15, loss: 5.9060024070739745, eval loss: [NA]
Epoch: 16, loss: 5.914269969463349, eval loss: [NA]
Epoch: 17, loss: 5.910731959342956, eval loss: [NA]
Epoch: 18, loss: 5.929490849971772, eval loss: [NA]
Epoch: 19, loss: 5.912819671630859, eval loss: [NA]
Epoch: 20, loss: 5.901983630657196, eval loss: [NA]
Epoch: 21, loss: 5.908093130588531, eval loss: [NA]
Epoch: 22, loss: 5.9195015382766725, eval loss: [NA]
Epoch: 23, loss: 5.902586328983307, eval loss: [NA]
Epoch: 24, loss: 5.887696619033814, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.578431141662598, eval loss: [NA]
Epoch: 1, loss: 3.5800562561035156, eval loss: [NA]
Epoch: 2, loss: 3.6007579818725586, eval loss: [NA]
Epoch: 3, loss: 3.581520964050293, eval loss: [NA]
Epoch: 4, loss: 3.6364052139282226, eval loss: [NA]
Epoch: 5, loss: 3.5808908142089844, eval loss: [NA]
Epoch: 6, loss: 3.597261508178711, eval loss: [NA]
Epoch: 7, loss: 3.6086823837280275, eval loss: [NA]
Epoch: 8, loss: 3.594802183532715, eval loss: [NA]
Epoch: 9, loss: 3.5701980407714844, eval loss: [NA]
Epoch: 10, loss: 3.6057018157958987, eval loss: [NA]
Epoch: 11, loss: 3.5766257904052736, eval loss: [NA]
Epoch: 12, loss: 3.570288008117676, eval loss: [NA]
Epoch: 13, loss: 3.604277731323242, eval loss: [NA]
Epoch: 14, loss: 3.5579986770629883, eval loss: [NA]
Epoch: 15, loss: 3.553639579772949, eval loss: [NA]
Epoch: 16, loss: 3.571799900817871, eval loss: [NA]
Epoch: 17, loss: 3.5893470275878907, eval loss: [NA]
Epoch: 18, loss: 3.575803416442871, eval loss: [NA]
Epoch: 19, loss: 3.546733856201172, eval loss: [NA]
Epoch: 20, loss: 3.5355642333984374, eval loss: [NA]
Epoch: 21, loss: 3.545170086669922, eval loss: [NA]
Epoch: 22, loss: 3.554160395812988, eval loss: [NA]
Epoch: 23, loss: 3.523586798095703, eval loss: [NA]
Epoch: 24, loss: 3.5433417388916015, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.812640907764435, eval loss: [NA]
Epoch: 1, loss: 5.804636113643646, eval loss: [NA]
Epoch: 2, loss: 5.787131521701813, eval loss: [NA]
Epoch: 3, loss: 5.807848215103149, eval loss: [NA]
Epoch: 4, loss: 5.789998302459717, eval loss: [NA]
Epoch: 5, loss: 5.789122581481934, eval loss: [NA]
Epoch: 6, loss: 5.820676758289337, eval loss: [NA]
Epoch: 7, loss: 5.806009013652801, eval loss: [NA]
Epoch: 8, loss: 5.80054824590683, eval loss: [NA]
Epoch: 9, loss: 5.8058863496780395, eval loss: [NA]
Epoch: 10, loss: 5.802015380859375, eval loss: [NA]
Epoch: 11, loss: 5.7699119353294375, eval loss: [NA]
Epoch: 12, loss: 5.782146739959717, eval loss: [NA]
Epoch: 13, loss: 5.807619304656982, eval loss: [NA]
Epoch: 14, loss: 5.822654731273651, eval loss: [NA]
Epoch: 15, loss: 5.809986202716828, eval loss: [NA]
Epoch: 16, loss: 5.795829119682312, eval loss: [NA]
Epoch: 17, loss: 5.800315494537354, eval loss: [NA]
Epoch: 18, loss: 5.791688778400421, eval loss: [NA]
Epoch: 19, loss: 5.800085291862488, eval loss: [NA]
Epoch: 20, loss: 5.808973338603973, eval loss: [NA]
Epoch: 21, loss: 5.8060054683685305, eval loss: [NA]
Epoch: 22, loss: 5.795859696865082, eval loss: [NA]
Epoch: 23, loss: 5.807764773368835, eval loss: [NA]
Epoch: 24, loss: 5.833629415035248, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4864148834228517, eval loss: [NA]
Epoch: 1, loss: 3.5123335952758787, eval loss: [NA]
Epoch: 2, loss: 3.474287384033203, eval loss: [NA]
Epoch: 3, loss: 3.496296455383301, eval loss: [NA]
Epoch: 4, loss: 3.5236361587524416, eval loss: [NA]
Epoch: 5, loss: 3.5168055923461914, eval loss: [NA]
Epoch: 6, loss: 3.4750637954711916, eval loss: [NA]
Epoch: 7, loss: 3.5134239959716798, eval loss: [NA]
Epoch: 8, loss: 3.493683950805664, eval loss: [NA]
Epoch: 9, loss: 3.48683896484375, eval loss: [NA]
Epoch: 10, loss: 3.519795004272461, eval loss: [NA]
Epoch: 11, loss: 3.4887105499267577, eval loss: [NA]
Epoch: 12, loss: 3.472757601928711, eval loss: [NA]
Epoch: 13, loss: 3.5340191848754885, eval loss: [NA]
Epoch: 14, loss: 3.477724366760254, eval loss: [NA]
Epoch: 15, loss: 3.490983117675781, eval loss: [NA]
Epoch: 16, loss: 3.4766626403808596, eval loss: [NA]
Epoch: 17, loss: 3.467024560546875, eval loss: [NA]
Epoch: 18, loss: 3.4443167068481446, eval loss: [NA]
Epoch: 19, loss: 3.498561392211914, eval loss: [NA]
Epoch: 20, loss: 3.4937350509643554, eval loss: [NA]
Epoch: 21, loss: 3.5079042358398436, eval loss: [NA]
Epoch: 22, loss: 3.470777751159668, eval loss: [NA]
Epoch: 23, loss: 3.5227012786865233, eval loss: [NA]
Epoch: 24, loss: 3.4392664901733396, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.871985340118409, eval loss: [NA]
Epoch: 1, loss: 5.834464468955994, eval loss: [NA]
Epoch: 2, loss: 5.8474969077110295, eval loss: [NA]
Epoch: 3, loss: 5.843299996852875, eval loss: [NA]
Epoch: 4, loss: 5.83319189786911, eval loss: [NA]
Epoch: 5, loss: 5.815663142204285, eval loss: [NA]
Epoch: 6, loss: 5.86001246213913, eval loss: [NA]
Epoch: 7, loss: 5.835494129657746, eval loss: [NA]
Epoch: 8, loss: 5.8457147097587585, eval loss: [NA]
Epoch: 9, loss: 5.845921730995178, eval loss: [NA]
Epoch: 10, loss: 5.837911841869354, eval loss: [NA]
Epoch: 11, loss: 5.875065567493439, eval loss: [NA]
Epoch: 12, loss: 5.842093307971954, eval loss: [NA]
Epoch: 13, loss: 5.863083372116089, eval loss: [NA]
Epoch: 14, loss: 5.83681214094162, eval loss: [NA]
Epoch: 15, loss: 5.847313528060913, eval loss: [NA]
Epoch: 16, loss: 5.878038568496704, eval loss: [NA]
Epoch: 17, loss: 5.8291581749916075, eval loss: [NA]
Epoch: 18, loss: 5.854961745738983, eval loss: [NA]
Epoch: 19, loss: 5.8359888601303105, eval loss: [NA]
Epoch: 20, loss: 5.863467314243317, eval loss: [NA]
Epoch: 21, loss: 5.8574016213417055, eval loss: [NA]
Epoch: 22, loss: 5.87894314289093, eval loss: [NA]
Epoch: 23, loss: 5.836340417861939, eval loss: [NA]
Epoch: 24, loss: 5.841573622226715, eval loss: [NA]

Runtime:400.44
[494.4843, 0.3648, 0.1565, 0.1562]
[3.0382, 0.672, 0.6306, 0.6318]
[2.1821, 0.7604, 0.7523, 0.7537]
tensor(0.7737, grad_fn=<MeanBackward0>)
tensor(0.6403, grad_fn=<MeanBackward0>)
tensor([ 0.2634,  4.4543, -0.1416,  3.9856,  1.6353,  5.9087,  0.4710,  4.6568,
         0.0786,  4.3088], grad_fn=<MeanBackward1>)
tensor([1.2061, 1.2941, 0.3060, 0.3617, 0.3156, 0.3500, 0.3046, 0.3461, 1.1316,
        1.2920], grad_fn=<StdBackward1>)
tensor([ 0.1527,  5.0296, -0.1720,  4.1212,  1.6518,  6.0040,  0.5523,  4.8475,
         0.9799,  5.5771])
KL div untrained: 452.7418
KL div trained: 0.0948
