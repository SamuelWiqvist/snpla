Input args:
Dim: 2
seed: 21
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1816, grad_fn=<MeanBackward0>)
tensor(1.3231, grad_fn=<MeanBackward0>)
tensor([ 0.0834,  0.1995, -0.1233,  0.0335, -0.0065, -0.1579,  0.0724,  0.0747,
        -0.0528,  0.0132], grad_fn=<MeanBackward1>)
tensor([0.9429, 1.0989, 0.9779, 1.0335, 0.9653, 0.9352, 0.9059, 0.9808, 0.9841,
        1.1198], grad_fn=<StdBackward1>)
tensor([ 0.3690, -1.0083, -0.6645, -1.9805, -0.1852, -2.4619,  1.9413,  0.9507,
         1.0120, -0.1592])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.370867288208007, eval loss: [NA]
Epoch: 1, loss: 7.120482385253906, eval loss: [NA]
Epoch: 2, loss: 7.051425091552734, eval loss: [NA]
Epoch: 3, loss: 6.981869207763672, eval loss: [NA]
Epoch: 4, loss: 6.94690798034668, eval loss: [NA]
Epoch: 5, loss: 6.881386239624024, eval loss: [NA]
Epoch: 6, loss: 6.81033981628418, eval loss: [NA]
Epoch: 7, loss: 6.707924249267578, eval loss: [NA]
Epoch: 8, loss: 6.552816213989257, eval loss: [NA]
Epoch: 9, loss: 5.946985771179199, eval loss: [NA]
Epoch: 10, loss: 5.182548098754883, eval loss: [NA]
Epoch: 11, loss: 4.9355800888061525, eval loss: [NA]
Epoch: 12, loss: 4.801530760192871, eval loss: [NA]
Epoch: 13, loss: 4.754219877624512, eval loss: [NA]
Epoch: 14, loss: 4.727563479614258, eval loss: [NA]
Epoch: 15, loss: 4.706138166809082, eval loss: [NA]
Epoch: 16, loss: 4.663293432617188, eval loss: [NA]
Epoch: 17, loss: 4.653406114196778, eval loss: [NA]
Epoch: 18, loss: 4.641077601623535, eval loss: [NA]
Epoch: 19, loss: 4.602780262756347, eval loss: [NA]
Epoch: 20, loss: 4.6335503875732424, eval loss: [NA]
Epoch: 21, loss: 4.603049403381347, eval loss: [NA]
Epoch: 22, loss: 4.598233590698242, eval loss: [NA]
Epoch: 23, loss: 4.596064678955078, eval loss: [NA]
Epoch: 24, loss: 4.625889038085938, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.1134546780586243, eval loss: [NA]
Epoch: 1, loss: 0.8920999336242675, eval loss: [NA]
Epoch: 2, loss: 0.7578907915949822, eval loss: [NA]
Epoch: 3, loss: 0.5809211182594299, eval loss: [NA]
Epoch: 4, loss: 0.5460522708296776, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.343756699562073, eval loss: [NA]
Epoch: 1, loss: 6.330995569229126, eval loss: [NA]
Epoch: 2, loss: 6.343451621532441, eval loss: [NA]
Epoch: 3, loss: 6.340206973552704, eval loss: [NA]
Epoch: 4, loss: 6.336442415714264, eval loss: [NA]
Epoch: 5, loss: 6.366635270118714, eval loss: [NA]
Epoch: 6, loss: 6.324944906234741, eval loss: [NA]
Epoch: 7, loss: 6.33030065536499, eval loss: [NA]
Epoch: 8, loss: 6.3536305284500125, eval loss: [NA]
Epoch: 9, loss: 6.332825102806091, eval loss: [NA]
Epoch: 10, loss: 6.340209269523621, eval loss: [NA]
Epoch: 11, loss: 6.328617792129517, eval loss: [NA]
Epoch: 12, loss: 6.347897357940674, eval loss: [NA]
Epoch: 13, loss: 6.3439047598838805, eval loss: [NA]
Epoch: 14, loss: 6.321199905872345, eval loss: [NA]
Epoch: 15, loss: 6.313761715888977, eval loss: [NA]
Epoch: 16, loss: 6.319634392261505, eval loss: [NA]
Epoch: 17, loss: 6.345440518856049, eval loss: [NA]
Epoch: 18, loss: 6.340731034278869, eval loss: [NA]
Epoch: 19, loss: 6.32988655090332, eval loss: [NA]
Epoch: 20, loss: 6.339432969093322, eval loss: [NA]
Epoch: 21, loss: 6.340442969799041, eval loss: [NA]
Epoch: 22, loss: 6.330577068328857, eval loss: [NA]
Epoch: 23, loss: 6.347343711853028, eval loss: [NA]
Epoch: 24, loss: 6.311533787250519, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.508918502807617, eval loss: [NA]
Epoch: 1, loss: 4.4878885971069336, eval loss: [NA]
Epoch: 2, loss: 4.510828518676758, eval loss: [NA]
Epoch: 3, loss: 4.4953651519775395, eval loss: [NA]
Epoch: 4, loss: 4.490034623718262, eval loss: [NA]
Epoch: 5, loss: 4.51281734008789, eval loss: [NA]
Epoch: 6, loss: 4.48257141418457, eval loss: [NA]
Epoch: 7, loss: 4.499891941833496, eval loss: [NA]
Epoch: 8, loss: 4.4962034530639645, eval loss: [NA]
Epoch: 9, loss: 4.477863293457031, eval loss: [NA]
Epoch: 10, loss: 4.497331520080566, eval loss: [NA]
Epoch: 11, loss: 4.493548486328125, eval loss: [NA]
Epoch: 12, loss: 4.488159043884277, eval loss: [NA]
Epoch: 13, loss: 4.2460258819580075, eval loss: [NA]
Epoch: 14, loss: 3.8761654342651366, eval loss: [NA]
Epoch: 15, loss: 3.721541485595703, eval loss: [NA]
Epoch: 16, loss: 3.607527862548828, eval loss: [NA]
Epoch: 17, loss: 3.568859918212891, eval loss: [NA]
Epoch: 18, loss: 3.5821793533325197, eval loss: [NA]
Epoch: 19, loss: 3.5295002685546875, eval loss: [NA]
Epoch: 20, loss: 3.548612721252441, eval loss: [NA]
Epoch: 21, loss: 3.520469560241699, eval loss: [NA]
Epoch: 22, loss: 3.5632585754394532, eval loss: [NA]
Epoch: 23, loss: 3.5060654357910157, eval loss: [NA]
Epoch: 24, loss: 3.537239944458008, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.618415632247925, eval loss: [NA]
Epoch: 1, loss: 5.604265384674072, eval loss: [NA]
Epoch: 2, loss: 5.608087894916534, eval loss: [NA]
Epoch: 3, loss: 5.601266918182373, eval loss: [NA]
Epoch: 4, loss: 5.570679948329926, eval loss: [NA]
Epoch: 5, loss: 5.59769579410553, eval loss: [NA]
Epoch: 6, loss: 5.615465173721313, eval loss: [NA]
Epoch: 7, loss: 5.594703257083893, eval loss: [NA]
Epoch: 8, loss: 5.594749903678894, eval loss: [NA]
Epoch: 9, loss: 5.605002279281616, eval loss: [NA]
Epoch: 10, loss: 5.57014340877533, eval loss: [NA]
Epoch: 11, loss: 5.575665502548218, eval loss: [NA]
Epoch: 12, loss: 5.581816773414612, eval loss: [NA]
Epoch: 13, loss: 5.59423476934433, eval loss: [NA]
Epoch: 14, loss: 5.6034299397468565, eval loss: [NA]
Epoch: 15, loss: 5.571910197734833, eval loss: [NA]
Epoch: 16, loss: 5.600337059497833, eval loss: [NA]
Epoch: 17, loss: 5.617501080036163, eval loss: [NA]
Epoch: 18, loss: 5.595327167510987, eval loss: [NA]
Epoch: 19, loss: 5.622841019630432, eval loss: [NA]
Epoch: 20, loss: 5.608772442340851, eval loss: [NA]
Epoch: 21, loss: 5.628017370700836, eval loss: [NA]
Epoch: 22, loss: 5.5977488708496095, eval loss: [NA]
Epoch: 23, loss: 5.610900456905365, eval loss: [NA]
Epoch: 24, loss: 5.554286081790924, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.582605679321289, eval loss: [NA]
Epoch: 1, loss: 3.533766612243652, eval loss: [NA]
Epoch: 2, loss: 3.4987973464965823, eval loss: [NA]
Epoch: 3, loss: 3.492453076171875, eval loss: [NA]
Epoch: 4, loss: 3.513512371826172, eval loss: [NA]
Epoch: 5, loss: 3.5051044235229494, eval loss: [NA]
Epoch: 6, loss: 3.5178642974853513, eval loss: [NA]
Epoch: 7, loss: 3.512279382324219, eval loss: [NA]
Epoch: 8, loss: 3.49362004699707, eval loss: [NA]
Epoch: 9, loss: 3.4878518478393556, eval loss: [NA]
Epoch: 10, loss: 3.4859413162231445, eval loss: [NA]
Epoch: 11, loss: 3.5033781875610353, eval loss: [NA]
Epoch: 12, loss: 3.490938145446777, eval loss: [NA]
Epoch: 13, loss: 3.5353592025756835, eval loss: [NA]
Epoch: 14, loss: 3.4728946182250975, eval loss: [NA]
Epoch: 15, loss: 3.4603431518554686, eval loss: [NA]
Epoch: 16, loss: 3.5031691497802733, eval loss: [NA]
Epoch: 17, loss: 3.480065911865234, eval loss: [NA]
Epoch: 18, loss: 3.464073518371582, eval loss: [NA]
Epoch: 19, loss: 3.51041336517334, eval loss: [NA]
Epoch: 20, loss: 3.447222381591797, eval loss: [NA]
Epoch: 21, loss: 3.4459165618896486, eval loss: [NA]
Epoch: 22, loss: 3.486676013183594, eval loss: [NA]
Epoch: 23, loss: 3.4417735733032226, eval loss: [NA]
Epoch: 24, loss: 3.4743500183105467, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.006992087364197, eval loss: [NA]
Epoch: 1, loss: 4.976672990322113, eval loss: [NA]
Epoch: 2, loss: 4.992032339572907, eval loss: [NA]
Epoch: 3, loss: 4.98676830291748, eval loss: [NA]
Epoch: 4, loss: 5.007868635654449, eval loss: [NA]
Epoch: 5, loss: 5.003269293308258, eval loss: [NA]
Epoch: 6, loss: 4.991428785324096, eval loss: [NA]
Epoch: 7, loss: 4.988969554901123, eval loss: [NA]
Epoch: 8, loss: 4.996738295555115, eval loss: [NA]
Epoch: 9, loss: 4.977134075164795, eval loss: [NA]
Epoch: 10, loss: 4.984666304588318, eval loss: [NA]
Epoch: 11, loss: 5.026891188621521, eval loss: [NA]
Epoch: 12, loss: 4.974446997642517, eval loss: [NA]
Epoch: 13, loss: 5.021148197650909, eval loss: [NA]
Epoch: 14, loss: 4.978874320983887, eval loss: [NA]
Epoch: 15, loss: 4.997872862815857, eval loss: [NA]
Epoch: 16, loss: 4.979198195934296, eval loss: [NA]
Epoch: 17, loss: 5.012739737033844, eval loss: [NA]
Epoch: 18, loss: 5.0090052914619445, eval loss: [NA]
Epoch: 19, loss: 5.014496142864227, eval loss: [NA]
Epoch: 20, loss: 4.977512197494507, eval loss: [NA]
Epoch: 21, loss: 5.00527283668518, eval loss: [NA]
Epoch: 22, loss: 4.988488094806671, eval loss: [NA]
Epoch: 23, loss: 4.952311027050018, eval loss: [NA]
Epoch: 24, loss: 4.983109972476959, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4714611740112304, eval loss: [NA]
Epoch: 1, loss: 3.49002830657959, eval loss: [NA]
Epoch: 2, loss: 3.5104470779418944, eval loss: [NA]
Epoch: 3, loss: 3.447625994873047, eval loss: [NA]
Epoch: 4, loss: 3.464140196228027, eval loss: [NA]
Epoch: 5, loss: 3.464932405090332, eval loss: [NA]
Epoch: 6, loss: 3.458016453552246, eval loss: [NA]
Epoch: 7, loss: 3.4561893951416014, eval loss: [NA]
Epoch: 8, loss: 3.4441796157836913, eval loss: [NA]
Epoch: 9, loss: 3.4919915130615236, eval loss: [NA]
Epoch: 10, loss: 3.47489033203125, eval loss: [NA]
Epoch: 11, loss: 3.4790549850463868, eval loss: [NA]
Epoch: 12, loss: 3.4734820114135743, eval loss: [NA]
Epoch: 13, loss: 3.440234829711914, eval loss: [NA]
Epoch: 14, loss: 3.4707101837158203, eval loss: [NA]
Epoch: 15, loss: 3.4255436477661134, eval loss: [NA]
Epoch: 16, loss: 3.4375049713134764, eval loss: [NA]
Epoch: 17, loss: 3.4395561950683593, eval loss: [NA]
Epoch: 18, loss: 3.4617847274780273, eval loss: [NA]
Epoch: 19, loss: 3.450936853027344, eval loss: [NA]
Epoch: 20, loss: 3.456627000427246, eval loss: [NA]
Epoch: 21, loss: 3.420219398498535, eval loss: [NA]
Epoch: 22, loss: 3.4119273544311524, eval loss: [NA]
Epoch: 23, loss: 3.423164671325684, eval loss: [NA]
Epoch: 24, loss: 3.4529176651000975, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 4.955269384384155, eval loss: [NA]
Epoch: 1, loss: 4.952236695289612, eval loss: [NA]
Epoch: 2, loss: 4.932659661769867, eval loss: [NA]
Epoch: 3, loss: 4.9645064115524296, eval loss: [NA]
Epoch: 4, loss: 4.949014601707458, eval loss: [NA]
Epoch: 5, loss: 4.9553918814659115, eval loss: [NA]
Epoch: 6, loss: 4.942546229362488, eval loss: [NA]
Epoch: 7, loss: 4.95669058561325, eval loss: [NA]
Epoch: 8, loss: 4.982027113437653, eval loss: [NA]
Epoch: 9, loss: 4.970546345710755, eval loss: [NA]
Epoch: 10, loss: 4.963965086936951, eval loss: [NA]
Epoch: 11, loss: 4.97792141199112, eval loss: [NA]
Epoch: 12, loss: 4.941169629096985, eval loss: [NA]
Epoch: 13, loss: 4.959903287887573, eval loss: [NA]
Epoch: 14, loss: 4.938761703968048, eval loss: [NA]
Epoch: 15, loss: 4.970816547870636, eval loss: [NA]
Epoch: 16, loss: 4.962030396461487, eval loss: [NA]
Epoch: 17, loss: 4.96424515247345, eval loss: [NA]
Epoch: 18, loss: 4.962769503593445, eval loss: [NA]
Epoch: 19, loss: 4.965213325023651, eval loss: [NA]
Epoch: 20, loss: 4.951144299507141, eval loss: [NA]
Epoch: 21, loss: 4.942091867923737, eval loss: [NA]
Epoch: 22, loss: 4.936828491687774, eval loss: [NA]
Epoch: 23, loss: 4.980713498592377, eval loss: [NA]
Epoch: 24, loss: 4.9576489448547365, eval loss: [NA]

Runtime:390.06
[792546838040475.5, 0.349, 0.1764, 0.2095]
[1.3231, 0.7901, 0.6296, 0.6072]
[2.1816, 0.8843, 0.7617, 0.7612]
tensor(0.7495, grad_fn=<MeanBackward0>)
tensor(0.6050, grad_fn=<MeanBackward0>)
tensor([ 0.2006, -0.9843, -0.6978, -1.9843,  0.2116, -1.0049,  1.9146,  0.8492,
         1.0280, -0.1250], grad_fn=<MeanBackward1>)
tensor([1.1614, 1.2676, 0.3092, 0.3396, 1.1427, 1.1722, 0.2954, 0.3270, 0.3273,
        0.3503], grad_fn=<StdBackward1>)
tensor([ 0.3690, -1.0083, -0.6645, -1.9805, -0.1852, -2.4619,  1.9413,  0.9507,
         1.0120, -0.1592])
KL div untrained: 443931102375235.94
KL div trained: 0.1651
