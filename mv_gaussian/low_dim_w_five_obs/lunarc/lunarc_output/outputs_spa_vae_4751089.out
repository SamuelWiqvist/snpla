/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1852, grad_fn=<MeanBackward0>)
tensor(2.7053, grad_fn=<MeanBackward0>)
tensor([ 0.1961, -0.0454, -0.0402, -0.1135, -0.0741, -0.1749,  0.1635,  0.3013,
         0.1534,  0.1683], grad_fn=<MeanBackward1>)
tensor([0.9781, 0.9210, 0.8860, 1.0317, 1.0155, 1.0259, 0.9779, 1.0033, 0.9009,
        1.1139], grad_fn=<StdBackward1>)
tensor([-5.4795, -1.3369, -0.9523,  3.5409, -2.1759,  1.8250, -5.2685, -0.8735,
        -2.5820,  1.8081])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.666847402954101, eval loss: [NA]
Epoch: 1, loss: 7.136129711914062, eval loss: [NA]
Epoch: 2, loss: 7.066253118896484, eval loss: [NA]
Epoch: 3, loss: 6.996075201416016, eval loss: [NA]
Epoch: 4, loss: 6.968875512695313, eval loss: [NA]
Epoch: 5, loss: 6.934778271484375, eval loss: [NA]
Epoch: 6, loss: 6.931777923583985, eval loss: [NA]
Epoch: 7, loss: 6.914274765014649, eval loss: [NA]
Epoch: 8, loss: 6.83876569519043, eval loss: [NA]
Epoch: 9, loss: 6.462709060668946, eval loss: [NA]
Epoch: 10, loss: 6.116538595581055, eval loss: [NA]
Epoch: 11, loss: 5.977152487182617, eval loss: [NA]
Epoch: 12, loss: 5.907702792358398, eval loss: [NA]
Epoch: 13, loss: 5.873057664489746, eval loss: [NA]
Epoch: 14, loss: 5.817319151306152, eval loss: [NA]
Epoch: 15, loss: 5.826345433044434, eval loss: [NA]
Epoch: 16, loss: 5.81678758392334, eval loss: [NA]
Epoch: 17, loss: 5.806844180297851, eval loss: [NA]
Epoch: 18, loss: 5.79371219329834, eval loss: [NA]
Epoch: 19, loss: 5.770196752929688, eval loss: [NA]
Epoch: 20, loss: 5.7754882614135745, eval loss: [NA]
Epoch: 21, loss: 5.779867292785645, eval loss: [NA]
Epoch: 22, loss: 5.771918196105957, eval loss: [NA]
Epoch: 23, loss: 5.758921182250977, eval loss: [NA]
Epoch: 24, loss: 5.763387663269043, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 24.685790538787842, eval loss: [NA]
Epoch: 1, loss: 17.522917051315307, eval loss: [NA]
Epoch: 2, loss: 17.54295735359192, eval loss: [NA]
Epoch: 3, loss: 17.56618137359619, eval loss: [NA]
Epoch: 4, loss: 17.56024196624756, eval loss: [NA]
Epoch: 5, loss: 17.523448457717894, eval loss: [NA]
Epoch: 6, loss: 17.536703481674195, eval loss: [NA]
Epoch: 7, loss: 17.53040961265564, eval loss: [NA]
Epoch: 8, loss: 17.54350814819336, eval loss: [NA]
Epoch: 9, loss: 17.53407007217407, eval loss: [NA]
Epoch: 10, loss: 17.559671096801758, eval loss: [NA]
Epoch: 11, loss: 17.518860702514647, eval loss: [NA]
Epoch: 12, loss: 17.535974035263063, eval loss: [NA]
Epoch: 13, loss: 17.55451082229614, eval loss: [NA]
Epoch: 14, loss: 17.553274488449098, eval loss: [NA]
Epoch: 15, loss: 17.53283052444458, eval loss: [NA]
Epoch: 16, loss: 17.520386571884156, eval loss: [NA]
Epoch: 17, loss: 17.557856845855714, eval loss: [NA]
Epoch: 18, loss: 17.563985424041746, eval loss: [NA]
Epoch: 19, loss: 17.538028745651246, eval loss: [NA]
Epoch: 20, loss: 17.5410076713562, eval loss: [NA]
Epoch: 21, loss: 17.54941020965576, eval loss: [NA]
Epoch: 22, loss: 17.532253561019896, eval loss: [NA]
Epoch: 23, loss: 17.523019037246705, eval loss: [NA]
Epoch: 24, loss: 17.554486198425295, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.765480113220215, eval loss: [NA]
Epoch: 1, loss: 5.752870355224609, eval loss: [NA]
Epoch: 2, loss: 5.735710276794434, eval loss: [NA]
Epoch: 3, loss: 5.732708047485351, eval loss: [NA]
Epoch: 4, loss: 5.709397834777832, eval loss: [NA]
Epoch: 5, loss: 5.688790568542481, eval loss: [NA]
Epoch: 6, loss: 5.422309042358399, eval loss: [NA]
Epoch: 7, loss: 4.991788928222657, eval loss: [NA]
Epoch: 8, loss: 4.8407636093139645, eval loss: [NA]
Epoch: 9, loss: 4.824340475463867, eval loss: [NA]
Epoch: 10, loss: 4.803256636047363, eval loss: [NA]
Epoch: 11, loss: 4.786716027832031, eval loss: [NA]
Epoch: 12, loss: 4.763023173522949, eval loss: [NA]
Epoch: 13, loss: 4.772446095275879, eval loss: [NA]
Epoch: 14, loss: 4.656857545471191, eval loss: [NA]
Epoch: 15, loss: 4.658821867370605, eval loss: [NA]
Epoch: 16, loss: 4.595038887023926, eval loss: [NA]
Epoch: 17, loss: 4.611218263244629, eval loss: [NA]
Epoch: 18, loss: 4.619368769836425, eval loss: [NA]
Epoch: 19, loss: 4.591321861267089, eval loss: [NA]
Epoch: 20, loss: 4.591810893249511, eval loss: [NA]
Epoch: 21, loss: 4.6065046554565425, eval loss: [NA]
Epoch: 22, loss: 4.545602908325195, eval loss: [NA]
Epoch: 23, loss: 4.529592095947265, eval loss: [NA]
Epoch: 24, loss: 4.562185186767578, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 16.180065484046935, eval loss: [NA]
Epoch: 1, loss: 16.161167850494383, eval loss: [NA]
Epoch: 2, loss: 16.142493815422057, eval loss: [NA]
Epoch: 3, loss: 16.13198443889618, eval loss: [NA]
Epoch: 4, loss: 16.14173662662506, eval loss: [NA]
Epoch: 5, loss: 16.15325610637665, eval loss: [NA]
Epoch: 6, loss: 16.122508187294006, eval loss: [NA]
Epoch: 7, loss: 16.161237211227416, eval loss: [NA]
Epoch: 8, loss: 16.146851439476013, eval loss: [NA]
Epoch: 9, loss: 16.151023812294007, eval loss: [NA]
Epoch: 10, loss: 16.171096415519713, eval loss: [NA]
Epoch: 11, loss: 16.150735325813294, eval loss: [NA]
Epoch: 12, loss: 16.159585499763487, eval loss: [NA]
Epoch: 13, loss: 16.154695754051208, eval loss: [NA]
Epoch: 14, loss: 16.191501536369323, eval loss: [NA]
Epoch: 15, loss: 16.131732845306395, eval loss: [NA]
Epoch: 16, loss: 16.13900688648224, eval loss: [NA]
Epoch: 17, loss: 16.141451010704042, eval loss: [NA]
Epoch: 18, loss: 16.150698719024657, eval loss: [NA]
Epoch: 19, loss: 16.14992660522461, eval loss: [NA]
Epoch: 20, loss: 16.15844135284424, eval loss: [NA]
Epoch: 21, loss: 16.139088521003725, eval loss: [NA]
Epoch: 22, loss: 16.155457301139833, eval loss: [NA]
Epoch: 23, loss: 16.155904250144957, eval loss: [NA]
Epoch: 24, loss: 16.147311720848084, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 4.572867013549804, eval loss: [NA]
Epoch: 1, loss: 4.578706466674805, eval loss: [NA]
Epoch: 2, loss: 4.531284825134278, eval loss: [NA]
Epoch: 3, loss: 4.568584199523926, eval loss: [NA]
Epoch: 4, loss: 4.540777558898926, eval loss: [NA]
Epoch: 5, loss: 4.5253398315429685, eval loss: [NA]
Epoch: 6, loss: 4.5483714172363285, eval loss: [NA]
Epoch: 7, loss: 4.519793853759766, eval loss: [NA]
Epoch: 8, loss: 4.5527503860473635, eval loss: [NA]
Epoch: 9, loss: 4.545266540527344, eval loss: [NA]
Epoch: 10, loss: 4.497272135925293, eval loss: [NA]
Epoch: 11, loss: 4.5326816223144535, eval loss: [NA]
Epoch: 12, loss: 4.5181830078125, eval loss: [NA]
Epoch: 13, loss: 4.560758085632324, eval loss: [NA]
Epoch: 14, loss: 4.519037059020996, eval loss: [NA]
Epoch: 15, loss: 4.528171893310547, eval loss: [NA]
Epoch: 16, loss: 4.473821212768555, eval loss: [NA]
Epoch: 17, loss: 4.368851853942871, eval loss: [NA]
Epoch: 18, loss: 4.015126812744141, eval loss: [NA]
Epoch: 19, loss: 3.9300685546875, eval loss: [NA]
Epoch: 20, loss: 3.882184507751465, eval loss: [NA]
Epoch: 21, loss: 3.8244671783447264, eval loss: [NA]
Epoch: 22, loss: 3.7989065292358397, eval loss: [NA]
Epoch: 23, loss: 3.7937257019042967, eval loss: [NA]
Epoch: 24, loss: 3.744676689147949, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 13.312224144935607, eval loss: [NA]
Epoch: 1, loss: 13.262271275520325, eval loss: [NA]
Epoch: 2, loss: 13.289965600967408, eval loss: [NA]
Epoch: 3, loss: 13.260360913276672, eval loss: [NA]
Epoch: 4, loss: 13.288233709335326, eval loss: [NA]
Epoch: 5, loss: 13.292833886146546, eval loss: [NA]
Epoch: 6, loss: 13.295546207427979, eval loss: [NA]
Epoch: 7, loss: 13.263007407188416, eval loss: [NA]
Epoch: 8, loss: 13.295534429550171, eval loss: [NA]
Epoch: 9, loss: 13.292417149543763, eval loss: [NA]
Epoch: 10, loss: 13.300270853042603, eval loss: [NA]
Epoch: 11, loss: 13.280296182632446, eval loss: [NA]
Epoch: 12, loss: 13.287302942276002, eval loss: [NA]
Epoch: 13, loss: 13.266328382492066, eval loss: [NA]
Epoch: 14, loss: 13.29811098575592, eval loss: [NA]
Epoch: 15, loss: 13.242723035812379, eval loss: [NA]
Epoch: 16, loss: 13.28555691242218, eval loss: [NA]
Epoch: 17, loss: 13.264428277015686, eval loss: [NA]
Epoch: 18, loss: 13.280411643981934, eval loss: [NA]
Epoch: 19, loss: 13.269763684272766, eval loss: [NA]
Epoch: 20, loss: 13.264079718589782, eval loss: [NA]
Epoch: 21, loss: 13.258314208984375, eval loss: [NA]
Epoch: 22, loss: 13.291170959472657, eval loss: [NA]
Epoch: 23, loss: 13.29191897392273, eval loss: [NA]
Epoch: 24, loss: 13.283701186180116, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.673642691040039, eval loss: [NA]
Epoch: 1, loss: 3.593988032531738, eval loss: [NA]
Epoch: 2, loss: 3.554050262451172, eval loss: [NA]
Epoch: 3, loss: 3.525411686706543, eval loss: [NA]
Epoch: 4, loss: 3.499538983154297, eval loss: [NA]
Epoch: 5, loss: 3.4593822387695314, eval loss: [NA]
Epoch: 6, loss: 3.484131951904297, eval loss: [NA]
Epoch: 7, loss: 3.4690208282470705, eval loss: [NA]
Epoch: 8, loss: 3.461537289428711, eval loss: [NA]
Epoch: 9, loss: 3.4507498504638674, eval loss: [NA]
Epoch: 10, loss: 3.438240168762207, eval loss: [NA]
Epoch: 11, loss: 3.4624888748168945, eval loss: [NA]
Epoch: 12, loss: 3.4840415954589843, eval loss: [NA]
Epoch: 13, loss: 3.4498988082885744, eval loss: [NA]
Epoch: 14, loss: 3.449937089538574, eval loss: [NA]
Epoch: 15, loss: 3.461818119812012, eval loss: [NA]
Epoch: 16, loss: 3.4611619552612303, eval loss: [NA]
Epoch: 17, loss: 3.479595341491699, eval loss: [NA]
Epoch: 18, loss: 3.4474098937988282, eval loss: [NA]
Epoch: 19, loss: 3.4725334014892577, eval loss: [NA]
Epoch: 20, loss: 3.4401002639770506, eval loss: [NA]
Epoch: 21, loss: 3.4839427291870115, eval loss: [NA]
Epoch: 22, loss: 3.4850337875366213, eval loss: [NA]
Epoch: 23, loss: 3.440056443786621, eval loss: [NA]
Epoch: 24, loss: 3.4500475860595703, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 13.408961911201477, eval loss: [NA]
Epoch: 1, loss: 13.397042098045349, eval loss: [NA]
Epoch: 2, loss: 13.425825781822205, eval loss: [NA]
Epoch: 3, loss: 13.395257487297059, eval loss: [NA]
Epoch: 4, loss: 13.432669911384583, eval loss: [NA]
Epoch: 5, loss: 13.394846420288086, eval loss: [NA]
Epoch: 6, loss: 13.369560027122498, eval loss: [NA]
Epoch: 7, loss: 13.38174211025238, eval loss: [NA]
Epoch: 8, loss: 13.375561909675598, eval loss: [NA]
Epoch: 9, loss: 13.402542867660522, eval loss: [NA]
Epoch: 10, loss: 13.425933108329772, eval loss: [NA]
Epoch: 11, loss: 13.403043727874756, eval loss: [NA]
Epoch: 12, loss: 13.41061309814453, eval loss: [NA]
Epoch: 13, loss: 13.40411723613739, eval loss: [NA]
Epoch: 14, loss: 13.390808668136597, eval loss: [NA]
Epoch: 15, loss: 13.4115691614151, eval loss: [NA]
Epoch: 16, loss: 13.406155090332032, eval loss: [NA]
Epoch: 17, loss: 13.415604777336121, eval loss: [NA]
Epoch: 18, loss: 13.40523730278015, eval loss: [NA]
Epoch: 19, loss: 13.410473947525025, eval loss: [NA]
Epoch: 20, loss: 13.407167553901672, eval loss: [NA]
Epoch: 21, loss: 13.426232409477233, eval loss: [NA]
Epoch: 22, loss: 13.393310685157775, eval loss: [NA]
Epoch: 23, loss: 13.394754910469056, eval loss: [NA]
Epoch: 24, loss: 13.390773816108704, eval loss: [NA]

Runtime:384.75
[991.0038, 1.605, 0.3933, 0.233]
[2.7053, 1.654, 1.3452, 1.1393]
[2.1852, 1.0886, 0.8938, 0.8161]
tensor(0.7670, grad_fn=<MeanBackward0>)
tensor(1.1219, grad_fn=<MeanBackward0>)
tensor([-3.5899,  0.4602, -3.5104,  0.5446, -2.2519,  1.9536, -4.9138, -0.9684,
        -2.5535,  1.5823], grad_fn=<MeanBackward1>)
tensor([1.1644, 1.2229, 1.1946, 1.2607, 0.3299, 0.3397, 0.3146, 0.3314, 0.3124,
        0.3505], grad_fn=<StdBackward1>)
tensor([-5.4795, -1.3369, -0.9523,  3.5409, -2.1759,  1.8250, -5.2685, -0.8735,
        -2.5820,  1.8081])
KL div untrained: 974.0812
KL div trained: 0.2113
