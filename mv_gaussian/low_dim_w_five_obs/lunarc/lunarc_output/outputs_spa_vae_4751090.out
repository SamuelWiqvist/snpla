/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1772, grad_fn=<MeanBackward0>)
tensor(1.7770, grad_fn=<MeanBackward0>)
tensor([-0.0506,  0.1540, -0.1894, -0.2461,  0.1174,  0.0462, -0.1512,  0.0895,
        -0.0081, -0.0786], grad_fn=<MeanBackward1>)
tensor([1.0568, 1.0103, 1.0543, 0.8843, 1.0090, 0.9913, 0.9410, 0.9384, 1.1012,
        0.9803], grad_fn=<StdBackward1>)
tensor([-1.6616, -2.1609, -1.7456, -1.7803, -1.3209, -0.8756, -2.7388, -3.3261,
        -0.3453, -0.9167])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.772686083984375, eval loss: [NA]
Epoch: 1, loss: 7.129396469116211, eval loss: [NA]
Epoch: 2, loss: 7.023309698486328, eval loss: [NA]
Epoch: 3, loss: 6.996195751953125, eval loss: [NA]
Epoch: 4, loss: 6.986778674316406, eval loss: [NA]
Epoch: 5, loss: 6.9442283630371096, eval loss: [NA]
Epoch: 6, loss: 6.9395225036621095, eval loss: [NA]
Epoch: 7, loss: 6.8969580230712895, eval loss: [NA]
Epoch: 8, loss: 6.8766009765625, eval loss: [NA]
Epoch: 9, loss: 6.860938607788086, eval loss: [NA]
Epoch: 10, loss: 6.8687710968017575, eval loss: [NA]
Epoch: 11, loss: 6.827457556152344, eval loss: [NA]
Epoch: 12, loss: 6.767887097167969, eval loss: [NA]
Epoch: 13, loss: 6.664155984497071, eval loss: [NA]
Epoch: 14, loss: 6.4863126220703125, eval loss: [NA]
Epoch: 15, loss: 6.19898755645752, eval loss: [NA]
Epoch: 16, loss: 5.94494813079834, eval loss: [NA]
Epoch: 17, loss: 5.485944914245605, eval loss: [NA]
Epoch: 18, loss: 5.0987207809448245, eval loss: [NA]
Epoch: 19, loss: 4.8795098831176755, eval loss: [NA]
Epoch: 20, loss: 4.798458682250977, eval loss: [NA]
Epoch: 21, loss: 4.741134480285645, eval loss: [NA]
Epoch: 22, loss: 4.697279197692871, eval loss: [NA]
Epoch: 23, loss: 4.6946626419067385, eval loss: [NA]
Epoch: 24, loss: 4.597783583068848, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 38.88331881523132, eval loss: [NA]
Epoch: 1, loss: 8.42559139251709, eval loss: [NA]
Epoch: 2, loss: 8.419930710792542, eval loss: [NA]
Epoch: 3, loss: 8.424810478687286, eval loss: [NA]
Epoch: 4, loss: 8.402528395652771, eval loss: [NA]
Epoch: 5, loss: 8.39997406244278, eval loss: [NA]
Epoch: 6, loss: 8.39430686712265, eval loss: [NA]
Epoch: 7, loss: 8.400829966068267, eval loss: [NA]
Epoch: 8, loss: 8.376807377338409, eval loss: [NA]
Epoch: 9, loss: 8.405444481372832, eval loss: [NA]
Epoch: 10, loss: 8.401504909992218, eval loss: [NA]
Epoch: 11, loss: 8.403237743377685, eval loss: [NA]
Epoch: 12, loss: 8.407687952518463, eval loss: [NA]
Epoch: 13, loss: 8.404136912822723, eval loss: [NA]
Epoch: 14, loss: 8.392764067649841, eval loss: [NA]
Epoch: 15, loss: 8.393943815231323, eval loss: [NA]
Epoch: 16, loss: 8.400797405242919, eval loss: [NA]
Epoch: 17, loss: 8.425826733112336, eval loss: [NA]
Epoch: 18, loss: 8.409986565113067, eval loss: [NA]
Epoch: 19, loss: 8.392073428630829, eval loss: [NA]
Epoch: 20, loss: 8.40425320148468, eval loss: [NA]
Epoch: 21, loss: 8.4057208442688, eval loss: [NA]
Epoch: 22, loss: 8.405322232246398, eval loss: [NA]
Epoch: 23, loss: 8.390967237949372, eval loss: [NA]
Epoch: 24, loss: 8.401761722564697, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.576268905639648, eval loss: [NA]
Epoch: 1, loss: 4.504819284057617, eval loss: [NA]
Epoch: 2, loss: 4.553830400085449, eval loss: [NA]
Epoch: 3, loss: 4.473150964355469, eval loss: [NA]
Epoch: 4, loss: 4.359924855041504, eval loss: [NA]
Epoch: 5, loss: 4.027822245788574, eval loss: [NA]
Epoch: 6, loss: 3.7973904281616213, eval loss: [NA]
Epoch: 7, loss: 3.724810427856445, eval loss: [NA]
Epoch: 8, loss: 3.6337795333862304, eval loss: [NA]
Epoch: 9, loss: 3.6147319244384764, eval loss: [NA]
Epoch: 10, loss: 3.6089147064208986, eval loss: [NA]
Epoch: 11, loss: 3.5793802764892577, eval loss: [NA]
Epoch: 12, loss: 3.5519494873046873, eval loss: [NA]
Epoch: 13, loss: 3.569471940612793, eval loss: [NA]
Epoch: 14, loss: 3.5485615783691404, eval loss: [NA]
Epoch: 15, loss: 3.514873272705078, eval loss: [NA]
Epoch: 16, loss: 3.5481456161499025, eval loss: [NA]
Epoch: 17, loss: 3.524615055847168, eval loss: [NA]
Epoch: 18, loss: 3.547912747192383, eval loss: [NA]
Epoch: 19, loss: 3.5129878204345704, eval loss: [NA]
Epoch: 20, loss: 3.5503208755493163, eval loss: [NA]
Epoch: 21, loss: 3.521975035095215, eval loss: [NA]
Epoch: 22, loss: 3.5286482360839844, eval loss: [NA]
Epoch: 23, loss: 3.4874645370483397, eval loss: [NA]
Epoch: 24, loss: 3.503825924682617, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.797824699878692, eval loss: [NA]
Epoch: 1, loss: 6.768396723270416, eval loss: [NA]
Epoch: 2, loss: 6.796833498477936, eval loss: [NA]
Epoch: 3, loss: 6.80679016828537, eval loss: [NA]
Epoch: 4, loss: 6.767280266284943, eval loss: [NA]
Epoch: 5, loss: 6.789780185222626, eval loss: [NA]
Epoch: 6, loss: 6.776119132041931, eval loss: [NA]
Epoch: 7, loss: 6.77991230726242, eval loss: [NA]
Epoch: 8, loss: 6.800832574367523, eval loss: [NA]
Epoch: 9, loss: 6.761888465881348, eval loss: [NA]
Epoch: 10, loss: 6.7841608786582945, eval loss: [NA]
Epoch: 11, loss: 6.798835980892181, eval loss: [NA]
Epoch: 12, loss: 6.793139307498932, eval loss: [NA]
Epoch: 13, loss: 6.812583458423615, eval loss: [NA]
Epoch: 14, loss: 6.8196906471252445, eval loss: [NA]
Epoch: 15, loss: 6.798379058837891, eval loss: [NA]
Epoch: 16, loss: 6.776238284111023, eval loss: [NA]
Epoch: 17, loss: 6.786193411350251, eval loss: [NA]
Epoch: 18, loss: 6.8012159633636475, eval loss: [NA]
Epoch: 19, loss: 6.796811385154724, eval loss: [NA]
Epoch: 20, loss: 6.760634446144104, eval loss: [NA]
Epoch: 21, loss: 6.793985950946808, eval loss: [NA]
Epoch: 22, loss: 6.792466254234314, eval loss: [NA]
Epoch: 23, loss: 6.790643939971924, eval loss: [NA]
Epoch: 24, loss: 6.790478732585907, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.473165797424316, eval loss: [NA]
Epoch: 1, loss: 3.4805015655517577, eval loss: [NA]
Epoch: 2, loss: 3.4584575729370117, eval loss: [NA]
Epoch: 3, loss: 3.4471841384887694, eval loss: [NA]
Epoch: 4, loss: 3.463578468322754, eval loss: [NA]
Epoch: 5, loss: 3.4660510864257814, eval loss: [NA]
Epoch: 6, loss: 3.4298173919677732, eval loss: [NA]
Epoch: 7, loss: 3.4295912353515625, eval loss: [NA]
Epoch: 8, loss: 3.427231637573242, eval loss: [NA]
Epoch: 9, loss: 3.414210610961914, eval loss: [NA]
Epoch: 10, loss: 3.469032498168945, eval loss: [NA]
Epoch: 11, loss: 3.4433753845214845, eval loss: [NA]
Epoch: 12, loss: 3.4447025085449217, eval loss: [NA]
Epoch: 13, loss: 3.4132881072998047, eval loss: [NA]
Epoch: 14, loss: 3.4293189346313477, eval loss: [NA]
Epoch: 15, loss: 3.4090846466064453, eval loss: [NA]
Epoch: 16, loss: 3.415807362365723, eval loss: [NA]
Epoch: 17, loss: 3.414329180908203, eval loss: [NA]
Epoch: 18, loss: 3.399003874206543, eval loss: [NA]
Epoch: 19, loss: 3.3968121231079103, eval loss: [NA]
Epoch: 20, loss: 3.4259684967041015, eval loss: [NA]
Epoch: 21, loss: 3.430431253051758, eval loss: [NA]
Epoch: 22, loss: 3.4422834259033204, eval loss: [NA]
Epoch: 23, loss: 3.4135698318481444, eval loss: [NA]
Epoch: 24, loss: 3.407955137634277, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.8685461831092836, eval loss: [NA]
Epoch: 1, loss: 6.842003536224365, eval loss: [NA]
Epoch: 2, loss: 6.856288523674011, eval loss: [NA]
Epoch: 3, loss: 6.868832149505615, eval loss: [NA]
Epoch: 4, loss: 6.868352823257446, eval loss: [NA]
Epoch: 5, loss: 6.851333312988281, eval loss: [NA]
Epoch: 6, loss: 6.871784584522247, eval loss: [NA]
Epoch: 7, loss: 6.865304169654846, eval loss: [NA]
Epoch: 8, loss: 6.838677175045014, eval loss: [NA]
Epoch: 9, loss: 6.870030071735382, eval loss: [NA]
Epoch: 10, loss: 6.819398279190064, eval loss: [NA]
Epoch: 11, loss: 6.83708479642868, eval loss: [NA]
Epoch: 12, loss: 6.8428070139884944, eval loss: [NA]
Epoch: 13, loss: 6.830450727939605, eval loss: [NA]
Epoch: 14, loss: 6.832829008102417, eval loss: [NA]
Epoch: 15, loss: 6.85102481842041, eval loss: [NA]
Epoch: 16, loss: 6.846953692436219, eval loss: [NA]
Epoch: 17, loss: 6.8467120170593265, eval loss: [NA]
Epoch: 18, loss: 6.869315571784973, eval loss: [NA]
Epoch: 19, loss: 6.859298651218414, eval loss: [NA]
Epoch: 20, loss: 6.834963762760163, eval loss: [NA]
Epoch: 21, loss: 6.837962119579315, eval loss: [NA]
Epoch: 22, loss: 6.851223936080933, eval loss: [NA]
Epoch: 23, loss: 6.8684701728820805, eval loss: [NA]
Epoch: 24, loss: 6.883236458301544, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.380416662597656, eval loss: [NA]
Epoch: 1, loss: 3.3624722427368163, eval loss: [NA]
Epoch: 2, loss: 3.3995510009765626, eval loss: [NA]
Epoch: 3, loss: 3.3329587448120117, eval loss: [NA]
Epoch: 4, loss: 3.390491482543945, eval loss: [NA]
Epoch: 5, loss: 3.3578840637207032, eval loss: [NA]
Epoch: 6, loss: 3.3437267150878904, eval loss: [NA]
Epoch: 7, loss: 3.375813053894043, eval loss: [NA]
Epoch: 8, loss: 3.3387043029785155, eval loss: [NA]
Epoch: 9, loss: 3.3325326751708984, eval loss: [NA]
Epoch: 10, loss: 3.377474230957031, eval loss: [NA]
Epoch: 11, loss: 3.3445910369873046, eval loss: [NA]
Epoch: 12, loss: 3.347678155517578, eval loss: [NA]
Epoch: 13, loss: 3.253984910583496, eval loss: [NA]
Epoch: 14, loss: 2.976349867248535, eval loss: [NA]
Epoch: 15, loss: 2.615915771484375, eval loss: [NA]
Epoch: 16, loss: 2.5348175979614256, eval loss: [NA]
Epoch: 17, loss: 2.4579354888916014, eval loss: [NA]
Epoch: 18, loss: 2.464017251586914, eval loss: [NA]
Epoch: 19, loss: 2.422410145568848, eval loss: [NA]
Epoch: 20, loss: 2.413426724243164, eval loss: [NA]
Epoch: 21, loss: 2.4112526535034178, eval loss: [NA]
Epoch: 22, loss: 2.3822880905151367, eval loss: [NA]
Epoch: 23, loss: 2.3977843185424805, eval loss: [NA]
Epoch: 24, loss: 2.348702783203125, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.678036327362061, eval loss: [NA]
Epoch: 1, loss: 5.682906742095947, eval loss: [NA]
Epoch: 2, loss: 5.657302749156952, eval loss: [NA]
Epoch: 3, loss: 5.672481575012207, eval loss: [NA]
Epoch: 4, loss: 5.708577468395233, eval loss: [NA]
Epoch: 5, loss: 5.684115483760833, eval loss: [NA]
Epoch: 6, loss: 5.671840331554413, eval loss: [NA]
Epoch: 7, loss: 5.681270272731781, eval loss: [NA]
Epoch: 8, loss: 5.666579158306122, eval loss: [NA]
Epoch: 9, loss: 5.6953137755393985, eval loss: [NA]
Epoch: 10, loss: 5.638519430160523, eval loss: [NA]
Epoch: 11, loss: 5.673328537940979, eval loss: [NA]
Epoch: 12, loss: 5.653722839355469, eval loss: [NA]
Epoch: 13, loss: 5.638927834033966, eval loss: [NA]
Epoch: 14, loss: 5.6580993890762326, eval loss: [NA]
Epoch: 15, loss: 5.6557932305336, eval loss: [NA]
Epoch: 16, loss: 5.708239989280701, eval loss: [NA]
Epoch: 17, loss: 5.6685602617263795, eval loss: [NA]
Epoch: 18, loss: 5.675776998996735, eval loss: [NA]
Epoch: 19, loss: 5.673395957946777, eval loss: [NA]
Epoch: 20, loss: 5.672905735969543, eval loss: [NA]
Epoch: 21, loss: 5.673211688995361, eval loss: [NA]
Epoch: 22, loss: 5.669693160057068, eval loss: [NA]
Epoch: 23, loss: 5.63563419342041, eval loss: [NA]
Epoch: 24, loss: 5.659444432258606, eval loss: [NA]

Runtime:388.34
[3568.0567, 0.3557, 0.1375, 0.1204]
[1.777, 0.9053, 0.7777, 0.7905]
[2.1772, 0.8782, 0.7313, 0.735]
tensor(0.6276, grad_fn=<MeanBackward0>)
tensor(0.4872, grad_fn=<MeanBackward0>)
tensor([-1.6995, -1.9560, -1.6252, -1.8900, -0.9878, -1.2511, -2.9259, -3.3312,
        -1.2661, -1.6209], grad_fn=<MeanBackward1>)
tensor([0.3207, 0.3475, 0.3157, 0.3294, 0.3050, 0.3445, 0.3499, 0.3613, 1.1650,
        1.2284], grad_fn=<StdBackward1>)
tensor([-1.6616, -2.1609, -1.7456, -1.7803, -1.3209, -0.8756, -2.7388, -3.3261,
        -0.3453, -0.9167])
KL div untrained: 3115.0612
KL div trained: 0.0175
