Input args:
Dim: 2
seed: 26
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1735, grad_fn=<MeanBackward0>)
tensor(2.6148, grad_fn=<MeanBackward0>)
tensor([ 0.1610, -0.1809,  0.0208, -0.0381, -0.0815,  0.0990,  0.1297, -0.1589,
         0.1095,  0.1646], grad_fn=<MeanBackward1>)
tensor([1.0090, 1.0218, 1.0679, 1.0460, 0.9668, 1.0388, 1.0824, 1.0241, 0.9144,
        1.1227], grad_fn=<StdBackward1>)
tensor([-3.1520, -4.4602, -3.0925, -3.8739, -0.0739, -1.2137, -1.3187, -2.1858,
        -2.2290, -3.3217])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 10.918575146484375, eval loss: [NA]
Epoch: 1, loss: 7.047138018798828, eval loss: [NA]
Epoch: 2, loss: 6.946913314819336, eval loss: [NA]
Epoch: 3, loss: 6.865361499023438, eval loss: [NA]
Epoch: 4, loss: 6.852354223632813, eval loss: [NA]
Epoch: 5, loss: 6.793837356567383, eval loss: [NA]
Epoch: 6, loss: 6.660756170654297, eval loss: [NA]
Epoch: 7, loss: 6.212526307678223, eval loss: [NA]
Epoch: 8, loss: 5.382982206726075, eval loss: [NA]
Epoch: 9, loss: 5.056118293762207, eval loss: [NA]
Epoch: 10, loss: 4.9579757141113285, eval loss: [NA]
Epoch: 11, loss: 4.835834060668946, eval loss: [NA]
Epoch: 12, loss: 4.753286837768555, eval loss: [NA]
Epoch: 13, loss: 4.676523876953125, eval loss: [NA]
Epoch: 14, loss: 4.658824871826172, eval loss: [NA]
Epoch: 15, loss: 4.619228456115723, eval loss: [NA]
Epoch: 16, loss: 4.6152487518310545, eval loss: [NA]
Epoch: 17, loss: 4.613391510009766, eval loss: [NA]
Epoch: 18, loss: 4.576076936340332, eval loss: [NA]
Epoch: 19, loss: 4.5789646209716794, eval loss: [NA]
Epoch: 20, loss: 4.563897409057617, eval loss: [NA]
Epoch: 21, loss: 4.561979679870605, eval loss: [NA]
Epoch: 22, loss: 4.567116740417481, eval loss: [NA]
Epoch: 23, loss: 4.54796856842041, eval loss: [NA]
Epoch: 24, loss: 4.533095600891113, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.1711441025137903, eval loss: [NA]
Epoch: 1, loss: 0.872108154296875, eval loss: [NA]
Epoch: 2, loss: 0.6654211510717869, eval loss: [NA]
Epoch: 3, loss: 0.582557232528925, eval loss: [NA]
Epoch: 4, loss: 0.5838361049070955, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.697132818698883, eval loss: [NA]
Epoch: 1, loss: 7.557426276206971, eval loss: [NA]
Epoch: 2, loss: 7.558873612880706, eval loss: [NA]
Epoch: 3, loss: 7.585867004394531, eval loss: [NA]
Epoch: 4, loss: 7.608798716068268, eval loss: [NA]
Epoch: 5, loss: 7.573916478157043, eval loss: [NA]
Epoch: 6, loss: 7.587138769626617, eval loss: [NA]
Epoch: 7, loss: 7.595000803470612, eval loss: [NA]
Epoch: 8, loss: 7.610097243785858, eval loss: [NA]
Epoch: 9, loss: 7.5606262135505675, eval loss: [NA]
Epoch: 10, loss: 7.618713555335998, eval loss: [NA]
Epoch: 11, loss: 7.555690886974335, eval loss: [NA]
Epoch: 12, loss: 7.593578233718872, eval loss: [NA]
Epoch: 13, loss: 7.593696796894074, eval loss: [NA]
Epoch: 14, loss: 7.5875051403045655, eval loss: [NA]
Epoch: 15, loss: 7.585697319507599, eval loss: [NA]
Epoch: 16, loss: 7.590110991001129, eval loss: [NA]
Epoch: 17, loss: 7.587645561695099, eval loss: [NA]
Epoch: 18, loss: 7.565699577331543, eval loss: [NA]
Epoch: 19, loss: 7.572845323085785, eval loss: [NA]
Epoch: 20, loss: 7.595588445663452, eval loss: [NA]
Epoch: 21, loss: 7.6008511781692505, eval loss: [NA]
Epoch: 22, loss: 7.5990239214897155, eval loss: [NA]
Epoch: 23, loss: 7.55897498369217, eval loss: [NA]
Epoch: 24, loss: 7.5514315056800845, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.608153875732422, eval loss: [NA]
Epoch: 1, loss: 4.57240034790039, eval loss: [NA]
Epoch: 2, loss: 4.5557467681884765, eval loss: [NA]
Epoch: 3, loss: 4.5342990234375, eval loss: [NA]
Epoch: 4, loss: 4.535582733154297, eval loss: [NA]
Epoch: 5, loss: 4.486113198852539, eval loss: [NA]
Epoch: 6, loss: 4.492424822998047, eval loss: [NA]
Epoch: 7, loss: 4.459246977233887, eval loss: [NA]
Epoch: 8, loss: 4.089880879211425, eval loss: [NA]
Epoch: 9, loss: 3.795045965576172, eval loss: [NA]
Epoch: 10, loss: 3.698804357910156, eval loss: [NA]
Epoch: 11, loss: 3.6140066680908203, eval loss: [NA]
Epoch: 12, loss: 3.6397466552734374, eval loss: [NA]
Epoch: 13, loss: 3.614358364868164, eval loss: [NA]
Epoch: 14, loss: 3.5921226181030272, eval loss: [NA]
Epoch: 15, loss: 3.6129422439575194, eval loss: [NA]
Epoch: 16, loss: 3.570944760131836, eval loss: [NA]
Epoch: 17, loss: 3.5750740219116213, eval loss: [NA]
Epoch: 18, loss: 3.551938349914551, eval loss: [NA]
Epoch: 19, loss: 3.538638395690918, eval loss: [NA]
Epoch: 20, loss: 3.5900915710449217, eval loss: [NA]
Epoch: 21, loss: 3.5876072113037107, eval loss: [NA]
Epoch: 22, loss: 3.573397998046875, eval loss: [NA]
Epoch: 23, loss: 3.5488172607421875, eval loss: [NA]
Epoch: 24, loss: 3.566128010559082, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.096340880393982, eval loss: [NA]
Epoch: 1, loss: 7.074433903694153, eval loss: [NA]
Epoch: 2, loss: 7.081447985172272, eval loss: [NA]
Epoch: 3, loss: 7.067717046737671, eval loss: [NA]
Epoch: 4, loss: 7.050265936851502, eval loss: [NA]
Epoch: 5, loss: 7.095684459209442, eval loss: [NA]
Epoch: 6, loss: 7.112770416736603, eval loss: [NA]
Epoch: 7, loss: 7.110651414394379, eval loss: [NA]
Epoch: 8, loss: 7.058077480792999, eval loss: [NA]
Epoch: 9, loss: 7.072116634845734, eval loss: [NA]
Epoch: 10, loss: 7.058002257347107, eval loss: [NA]
Epoch: 11, loss: 7.117623009681702, eval loss: [NA]
Epoch: 12, loss: 7.093374290466309, eval loss: [NA]
Epoch: 13, loss: 7.087885627746582, eval loss: [NA]
Epoch: 14, loss: 7.050482349395752, eval loss: [NA]
Epoch: 15, loss: 7.0933798003196715, eval loss: [NA]
Epoch: 16, loss: 7.083776321411133, eval loss: [NA]
Epoch: 17, loss: 7.095611600875855, eval loss: [NA]
Epoch: 18, loss: 7.080096542835236, eval loss: [NA]
Epoch: 19, loss: 7.085538921356201, eval loss: [NA]
Epoch: 20, loss: 7.0853213763237, eval loss: [NA]
Epoch: 21, loss: 7.082230498790741, eval loss: [NA]
Epoch: 22, loss: 7.091501581668854, eval loss: [NA]
Epoch: 23, loss: 7.097631111145019, eval loss: [NA]
Epoch: 24, loss: 7.043807094097137, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.580106953430176, eval loss: [NA]
Epoch: 1, loss: 3.58530203704834, eval loss: [NA]
Epoch: 2, loss: 3.580615087890625, eval loss: [NA]
Epoch: 3, loss: 3.5659589126586915, eval loss: [NA]
Epoch: 4, loss: 3.5844147277832032, eval loss: [NA]
Epoch: 5, loss: 3.5424792877197264, eval loss: [NA]
Epoch: 6, loss: 3.5326587951660158, eval loss: [NA]
Epoch: 7, loss: 3.523218653869629, eval loss: [NA]
Epoch: 8, loss: 3.5328167999267577, eval loss: [NA]
Epoch: 9, loss: 3.548270378112793, eval loss: [NA]
Epoch: 10, loss: 3.5580675521850584, eval loss: [NA]
Epoch: 11, loss: 3.563875355529785, eval loss: [NA]
Epoch: 12, loss: 3.5705264709472657, eval loss: [NA]
Epoch: 13, loss: 3.566398628234863, eval loss: [NA]
Epoch: 14, loss: 3.5630748275756834, eval loss: [NA]
Epoch: 15, loss: 3.516090170288086, eval loss: [NA]
Epoch: 16, loss: 3.5432668182373046, eval loss: [NA]
Epoch: 17, loss: 3.4956404586791994, eval loss: [NA]
Epoch: 18, loss: 3.5292713348388673, eval loss: [NA]
Epoch: 19, loss: 3.5202644714355467, eval loss: [NA]
Epoch: 20, loss: 3.5168822845458982, eval loss: [NA]
Epoch: 21, loss: 3.4974475463867187, eval loss: [NA]
Epoch: 22, loss: 3.5141961791992187, eval loss: [NA]
Epoch: 23, loss: 3.4733302017211916, eval loss: [NA]
Epoch: 24, loss: 3.5202450546264648, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.797661783695221, eval loss: [NA]
Epoch: 1, loss: 6.786079807281494, eval loss: [NA]
Epoch: 2, loss: 6.811089143753052, eval loss: [NA]
Epoch: 3, loss: 6.791814548969269, eval loss: [NA]
Epoch: 4, loss: 6.795582389831543, eval loss: [NA]
Epoch: 5, loss: 6.79412618637085, eval loss: [NA]
Epoch: 6, loss: 6.811591923236847, eval loss: [NA]
Epoch: 7, loss: 6.791942894458771, eval loss: [NA]
Epoch: 8, loss: 6.807832245826721, eval loss: [NA]
Epoch: 9, loss: 6.780912733078003, eval loss: [NA]
Epoch: 10, loss: 6.811016416549682, eval loss: [NA]
Epoch: 11, loss: 6.805190303325653, eval loss: [NA]
Epoch: 12, loss: 6.803655669689179, eval loss: [NA]
Epoch: 13, loss: 6.808163855075836, eval loss: [NA]
Epoch: 14, loss: 6.8045236682891845, eval loss: [NA]
Epoch: 15, loss: 6.7662068414688115, eval loss: [NA]
Epoch: 16, loss: 6.782803497314453, eval loss: [NA]
Epoch: 17, loss: 6.791221692562103, eval loss: [NA]
Epoch: 18, loss: 6.805590217113495, eval loss: [NA]
Epoch: 19, loss: 6.812899742126465, eval loss: [NA]
Epoch: 20, loss: 6.773434097766876, eval loss: [NA]
Epoch: 21, loss: 6.775875828266144, eval loss: [NA]
Epoch: 22, loss: 6.78884022474289, eval loss: [NA]
Epoch: 23, loss: 6.779460611343384, eval loss: [NA]
Epoch: 24, loss: 6.8052572965621945, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.556619798278809, eval loss: [NA]
Epoch: 1, loss: 3.547740870666504, eval loss: [NA]
Epoch: 2, loss: 3.489213122558594, eval loss: [NA]
Epoch: 3, loss: 3.5258225982666014, eval loss: [NA]
Epoch: 4, loss: 3.5042389068603517, eval loss: [NA]
Epoch: 5, loss: 3.5017568893432616, eval loss: [NA]
Epoch: 6, loss: 3.508470819091797, eval loss: [NA]
Epoch: 7, loss: 3.5142936859130858, eval loss: [NA]
Epoch: 8, loss: 3.525763835144043, eval loss: [NA]
Epoch: 9, loss: 3.534015899658203, eval loss: [NA]
Epoch: 10, loss: 3.536753091430664, eval loss: [NA]
Epoch: 11, loss: 3.5372482833862304, eval loss: [NA]
Epoch: 12, loss: 3.4808771133422853, eval loss: [NA]
Epoch: 13, loss: 3.4963206619262697, eval loss: [NA]
Epoch: 14, loss: 3.513743940734863, eval loss: [NA]
Epoch: 15, loss: 3.5118690216064454, eval loss: [NA]
Epoch: 16, loss: 3.52428175201416, eval loss: [NA]
Epoch: 17, loss: 3.5375755920410157, eval loss: [NA]
Epoch: 18, loss: 3.5279622192382813, eval loss: [NA]
Epoch: 19, loss: 3.511984930419922, eval loss: [NA]
Epoch: 20, loss: 3.5079548904418947, eval loss: [NA]
Epoch: 21, loss: 3.5355815505981445, eval loss: [NA]
Epoch: 22, loss: 3.5056312591552734, eval loss: [NA]
Epoch: 23, loss: 3.4728716232299806, eval loss: [NA]
Epoch: 24, loss: 3.4795143203735353, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.024580445289612, eval loss: [NA]
Epoch: 1, loss: 7.0811755967140195, eval loss: [NA]
Epoch: 2, loss: 7.045483775138855, eval loss: [NA]
Epoch: 3, loss: 7.049735333919525, eval loss: [NA]
Epoch: 4, loss: 7.04818761587143, eval loss: [NA]
Epoch: 5, loss: 7.051054286956787, eval loss: [NA]
Epoch: 6, loss: 7.0772685933113095, eval loss: [NA]
Epoch: 7, loss: 7.03791885137558, eval loss: [NA]
Epoch: 8, loss: 7.038373491764069, eval loss: [NA]
Epoch: 9, loss: 7.059345479011536, eval loss: [NA]
Epoch: 10, loss: 7.047945117950439, eval loss: [NA]
Epoch: 11, loss: 7.039158854484558, eval loss: [NA]
Epoch: 12, loss: 7.041415383815766, eval loss: [NA]
Epoch: 13, loss: 7.039301562309265, eval loss: [NA]
Epoch: 14, loss: 7.0399139523506165, eval loss: [NA]
Epoch: 15, loss: 7.059066207408905, eval loss: [NA]
Epoch: 16, loss: 7.061405973434448, eval loss: [NA]
Epoch: 17, loss: 7.052705042362213, eval loss: [NA]
Epoch: 18, loss: 7.0352321600914, eval loss: [NA]
Epoch: 19, loss: 7.0746037077903745, eval loss: [NA]
Epoch: 20, loss: 7.070349423885346, eval loss: [NA]
Epoch: 21, loss: 7.058528702259064, eval loss: [NA]
Epoch: 22, loss: 7.057344727516174, eval loss: [NA]
Epoch: 23, loss: 7.044982588291168, eval loss: [NA]
Epoch: 24, loss: 7.031677751541138, eval loss: [NA]

Runtime:416.12
[3.6584305591384745e+18, 0.5546, 0.1236, 0.1684]
[2.6148, 0.8131, 0.6893, 0.6677]
[2.1735, 0.8752, 0.7616, 0.7467]
tensor(0.7522, grad_fn=<MeanBackward0>)
tensor(0.6859, grad_fn=<MeanBackward0>)
tensor([-3.2832, -4.2105, -1.9262, -2.7993, -0.4106, -1.0794, -2.0529, -2.9047,
        -2.3989, -3.2447], grad_fn=<MeanBackward1>)
tensor([0.3287, 0.3547, 1.1635, 1.2293, 0.3194, 0.3244, 1.1638, 1.2962, 0.3215,
        0.3405], grad_fn=<StdBackward1>)
tensor([-3.1520, -4.4602, -3.0925, -3.8739, -0.0739, -1.2137, -1.3187, -2.1858,
        -2.2290, -3.3217])
KL div untrained: 3.5433021934751186e+18
KL div trained: 0.1442
