Input args:
Dim: 2
seed: 34
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1636, grad_fn=<MeanBackward0>)
tensor(2.4487, grad_fn=<MeanBackward0>)
tensor([ 7.8761e-02,  7.8270e-02,  1.1545e-01,  5.2704e-02,  4.0531e-05,
         1.8912e-01, -2.9372e-02,  2.5533e-02, -1.7693e-01, -2.5130e-01],
       grad_fn=<MeanBackward1>)
tensor([0.9663, 1.1019, 1.0750, 0.9174, 1.0087, 0.9789, 0.9105, 1.1324, 1.0852,
        0.9593], grad_fn=<StdBackward1>)
tensor([ 4.8537,  1.1178,  3.6198, -0.2370,  2.3276, -1.3037,  2.4439, -1.5010,
         4.6191,  1.1044])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.224175079345702, eval loss: [NA]
Epoch: 1, loss: 7.0743955047607425, eval loss: [NA]
Epoch: 2, loss: 7.004025927734375, eval loss: [NA]
Epoch: 3, loss: 6.921351034545898, eval loss: [NA]
Epoch: 4, loss: 6.869568243408203, eval loss: [NA]
Epoch: 5, loss: 6.858001748657227, eval loss: [NA]
Epoch: 6, loss: 6.861645779418946, eval loss: [NA]
Epoch: 7, loss: 6.841601864624024, eval loss: [NA]
Epoch: 8, loss: 6.811417779541015, eval loss: [NA]
Epoch: 9, loss: 6.686126525878906, eval loss: [NA]
Epoch: 10, loss: 6.491028598022461, eval loss: [NA]
Epoch: 11, loss: 6.0975655181884765, eval loss: [NA]
Epoch: 12, loss: 5.798963159179688, eval loss: [NA]
Epoch: 13, loss: 5.213785261535644, eval loss: [NA]
Epoch: 14, loss: 5.015389268493652, eval loss: [NA]
Epoch: 15, loss: 4.877078340148926, eval loss: [NA]
Epoch: 16, loss: 4.723959226989746, eval loss: [NA]
Epoch: 17, loss: 4.69408782196045, eval loss: [NA]
Epoch: 18, loss: 4.6624718856811525, eval loss: [NA]
Epoch: 19, loss: 4.639817230224609, eval loss: [NA]
Epoch: 20, loss: 4.595007717895508, eval loss: [NA]
Epoch: 21, loss: 4.619707514953613, eval loss: [NA]
Epoch: 22, loss: 4.596480114746094, eval loss: [NA]
Epoch: 23, loss: 4.598079713439941, eval loss: [NA]
Epoch: 24, loss: 4.573834672546386, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.07629612326622, eval loss: [NA]
Epoch: 1, loss: 0.9053903570771218, eval loss: [NA]
Epoch: 2, loss: 0.6752841478586197, eval loss: [NA]
Epoch: 3, loss: 0.5975502964109183, eval loss: [NA]
Epoch: 4, loss: 0.5322368970513344, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.969003736972809, eval loss: [NA]
Epoch: 1, loss: 7.910343785285949, eval loss: [NA]
Epoch: 2, loss: 7.941411051750183, eval loss: [NA]
Epoch: 3, loss: 7.947274234294891, eval loss: [NA]
Epoch: 4, loss: 7.91455349445343, eval loss: [NA]
Epoch: 5, loss: 7.902529408931732, eval loss: [NA]
Epoch: 6, loss: 7.925217661857605, eval loss: [NA]
Epoch: 7, loss: 7.901722209453583, eval loss: [NA]
Epoch: 8, loss: 7.939884324073791, eval loss: [NA]
Epoch: 9, loss: 7.925479397773743, eval loss: [NA]
Epoch: 10, loss: 7.925392048358917, eval loss: [NA]
Epoch: 11, loss: 7.917027583122254, eval loss: [NA]
Epoch: 12, loss: 7.900264086723328, eval loss: [NA]
Epoch: 13, loss: 7.9006668782234195, eval loss: [NA]
Epoch: 14, loss: 7.904737694263458, eval loss: [NA]
Epoch: 15, loss: 7.87554361820221, eval loss: [NA]
Epoch: 16, loss: 7.9306907153129576, eval loss: [NA]
Epoch: 17, loss: 7.88915855884552, eval loss: [NA]
Epoch: 18, loss: 7.895711045265198, eval loss: [NA]
Epoch: 19, loss: 7.927089626789093, eval loss: [NA]
Epoch: 20, loss: 7.905603919029236, eval loss: [NA]
Epoch: 21, loss: 7.908934862613678, eval loss: [NA]
Epoch: 22, loss: 7.885319108963013, eval loss: [NA]
Epoch: 23, loss: 7.920624542236328, eval loss: [NA]
Epoch: 24, loss: 7.9122237825393675, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.5898072784423825, eval loss: [NA]
Epoch: 1, loss: 4.563675721740722, eval loss: [NA]
Epoch: 2, loss: 4.560424949645996, eval loss: [NA]
Epoch: 3, loss: 4.575296453857422, eval loss: [NA]
Epoch: 4, loss: 4.56918585357666, eval loss: [NA]
Epoch: 5, loss: 4.534766191101074, eval loss: [NA]
Epoch: 6, loss: 4.512508670043945, eval loss: [NA]
Epoch: 7, loss: 4.516566110229492, eval loss: [NA]
Epoch: 8, loss: 4.525474868774414, eval loss: [NA]
Epoch: 9, loss: 4.514049229431152, eval loss: [NA]
Epoch: 10, loss: 4.536549264526367, eval loss: [NA]
Epoch: 11, loss: 4.53555853881836, eval loss: [NA]
Epoch: 12, loss: 4.542111639404297, eval loss: [NA]
Epoch: 13, loss: 4.521775070190429, eval loss: [NA]
Epoch: 14, loss: 4.515276264953613, eval loss: [NA]
Epoch: 15, loss: 4.492359634399414, eval loss: [NA]
Epoch: 16, loss: 4.462662097167969, eval loss: [NA]
Epoch: 17, loss: 4.1316579299926754, eval loss: [NA]
Epoch: 18, loss: 3.831001434326172, eval loss: [NA]
Epoch: 19, loss: 3.653493377685547, eval loss: [NA]
Epoch: 20, loss: 3.6455085556030276, eval loss: [NA]
Epoch: 21, loss: 3.6355037261962893, eval loss: [NA]
Epoch: 22, loss: 3.618726826477051, eval loss: [NA]
Epoch: 23, loss: 3.6238223907470704, eval loss: [NA]
Epoch: 24, loss: 3.58884266204834, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.140313138961792, eval loss: [NA]
Epoch: 1, loss: 7.13935617685318, eval loss: [NA]
Epoch: 2, loss: 7.130861868858338, eval loss: [NA]
Epoch: 3, loss: 7.139204111099243, eval loss: [NA]
Epoch: 4, loss: 7.1316172003746034, eval loss: [NA]
Epoch: 5, loss: 7.122892611026764, eval loss: [NA]
Epoch: 6, loss: 7.1284992265701295, eval loss: [NA]
Epoch: 7, loss: 7.127434539794922, eval loss: [NA]
Epoch: 8, loss: 7.1224367451667785, eval loss: [NA]
Epoch: 9, loss: 7.108359870910644, eval loss: [NA]
Epoch: 10, loss: 7.130049476623535, eval loss: [NA]
Epoch: 11, loss: 7.124811704158783, eval loss: [NA]
Epoch: 12, loss: 7.108290090560913, eval loss: [NA]
Epoch: 13, loss: 7.135163571834564, eval loss: [NA]
Epoch: 14, loss: 7.132783002853394, eval loss: [NA]
Epoch: 15, loss: 7.1230956339836125, eval loss: [NA]
Epoch: 16, loss: 7.082234902381897, eval loss: [NA]
Epoch: 17, loss: 7.122126820087433, eval loss: [NA]
Epoch: 18, loss: 7.106531345844269, eval loss: [NA]
Epoch: 19, loss: 7.123115465641022, eval loss: [NA]
Epoch: 20, loss: 7.096380097866058, eval loss: [NA]
Epoch: 21, loss: 7.111257379055023, eval loss: [NA]
Epoch: 22, loss: 7.125535202026367, eval loss: [NA]
Epoch: 23, loss: 7.138159756660461, eval loss: [NA]
Epoch: 24, loss: 7.116543695926667, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.648205618286133, eval loss: [NA]
Epoch: 1, loss: 3.5951246795654295, eval loss: [NA]
Epoch: 2, loss: 3.5688834579467774, eval loss: [NA]
Epoch: 3, loss: 3.5553534744262696, eval loss: [NA]
Epoch: 4, loss: 3.598024085998535, eval loss: [NA]
Epoch: 5, loss: 3.5517024810791016, eval loss: [NA]
Epoch: 6, loss: 3.556315678405762, eval loss: [NA]
Epoch: 7, loss: 3.572966627502441, eval loss: [NA]
Epoch: 8, loss: 3.5825511581420897, eval loss: [NA]
Epoch: 9, loss: 3.543136054992676, eval loss: [NA]
Epoch: 10, loss: 3.5664859268188476, eval loss: [NA]
Epoch: 11, loss: 3.516983898925781, eval loss: [NA]
Epoch: 12, loss: 3.5735590377807616, eval loss: [NA]
Epoch: 13, loss: 3.550102239990234, eval loss: [NA]
Epoch: 14, loss: 3.531607781982422, eval loss: [NA]
Epoch: 15, loss: 3.5462292068481447, eval loss: [NA]
Epoch: 16, loss: 3.542862924194336, eval loss: [NA]
Epoch: 17, loss: 3.5375845062255857, eval loss: [NA]
Epoch: 18, loss: 3.5569956954956057, eval loss: [NA]
Epoch: 19, loss: 3.5310634552001954, eval loss: [NA]
Epoch: 20, loss: 3.5704805892944336, eval loss: [NA]
Epoch: 21, loss: 3.5324777389526365, eval loss: [NA]
Epoch: 22, loss: 3.525153419494629, eval loss: [NA]
Epoch: 23, loss: 3.5282352096557617, eval loss: [NA]
Epoch: 24, loss: 3.5323290603637694, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.886949119567871, eval loss: [NA]
Epoch: 1, loss: 6.876912076473236, eval loss: [NA]
Epoch: 2, loss: 6.864270534515381, eval loss: [NA]
Epoch: 3, loss: 6.88248619556427, eval loss: [NA]
Epoch: 4, loss: 6.861206030845642, eval loss: [NA]
Epoch: 5, loss: 6.864321310520172, eval loss: [NA]
Epoch: 6, loss: 6.863432664871215, eval loss: [NA]
Epoch: 7, loss: 6.840238614082336, eval loss: [NA]
Epoch: 8, loss: 6.854200627803802, eval loss: [NA]
Epoch: 9, loss: 6.863744580745697, eval loss: [NA]
Epoch: 10, loss: 6.869856102466583, eval loss: [NA]
Epoch: 11, loss: 6.834999828338623, eval loss: [NA]
Epoch: 12, loss: 6.85817330121994, eval loss: [NA]
Epoch: 13, loss: 6.8483902764320375, eval loss: [NA]
Epoch: 14, loss: 6.86291412115097, eval loss: [NA]
Epoch: 15, loss: 6.864729552268982, eval loss: [NA]
Epoch: 16, loss: 6.840387847423553, eval loss: [NA]
Epoch: 17, loss: 6.864451715946197, eval loss: [NA]
Epoch: 18, loss: 6.850199873447418, eval loss: [NA]
Epoch: 19, loss: 6.847497656345367, eval loss: [NA]
Epoch: 20, loss: 6.843428347110748, eval loss: [NA]
Epoch: 21, loss: 6.85219645023346, eval loss: [NA]
Epoch: 22, loss: 6.868584938049317, eval loss: [NA]
Epoch: 23, loss: 6.83679366350174, eval loss: [NA]
Epoch: 24, loss: 6.870766749382019, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.5404425506591797, eval loss: [NA]
Epoch: 1, loss: 3.490687860107422, eval loss: [NA]
Epoch: 2, loss: 3.512577722167969, eval loss: [NA]
Epoch: 3, loss: 3.51074627532959, eval loss: [NA]
Epoch: 4, loss: 3.470635063171387, eval loss: [NA]
Epoch: 5, loss: 3.4825796966552733, eval loss: [NA]
Epoch: 6, loss: 3.471906140136719, eval loss: [NA]
Epoch: 7, loss: 3.4763987701416017, eval loss: [NA]
Epoch: 8, loss: 3.4665180755615235, eval loss: [NA]
Epoch: 9, loss: 3.4606018981933593, eval loss: [NA]
Epoch: 10, loss: 3.4670710403442384, eval loss: [NA]
Epoch: 11, loss: 3.468329054260254, eval loss: [NA]
Epoch: 12, loss: 3.498137892150879, eval loss: [NA]
Epoch: 13, loss: 3.476451676940918, eval loss: [NA]
Epoch: 14, loss: 3.474965235900879, eval loss: [NA]
Epoch: 15, loss: 3.4550516525268553, eval loss: [NA]
Epoch: 16, loss: 3.4783403350830078, eval loss: [NA]
Epoch: 17, loss: 3.4897630630493164, eval loss: [NA]
Epoch: 18, loss: 3.487919645690918, eval loss: [NA]
Epoch: 19, loss: 3.4426990020751953, eval loss: [NA]
Epoch: 20, loss: 3.4663104934692384, eval loss: [NA]
Epoch: 21, loss: 3.4465741882324217, eval loss: [NA]
Epoch: 22, loss: 3.496667254638672, eval loss: [NA]
Epoch: 23, loss: 3.4458316329956054, eval loss: [NA]
Epoch: 24, loss: 3.4779240158081053, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.809579167366028, eval loss: [NA]
Epoch: 1, loss: 6.807924475669861, eval loss: [NA]
Epoch: 2, loss: 6.76820835351944, eval loss: [NA]
Epoch: 3, loss: 6.777801485061645, eval loss: [NA]
Epoch: 4, loss: 6.792249920368195, eval loss: [NA]
Epoch: 5, loss: 6.767385559082031, eval loss: [NA]
Epoch: 6, loss: 6.813015954494476, eval loss: [NA]
Epoch: 7, loss: 6.788432240486145, eval loss: [NA]
Epoch: 8, loss: 6.76515084028244, eval loss: [NA]
Epoch: 9, loss: 6.789943640232086, eval loss: [NA]
Epoch: 10, loss: 6.791254777908325, eval loss: [NA]
Epoch: 11, loss: 6.789148287773132, eval loss: [NA]
Epoch: 12, loss: 6.7730038189888, eval loss: [NA]
Epoch: 13, loss: 6.795982182025909, eval loss: [NA]
Epoch: 14, loss: 6.792880911827087, eval loss: [NA]
Epoch: 15, loss: 6.781342833042145, eval loss: [NA]
Epoch: 16, loss: 6.773507163524628, eval loss: [NA]
Epoch: 17, loss: 6.780538332462311, eval loss: [NA]
Epoch: 18, loss: 6.764393792152405, eval loss: [NA]
Epoch: 19, loss: 6.802363314628601, eval loss: [NA]
Epoch: 20, loss: 6.793907322883606, eval loss: [NA]
Epoch: 21, loss: 6.779788589477539, eval loss: [NA]
Epoch: 22, loss: 6.77993420124054, eval loss: [NA]
Epoch: 23, loss: 6.775208230018616, eval loss: [NA]
Epoch: 24, loss: 6.785250563621521, eval loss: [NA]

Runtime:419.19
[1.4853951993683044e+18, 0.537, 0.1706, 0.1227]
[2.4487, 0.8467, 0.7468, 0.735]
[2.1636, 0.8706, 0.7398, 0.7386]
tensor(0.7347, grad_fn=<MeanBackward0>)
tensor(0.7483, grad_fn=<MeanBackward0>)
tensor([ 4.7880,  1.1639,  3.5659, -0.1534,  2.3958, -1.4331,  3.1130, -0.6782,
         3.0335, -0.6157], grad_fn=<MeanBackward1>)
tensor([0.3300, 0.3356, 0.3288, 0.3293, 0.3162, 0.3246, 1.2331, 1.2984, 1.1984,
        1.2554], grad_fn=<StdBackward1>)
tensor([ 4.8537,  1.1178,  3.6198, -0.2370,  2.3276, -1.3037,  2.4439, -1.5010,
         4.6191,  1.1044])
KL div untrained: 2.01223065008448e+18
KL div trained: 0.1262
