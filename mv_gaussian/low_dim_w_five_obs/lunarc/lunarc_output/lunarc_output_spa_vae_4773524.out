Input args:
Dim: 2
seed: 50
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1839, grad_fn=<MeanBackward0>)
tensor(1.7575, grad_fn=<MeanBackward0>)
tensor([-0.1730, -0.1394,  0.2408,  0.1377, -0.1262,  0.1650,  0.0958, -0.1280,
         0.0826,  0.1076], grad_fn=<MeanBackward1>)
tensor([0.9199, 0.9506, 1.0269, 1.1128, 1.0666, 0.9632, 0.8996, 1.0268, 0.9777,
        1.0698], grad_fn=<StdBackward1>)
tensor([ 1.5787,  0.1190,  1.4720,  0.6117,  0.8496, -1.6227,  3.2775,  1.8733,
        -1.1824, -3.0312])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.640556741333008, eval loss: [NA]
Epoch: 1, loss: 7.046288604736328, eval loss: [NA]
Epoch: 2, loss: 6.951956161499023, eval loss: [NA]
Epoch: 3, loss: 6.886775607299804, eval loss: [NA]
Epoch: 4, loss: 6.862547869873047, eval loss: [NA]
Epoch: 5, loss: 6.776475012207031, eval loss: [NA]
Epoch: 6, loss: 6.644998770141601, eval loss: [NA]
Epoch: 7, loss: 6.486102973937988, eval loss: [NA]
Epoch: 8, loss: 5.9062293395996095, eval loss: [NA]
Epoch: 9, loss: 5.232401992797851, eval loss: [NA]
Epoch: 10, loss: 5.053286190795898, eval loss: [NA]
Epoch: 11, loss: 4.950379440307617, eval loss: [NA]
Epoch: 12, loss: 4.926659225463867, eval loss: [NA]
Epoch: 13, loss: 4.907581327819824, eval loss: [NA]
Epoch: 14, loss: 4.8524519668579105, eval loss: [NA]
Epoch: 15, loss: 4.863181187438965, eval loss: [NA]
Epoch: 16, loss: 4.791867405700684, eval loss: [NA]
Epoch: 17, loss: 4.80476388092041, eval loss: [NA]
Epoch: 18, loss: 4.811557417297363, eval loss: [NA]
Epoch: 19, loss: 4.783520845031738, eval loss: [NA]
Epoch: 20, loss: 4.809467855834961, eval loss: [NA]
Epoch: 21, loss: 4.766854998779297, eval loss: [NA]
Epoch: 22, loss: 4.752358044433594, eval loss: [NA]
Epoch: 23, loss: 4.684145831298828, eval loss: [NA]
Epoch: 24, loss: 4.665360903930664, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.1770980396866797, eval loss: [NA]
Epoch: 1, loss: 0.8871971265971661, eval loss: [NA]
Epoch: 2, loss: 0.6751347038149834, eval loss: [NA]
Epoch: 3, loss: 0.6020733632147313, eval loss: [NA]
Epoch: 4, loss: 0.6054410973936319, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.290003995895386, eval loss: [NA]
Epoch: 1, loss: 10.235519876480103, eval loss: [NA]
Epoch: 2, loss: 10.273837466239929, eval loss: [NA]
Epoch: 3, loss: 10.26764630794525, eval loss: [NA]
Epoch: 4, loss: 10.253639373779297, eval loss: [NA]
Epoch: 5, loss: 10.251576685905457, eval loss: [NA]
Epoch: 6, loss: 10.250983219146729, eval loss: [NA]
Epoch: 7, loss: 10.26139727115631, eval loss: [NA]
Epoch: 8, loss: 10.250978808403016, eval loss: [NA]
Epoch: 9, loss: 10.258596787452698, eval loss: [NA]
Epoch: 10, loss: 10.238940396308898, eval loss: [NA]
Epoch: 11, loss: 10.237330265045166, eval loss: [NA]
Epoch: 12, loss: 10.240939626693725, eval loss: [NA]
Epoch: 13, loss: 10.26258273601532, eval loss: [NA]
Epoch: 14, loss: 10.238828186988831, eval loss: [NA]
Epoch: 15, loss: 10.25087061882019, eval loss: [NA]
Epoch: 16, loss: 10.266195163726806, eval loss: [NA]
Epoch: 17, loss: 10.278603439331055, eval loss: [NA]
Epoch: 18, loss: 10.262975392341614, eval loss: [NA]
Epoch: 19, loss: 10.230756282806396, eval loss: [NA]
Epoch: 20, loss: 10.277971138954163, eval loss: [NA]
Epoch: 21, loss: 10.263695416450501, eval loss: [NA]
Epoch: 22, loss: 10.255436806678771, eval loss: [NA]
Epoch: 23, loss: 10.234936151504517, eval loss: [NA]
Epoch: 24, loss: 10.258017592430114, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.624703652954102, eval loss: [NA]
Epoch: 1, loss: 4.61588697052002, eval loss: [NA]
Epoch: 2, loss: 4.561023959350586, eval loss: [NA]
Epoch: 3, loss: 4.550995486450195, eval loss: [NA]
Epoch: 4, loss: 4.51812897644043, eval loss: [NA]
Epoch: 5, loss: 4.521539825439453, eval loss: [NA]
Epoch: 6, loss: 4.496545616149902, eval loss: [NA]
Epoch: 7, loss: 4.509246057128906, eval loss: [NA]
Epoch: 8, loss: 4.464043844604492, eval loss: [NA]
Epoch: 9, loss: 4.045851188659668, eval loss: [NA]
Epoch: 10, loss: 3.7970081573486327, eval loss: [NA]
Epoch: 11, loss: 3.7274095306396484, eval loss: [NA]
Epoch: 12, loss: 3.6764492141723633, eval loss: [NA]
Epoch: 13, loss: 3.6055745941162107, eval loss: [NA]
Epoch: 14, loss: 3.597188949584961, eval loss: [NA]
Epoch: 15, loss: 3.6140782928466795, eval loss: [NA]
Epoch: 16, loss: 3.5880407485961916, eval loss: [NA]
Epoch: 17, loss: 3.61463450012207, eval loss: [NA]
Epoch: 18, loss: 3.540103678894043, eval loss: [NA]
Epoch: 19, loss: 3.5797237045288086, eval loss: [NA]
Epoch: 20, loss: 3.5835030654907225, eval loss: [NA]
Epoch: 21, loss: 3.555258757019043, eval loss: [NA]
Epoch: 22, loss: 3.5919090728759766, eval loss: [NA]
Epoch: 23, loss: 3.542658935546875, eval loss: [NA]
Epoch: 24, loss: 3.5381819259643557, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.187789549827576, eval loss: [NA]
Epoch: 1, loss: 10.172910690307617, eval loss: [NA]
Epoch: 2, loss: 10.190793423652648, eval loss: [NA]
Epoch: 3, loss: 10.182462482452392, eval loss: [NA]
Epoch: 4, loss: 10.199143295288087, eval loss: [NA]
Epoch: 5, loss: 10.191719975471496, eval loss: [NA]
Epoch: 6, loss: 10.19356794834137, eval loss: [NA]
Epoch: 7, loss: 10.15719651699066, eval loss: [NA]
Epoch: 8, loss: 10.18135483264923, eval loss: [NA]
Epoch: 9, loss: 10.155915608406067, eval loss: [NA]
Epoch: 10, loss: 10.188440475463867, eval loss: [NA]
Epoch: 11, loss: 10.18420974254608, eval loss: [NA]
Epoch: 12, loss: 10.162196187973022, eval loss: [NA]
Epoch: 13, loss: 10.170259985923767, eval loss: [NA]
Epoch: 14, loss: 10.181566758155823, eval loss: [NA]
Epoch: 15, loss: 10.198943667411804, eval loss: [NA]
Epoch: 16, loss: 10.196881623268128, eval loss: [NA]
Epoch: 17, loss: 10.168902468681335, eval loss: [NA]
Epoch: 18, loss: 10.186238436698913, eval loss: [NA]
Epoch: 19, loss: 10.170649032592774, eval loss: [NA]
Epoch: 20, loss: 10.198524675369264, eval loss: [NA]
Epoch: 21, loss: 10.175416560173035, eval loss: [NA]
Epoch: 22, loss: 10.164618453979493, eval loss: [NA]
Epoch: 23, loss: 10.145533266067504, eval loss: [NA]
Epoch: 24, loss: 10.173538932800293, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.579683834838867, eval loss: [NA]
Epoch: 1, loss: 3.5848525207519533, eval loss: [NA]
Epoch: 2, loss: 3.5492300262451173, eval loss: [NA]
Epoch: 3, loss: 3.5797139663696287, eval loss: [NA]
Epoch: 4, loss: 3.5856117126464846, eval loss: [NA]
Epoch: 5, loss: 3.5248858337402345, eval loss: [NA]
Epoch: 6, loss: 3.555048587036133, eval loss: [NA]
Epoch: 7, loss: 3.5216053115844725, eval loss: [NA]
Epoch: 8, loss: 3.537372262573242, eval loss: [NA]
Epoch: 9, loss: 3.5416215713500976, eval loss: [NA]
Epoch: 10, loss: 3.580954998779297, eval loss: [NA]
Epoch: 11, loss: 3.548313215637207, eval loss: [NA]
Epoch: 12, loss: 3.5626512786865234, eval loss: [NA]
Epoch: 13, loss: 3.5522596603393555, eval loss: [NA]
Epoch: 14, loss: 3.5609366516113283, eval loss: [NA]
Epoch: 15, loss: 3.5382043273925783, eval loss: [NA]
Epoch: 16, loss: 3.5473380905151366, eval loss: [NA]
Epoch: 17, loss: 3.545092872619629, eval loss: [NA]
Epoch: 18, loss: 3.5299353744506834, eval loss: [NA]
Epoch: 19, loss: 3.535889810180664, eval loss: [NA]
Epoch: 20, loss: 3.517329377746582, eval loss: [NA]
Epoch: 21, loss: 3.563404264831543, eval loss: [NA]
Epoch: 22, loss: 3.5044039672851564, eval loss: [NA]
Epoch: 23, loss: 3.522484846496582, eval loss: [NA]
Epoch: 24, loss: 3.526870169067383, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.711733484268189, eval loss: [NA]
Epoch: 1, loss: 10.713800473213196, eval loss: [NA]
Epoch: 2, loss: 10.739435029029845, eval loss: [NA]
Epoch: 3, loss: 10.73232069015503, eval loss: [NA]
Epoch: 4, loss: 10.728497838973999, eval loss: [NA]
Epoch: 5, loss: 10.742829613685608, eval loss: [NA]
Epoch: 6, loss: 10.738677024841309, eval loss: [NA]
Epoch: 7, loss: 10.732230186462402, eval loss: [NA]
Epoch: 8, loss: 10.705684275627137, eval loss: [NA]
Epoch: 9, loss: 10.752006406784057, eval loss: [NA]
Epoch: 10, loss: 10.726208033561706, eval loss: [NA]
Epoch: 11, loss: 10.712002420425415, eval loss: [NA]
Epoch: 12, loss: 10.700475053787232, eval loss: [NA]
Epoch: 13, loss: 10.715529026985168, eval loss: [NA]
Epoch: 14, loss: 10.712331566810608, eval loss: [NA]
Epoch: 15, loss: 10.710639662742615, eval loss: [NA]
Epoch: 16, loss: 10.733463630676269, eval loss: [NA]
Epoch: 17, loss: 10.722513952255248, eval loss: [NA]
Epoch: 18, loss: 10.721393785476685, eval loss: [NA]
Epoch: 19, loss: 10.735585141181947, eval loss: [NA]
Epoch: 20, loss: 10.726768922805785, eval loss: [NA]
Epoch: 21, loss: 10.745285696983338, eval loss: [NA]
Epoch: 22, loss: 10.73210970878601, eval loss: [NA]
Epoch: 23, loss: 10.736742424964905, eval loss: [NA]
Epoch: 24, loss: 10.704830145835876, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4934420669555664, eval loss: [NA]
Epoch: 1, loss: 3.475373083496094, eval loss: [NA]
Epoch: 2, loss: 3.50288458404541, eval loss: [NA]
Epoch: 3, loss: 3.458480847167969, eval loss: [NA]
Epoch: 4, loss: 3.493038360595703, eval loss: [NA]
Epoch: 5, loss: 3.4737652389526366, eval loss: [NA]
Epoch: 6, loss: 3.5376591873168945, eval loss: [NA]
Epoch: 7, loss: 3.4814230850219725, eval loss: [NA]
Epoch: 8, loss: 3.452558792114258, eval loss: [NA]
Epoch: 9, loss: 3.452954943847656, eval loss: [NA]
Epoch: 10, loss: 3.4879462707519533, eval loss: [NA]
Epoch: 11, loss: 3.444928935241699, eval loss: [NA]
Epoch: 12, loss: 3.453195639038086, eval loss: [NA]
Epoch: 13, loss: 3.4890125717163087, eval loss: [NA]
Epoch: 14, loss: 3.4732076644897463, eval loss: [NA]
Epoch: 15, loss: 3.44414114074707, eval loss: [NA]
Epoch: 16, loss: 3.478763917541504, eval loss: [NA]
Epoch: 17, loss: 3.4833144134521485, eval loss: [NA]
Epoch: 18, loss: 3.468796714782715, eval loss: [NA]
Epoch: 19, loss: 3.463315849304199, eval loss: [NA]
Epoch: 20, loss: 3.4591927108764646, eval loss: [NA]
Epoch: 21, loss: 3.4452733840942384, eval loss: [NA]
Epoch: 22, loss: 3.420541000366211, eval loss: [NA]
Epoch: 23, loss: 3.4533229064941406, eval loss: [NA]
Epoch: 24, loss: 3.4349191635131837, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 10.61904082775116, eval loss: [NA]
Epoch: 1, loss: 10.624838457107543, eval loss: [NA]
Epoch: 2, loss: 10.622134823799133, eval loss: [NA]
Epoch: 3, loss: 10.626591138839721, eval loss: [NA]
Epoch: 4, loss: 10.614866757392884, eval loss: [NA]
Epoch: 5, loss: 10.630432987213135, eval loss: [NA]
Epoch: 6, loss: 10.620784983634948, eval loss: [NA]
Epoch: 7, loss: 10.629720940589905, eval loss: [NA]
Epoch: 8, loss: 10.611422233581543, eval loss: [NA]
Epoch: 9, loss: 10.623381700515747, eval loss: [NA]
Epoch: 10, loss: 10.615448188781738, eval loss: [NA]
Epoch: 11, loss: 10.638692150115967, eval loss: [NA]
Epoch: 12, loss: 10.61946720123291, eval loss: [NA]
Epoch: 13, loss: 10.612873411178589, eval loss: [NA]
Epoch: 14, loss: 10.645469660758971, eval loss: [NA]
Epoch: 15, loss: 10.612862753868104, eval loss: [NA]
Epoch: 16, loss: 10.63459409236908, eval loss: [NA]
Epoch: 17, loss: 10.625267086029053, eval loss: [NA]
Epoch: 18, loss: 10.646302042007447, eval loss: [NA]
Epoch: 19, loss: 10.643803586959839, eval loss: [NA]
Epoch: 20, loss: 10.633749146461486, eval loss: [NA]
Epoch: 21, loss: 10.598646593093871, eval loss: [NA]
Epoch: 22, loss: 10.633167304992675, eval loss: [NA]
Epoch: 23, loss: 10.619820742607116, eval loss: [NA]
Epoch: 24, loss: 10.640953941345215, eval loss: [NA]

Runtime:433.02
[6010976331335760.0, 0.495, 0.1624, 0.1949]
[1.7575, 0.9559, 0.9345, 0.9336]
[2.1839, 0.909, 0.7537, 0.7674]
tensor(0.7502, grad_fn=<MeanBackward0>)
tensor(0.9280, grad_fn=<MeanBackward0>)
tensor([ 1.5188,  0.1213,  1.0336, -0.3085,  0.3030, -1.1246,  0.9865, -0.3836,
        -1.2999, -2.8551], grad_fn=<MeanBackward1>)
tensor([0.3320, 0.3461, 1.3275, 1.3936, 0.3306, 0.3464, 1.1322, 1.2360, 0.3067,
        0.3546], grad_fn=<StdBackward1>)
tensor([ 1.5787,  0.1190,  1.4720,  0.6117,  0.8496, -1.6227,  3.2775,  1.8733,
        -1.1824, -3.0312])
KL div untrained: 5944699405241189.0
KL div trained: 0.2428
