Input args:
Dim: 2
seed: 22
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.2395, grad_fn=<MeanBackward0>)
tensor(2.1368, grad_fn=<MeanBackward0>)
tensor([ 0.0700,  0.0296,  0.0308,  0.0478, -0.0134,  0.1535,  0.1438,  0.0546,
         0.1333, -0.0538], grad_fn=<MeanBackward1>)
tensor([0.9492, 1.0084, 1.0598, 0.9378, 0.9721, 1.0114, 1.0179, 1.0821, 1.0074,
        1.0482], grad_fn=<StdBackward1>)
tensor([ 3.5166, -0.0742,  2.1839, -0.7584, -1.3162, -5.1352,  3.1561, -0.1696,
         0.4669, -2.5383])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.230349453735352, eval loss: [NA]
Epoch: 1, loss: 7.118314492797851, eval loss: [NA]
Epoch: 2, loss: 7.035831753540039, eval loss: [NA]
Epoch: 3, loss: 6.976353982543945, eval loss: [NA]
Epoch: 4, loss: 6.97244345703125, eval loss: [NA]
Epoch: 5, loss: 6.922836514282227, eval loss: [NA]
Epoch: 6, loss: 6.879647409057617, eval loss: [NA]
Epoch: 7, loss: 6.86349401550293, eval loss: [NA]
Epoch: 8, loss: 6.723735791015625, eval loss: [NA]
Epoch: 9, loss: 6.454995779418946, eval loss: [NA]
Epoch: 10, loss: 6.094760922241211, eval loss: [NA]
Epoch: 11, loss: 5.9571078033447264, eval loss: [NA]
Epoch: 12, loss: 5.88844256439209, eval loss: [NA]
Epoch: 13, loss: 5.823523097229004, eval loss: [NA]
Epoch: 14, loss: 5.786136508178711, eval loss: [NA]
Epoch: 15, loss: 5.771050271606446, eval loss: [NA]
Epoch: 16, loss: 5.773457696533203, eval loss: [NA]
Epoch: 17, loss: 5.7625406494140625, eval loss: [NA]
Epoch: 18, loss: 5.733901261901855, eval loss: [NA]
Epoch: 19, loss: 5.720264506530762, eval loss: [NA]
Epoch: 20, loss: 5.748825964355468, eval loss: [NA]
Epoch: 21, loss: 5.7234259033203125, eval loss: [NA]
Epoch: 22, loss: 5.726673146057129, eval loss: [NA]
Epoch: 23, loss: 5.7435560913085935, eval loss: [NA]
Epoch: 24, loss: 5.723696966552734, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.0740394738316534, eval loss: [NA]
Epoch: 1, loss: 0.8565189793705941, eval loss: [NA]
Epoch: 2, loss: 0.6879993487894535, eval loss: [NA]
Epoch: 3, loss: 0.5857956758886576, eval loss: [NA]
Epoch: 4, loss: 0.5713801494985818, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 18.413757524490357, eval loss: [NA]
Epoch: 1, loss: 18.36604500770569, eval loss: [NA]
Epoch: 2, loss: 18.383473892211914, eval loss: [NA]
Epoch: 3, loss: 18.387290325164795, eval loss: [NA]
Epoch: 4, loss: 18.394079608917238, eval loss: [NA]
Epoch: 5, loss: 18.375947008132936, eval loss: [NA]
Epoch: 6, loss: 18.390659036636354, eval loss: [NA]
Epoch: 7, loss: 18.37147753715515, eval loss: [NA]
Epoch: 8, loss: 18.373624687194823, eval loss: [NA]
Epoch: 9, loss: 18.37297739982605, eval loss: [NA]
Epoch: 10, loss: 18.377976522445678, eval loss: [NA]
Epoch: 11, loss: 18.387858333587648, eval loss: [NA]
Epoch: 12, loss: 18.37392204284668, eval loss: [NA]
Epoch: 13, loss: 18.366736898422243, eval loss: [NA]
Epoch: 14, loss: 18.377969675064087, eval loss: [NA]
Epoch: 15, loss: 18.34893656730652, eval loss: [NA]
Epoch: 16, loss: 18.378245449066164, eval loss: [NA]
Epoch: 17, loss: 18.358737449645997, eval loss: [NA]
Epoch: 18, loss: 18.378450050354004, eval loss: [NA]
Epoch: 19, loss: 18.375161323547363, eval loss: [NA]
Epoch: 20, loss: 18.350409193038942, eval loss: [NA]
Epoch: 21, loss: 18.36629608154297, eval loss: [NA]
Epoch: 22, loss: 18.357492141723633, eval loss: [NA]
Epoch: 23, loss: 18.370253982543947, eval loss: [NA]
Epoch: 24, loss: 18.343000440597535, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.693055047607422, eval loss: [NA]
Epoch: 1, loss: 5.667835382080078, eval loss: [NA]
Epoch: 2, loss: 5.695197831726074, eval loss: [NA]
Epoch: 3, loss: 5.680520431518555, eval loss: [NA]
Epoch: 4, loss: 5.667047276306152, eval loss: [NA]
Epoch: 5, loss: 5.6714946640014645, eval loss: [NA]
Epoch: 6, loss: 5.6889499725341794, eval loss: [NA]
Epoch: 7, loss: 5.645271655273437, eval loss: [NA]
Epoch: 8, loss: 5.654689723205567, eval loss: [NA]
Epoch: 9, loss: 5.690598086547851, eval loss: [NA]
Epoch: 10, loss: 5.6551299560546875, eval loss: [NA]
Epoch: 11, loss: 5.679374751281738, eval loss: [NA]
Epoch: 12, loss: 5.67295291595459, eval loss: [NA]
Epoch: 13, loss: 5.677380812072754, eval loss: [NA]
Epoch: 14, loss: 5.68611614074707, eval loss: [NA]
Epoch: 15, loss: 5.648469674682617, eval loss: [NA]
Epoch: 16, loss: 5.649399861145019, eval loss: [NA]
Epoch: 17, loss: 5.670758573913575, eval loss: [NA]
Epoch: 18, loss: 5.675281341552735, eval loss: [NA]
Epoch: 19, loss: 5.662868402099609, eval loss: [NA]
Epoch: 20, loss: 5.666470880126953, eval loss: [NA]
Epoch: 21, loss: 5.654739935302734, eval loss: [NA]
Epoch: 22, loss: 5.6591151977539065, eval loss: [NA]
Epoch: 23, loss: 5.661707162475586, eval loss: [NA]
Epoch: 24, loss: 5.652049003601074, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 18.360636615753172, eval loss: [NA]
Epoch: 1, loss: 18.360501708984376, eval loss: [NA]
Epoch: 2, loss: 18.360640821456908, eval loss: [NA]
Epoch: 3, loss: 18.349199714660646, eval loss: [NA]
Epoch: 4, loss: 18.348558368682863, eval loss: [NA]
Epoch: 5, loss: 18.36327925682068, eval loss: [NA]
Epoch: 6, loss: 18.35182618141174, eval loss: [NA]
Epoch: 7, loss: 18.370921201705933, eval loss: [NA]
Epoch: 8, loss: 18.35996823310852, eval loss: [NA]
Epoch: 9, loss: 18.3700267124176, eval loss: [NA]
Epoch: 10, loss: 18.361341438293458, eval loss: [NA]
Epoch: 11, loss: 18.34998002052307, eval loss: [NA]
Epoch: 12, loss: 18.340661373138428, eval loss: [NA]
Epoch: 13, loss: 18.389573211669923, eval loss: [NA]
Epoch: 14, loss: 18.365151510238647, eval loss: [NA]
Epoch: 15, loss: 18.35252766609192, eval loss: [NA]
Epoch: 16, loss: 18.35212597846985, eval loss: [NA]
Epoch: 17, loss: 18.351627645492552, eval loss: [NA]
Epoch: 18, loss: 18.364502782821656, eval loss: [NA]
Epoch: 19, loss: 18.346389207839966, eval loss: [NA]
Epoch: 20, loss: 18.35068651199341, eval loss: [NA]
Epoch: 21, loss: 18.342994375228884, eval loss: [NA]
Epoch: 22, loss: 18.33280026435852, eval loss: [NA]
Epoch: 23, loss: 18.36014512062073, eval loss: [NA]
Epoch: 24, loss: 18.355628242492674, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 5.6952679748535155, eval loss: [NA]
Epoch: 1, loss: 5.680369183349609, eval loss: [NA]
Epoch: 2, loss: 5.72093598022461, eval loss: [NA]
Epoch: 3, loss: 5.702705448913574, eval loss: [NA]
Epoch: 4, loss: 5.678973287963867, eval loss: [NA]
Epoch: 5, loss: 5.686572309875488, eval loss: [NA]
Epoch: 6, loss: 5.679006484985352, eval loss: [NA]
Epoch: 7, loss: 5.692612092590332, eval loss: [NA]
Epoch: 8, loss: 5.671555833435058, eval loss: [NA]
Epoch: 9, loss: 5.6838724899291995, eval loss: [NA]
Epoch: 10, loss: 5.6765526748657225, eval loss: [NA]
Epoch: 11, loss: 5.694994895935059, eval loss: [NA]
Epoch: 12, loss: 5.670119537353516, eval loss: [NA]
Epoch: 13, loss: 5.674259034729004, eval loss: [NA]
Epoch: 14, loss: 5.678463752746582, eval loss: [NA]
Epoch: 15, loss: 5.671820782470703, eval loss: [NA]
Epoch: 16, loss: 5.674024908447266, eval loss: [NA]
Epoch: 17, loss: 5.668058882141113, eval loss: [NA]
Epoch: 18, loss: 5.68847924194336, eval loss: [NA]
Epoch: 19, loss: 5.6914308013916015, eval loss: [NA]
Epoch: 20, loss: 5.68056178741455, eval loss: [NA]
Epoch: 21, loss: 5.683007041931153, eval loss: [NA]
Epoch: 22, loss: 5.686743165588379, eval loss: [NA]
Epoch: 23, loss: 5.67459006652832, eval loss: [NA]
Epoch: 24, loss: 5.679486534118652, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 18.11346544265747, eval loss: [NA]
Epoch: 1, loss: 18.11429042816162, eval loss: [NA]
Epoch: 2, loss: 18.111251974105834, eval loss: [NA]
Epoch: 3, loss: 18.098094682693482, eval loss: [NA]
Epoch: 4, loss: 18.1074889087677, eval loss: [NA]
Epoch: 5, loss: 18.086614513397215, eval loss: [NA]
Epoch: 6, loss: 18.10390670776367, eval loss: [NA]
Epoch: 7, loss: 18.085299034118652, eval loss: [NA]
Epoch: 8, loss: 18.118941297531126, eval loss: [NA]
Epoch: 9, loss: 18.091112079620363, eval loss: [NA]
Epoch: 10, loss: 18.091758060455323, eval loss: [NA]
Epoch: 11, loss: 18.106956634521485, eval loss: [NA]
Epoch: 12, loss: 18.099932346343994, eval loss: [NA]
Epoch: 13, loss: 18.096953859329222, eval loss: [NA]
Epoch: 14, loss: 18.097226324081422, eval loss: [NA]
Epoch: 15, loss: 18.10383674621582, eval loss: [NA]
Epoch: 16, loss: 18.103771095275878, eval loss: [NA]
Epoch: 17, loss: 18.09568017959595, eval loss: [NA]
Epoch: 18, loss: 18.11666485786438, eval loss: [NA]
Epoch: 19, loss: 18.102505407333375, eval loss: [NA]
Epoch: 20, loss: 18.105967264175415, eval loss: [NA]
Epoch: 21, loss: 18.0975700378418, eval loss: [NA]
Epoch: 22, loss: 18.089209995269776, eval loss: [NA]
Epoch: 23, loss: 18.12960276603699, eval loss: [NA]
Epoch: 24, loss: 18.129128103256225, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 5.672926213073731, eval loss: [NA]
Epoch: 1, loss: 5.667264630126953, eval loss: [NA]
Epoch: 2, loss: 5.6111813827514645, eval loss: [NA]
Epoch: 3, loss: 5.125131019592285, eval loss: [NA]
Epoch: 4, loss: 4.7753841674804685, eval loss: [NA]
Epoch: 5, loss: 4.728307528686523, eval loss: [NA]
Epoch: 6, loss: 4.698254203796386, eval loss: [NA]
Epoch: 7, loss: 4.692537922668457, eval loss: [NA]
Epoch: 8, loss: 4.715613842773437, eval loss: [NA]
Epoch: 9, loss: 4.671271028137207, eval loss: [NA]
Epoch: 10, loss: 4.6500892715454105, eval loss: [NA]
Epoch: 11, loss: 4.6637654296875, eval loss: [NA]
Epoch: 12, loss: 4.687660479736328, eval loss: [NA]
Epoch: 13, loss: 4.65683299407959, eval loss: [NA]
Epoch: 14, loss: 4.659540849304199, eval loss: [NA]
Epoch: 15, loss: 4.631939012145996, eval loss: [NA]
Epoch: 16, loss: 4.655935298156738, eval loss: [NA]
Epoch: 17, loss: 4.6386222091674805, eval loss: [NA]
Epoch: 18, loss: 4.650978070068359, eval loss: [NA]
Epoch: 19, loss: 4.637132273864746, eval loss: [NA]
Epoch: 20, loss: 4.658010815429687, eval loss: [NA]
Epoch: 21, loss: 4.668983638000488, eval loss: [NA]
Epoch: 22, loss: 4.6454732116699216, eval loss: [NA]
Epoch: 23, loss: 4.649367512512207, eval loss: [NA]
Epoch: 24, loss: 4.635078804016113, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 12.441037487983703, eval loss: [NA]
Epoch: 1, loss: 12.39096043586731, eval loss: [NA]
Epoch: 2, loss: 12.39908794403076, eval loss: [NA]
Epoch: 3, loss: 12.392739019393922, eval loss: [NA]
Epoch: 4, loss: 12.399982590675354, eval loss: [NA]
Epoch: 5, loss: 12.402912211418151, eval loss: [NA]
Epoch: 6, loss: 12.387913408279418, eval loss: [NA]
Epoch: 7, loss: 12.403603463172912, eval loss: [NA]
Epoch: 8, loss: 12.393390445709228, eval loss: [NA]
Epoch: 9, loss: 12.398673076629638, eval loss: [NA]
Epoch: 10, loss: 12.411156101226807, eval loss: [NA]
Epoch: 11, loss: 12.40829749584198, eval loss: [NA]
Epoch: 12, loss: 12.403591666221619, eval loss: [NA]
Epoch: 13, loss: 12.399418892860412, eval loss: [NA]
Epoch: 14, loss: 12.39629168510437, eval loss: [NA]
Epoch: 15, loss: 12.38564329147339, eval loss: [NA]
Epoch: 16, loss: 12.40999641418457, eval loss: [NA]
Epoch: 17, loss: 12.394506359100342, eval loss: [NA]
Epoch: 18, loss: 12.404243583679198, eval loss: [NA]
Epoch: 19, loss: 12.407188515663147, eval loss: [NA]
Epoch: 20, loss: 12.378688197135926, eval loss: [NA]
Epoch: 21, loss: 12.390528755187988, eval loss: [NA]
Epoch: 22, loss: 12.395632376670838, eval loss: [NA]
Epoch: 23, loss: 12.397274022102357, eval loss: [NA]
Epoch: 24, loss: 12.410415115356445, eval loss: [NA]

Runtime:433.47
[1.3012509338196824e+17, 1.1556, 1.4615, 1.2114]
[2.1368, 1.5819, 1.592, 1.561]
[2.2395, 1.0934, 1.1068, 1.0871]
tensor(0.9782, grad_fn=<MeanBackward0>)
tensor(0.8847, grad_fn=<MeanBackward0>)
tensor([ 2.2625, -1.3944,  2.0563, -1.4537, -1.2613, -5.0592,  2.1751, -1.2862,
         0.7232, -2.7854], grad_fn=<MeanBackward1>)
tensor([1.1143, 1.2407, 1.1804, 1.1950, 0.3265, 0.3497, 1.2457, 1.3220, 0.3164,
        0.3267], grad_fn=<StdBackward1>)
tensor([ 3.5166, -0.0742,  2.1839, -0.7584, -1.3162, -5.1352,  3.1561, -0.1696,
         0.4669, -2.5383])
KL div untrained: 2.0411140994433043e+17
KL div trained: 0.457
