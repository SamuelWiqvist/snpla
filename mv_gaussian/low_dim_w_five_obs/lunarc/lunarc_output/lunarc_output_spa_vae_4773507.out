Input args:
Dim: 2
seed: 33
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1199, grad_fn=<MeanBackward0>)
tensor(2.1263, grad_fn=<MeanBackward0>)
tensor([-0.1318,  0.1155, -0.1452, -0.0367,  0.1437, -0.0890, -0.1145, -0.1357,
        -0.1654, -0.0502], grad_fn=<MeanBackward1>)
tensor([0.9208, 1.0997, 1.0462, 0.9803, 0.8415, 1.1053, 1.0081, 0.9982, 0.9053,
        1.1105], grad_fn=<StdBackward1>)
tensor([ 4.0900,  0.4088,  2.2699, -1.4159, -0.0398, -4.0895,  2.5841, -0.7083,
         1.3405, -2.4450])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.206892807006836, eval loss: [NA]
Epoch: 1, loss: 7.050602627563476, eval loss: [NA]
Epoch: 2, loss: 6.975741958618164, eval loss: [NA]
Epoch: 3, loss: 6.900867489624024, eval loss: [NA]
Epoch: 4, loss: 6.873244137573242, eval loss: [NA]
Epoch: 5, loss: 6.835052496337891, eval loss: [NA]
Epoch: 6, loss: 6.838574993896485, eval loss: [NA]
Epoch: 7, loss: 6.822360656738281, eval loss: [NA]
Epoch: 8, loss: 6.817914758300781, eval loss: [NA]
Epoch: 9, loss: 6.805032592773437, eval loss: [NA]
Epoch: 10, loss: 6.801479544067383, eval loss: [NA]
Epoch: 11, loss: 6.747517236328125, eval loss: [NA]
Epoch: 12, loss: 6.668529013061524, eval loss: [NA]
Epoch: 13, loss: 6.496319882202148, eval loss: [NA]
Epoch: 14, loss: 6.143281192016602, eval loss: [NA]
Epoch: 15, loss: 5.870033657836914, eval loss: [NA]
Epoch: 16, loss: 5.7804510711669925, eval loss: [NA]
Epoch: 17, loss: 5.730523167419434, eval loss: [NA]
Epoch: 18, loss: 5.751532678222656, eval loss: [NA]
Epoch: 19, loss: 5.682102380371094, eval loss: [NA]
Epoch: 20, loss: 5.678348704528808, eval loss: [NA]
Epoch: 21, loss: 5.693322212219238, eval loss: [NA]
Epoch: 22, loss: 5.670870060729981, eval loss: [NA]
Epoch: 23, loss: 5.65587156829834, eval loss: [NA]
Epoch: 24, loss: 5.657309654235839, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.0531509804725645, eval loss: [NA]
Epoch: 1, loss: 0.8510113935172557, eval loss: [NA]
Epoch: 2, loss: 0.680666189789772, eval loss: [NA]
Epoch: 3, loss: 0.5798878936469555, eval loss: [NA]
Epoch: 4, loss: 0.5535222778469324, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.170715312957764, eval loss: [NA]
Epoch: 1, loss: 11.139784750938416, eval loss: [NA]
Epoch: 2, loss: 11.18342369556427, eval loss: [NA]
Epoch: 3, loss: 11.11815161705017, eval loss: [NA]
Epoch: 4, loss: 11.114577178955079, eval loss: [NA]
Epoch: 5, loss: 11.140388836860657, eval loss: [NA]
Epoch: 6, loss: 11.118072838783265, eval loss: [NA]
Epoch: 7, loss: 11.119316673278808, eval loss: [NA]
Epoch: 8, loss: 11.11945405960083, eval loss: [NA]
Epoch: 9, loss: 11.131692147254943, eval loss: [NA]
Epoch: 10, loss: 11.110445642471314, eval loss: [NA]
Epoch: 11, loss: 11.133204946517944, eval loss: [NA]
Epoch: 12, loss: 11.116841468811035, eval loss: [NA]
Epoch: 13, loss: 11.118474678993225, eval loss: [NA]
Epoch: 14, loss: 11.10997688293457, eval loss: [NA]
Epoch: 15, loss: 11.104538531303406, eval loss: [NA]
Epoch: 16, loss: 11.11627471446991, eval loss: [NA]
Epoch: 17, loss: 11.125978956222534, eval loss: [NA]
Epoch: 18, loss: 11.130725355148316, eval loss: [NA]
Epoch: 19, loss: 11.124541535377503, eval loss: [NA]
Epoch: 20, loss: 11.143734335899353, eval loss: [NA]
Epoch: 21, loss: 11.136834979057312, eval loss: [NA]
Epoch: 22, loss: 11.129270696640015, eval loss: [NA]
Epoch: 23, loss: 11.119745836257934, eval loss: [NA]
Epoch: 24, loss: 11.109624538421631, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.74130778503418, eval loss: [NA]
Epoch: 1, loss: 5.709010287475586, eval loss: [NA]
Epoch: 2, loss: 5.680606039428711, eval loss: [NA]
Epoch: 3, loss: 5.270876826477051, eval loss: [NA]
Epoch: 4, loss: 4.868630247497559, eval loss: [NA]
Epoch: 5, loss: 4.816429852294922, eval loss: [NA]
Epoch: 6, loss: 4.703948429870605, eval loss: [NA]
Epoch: 7, loss: 4.618869299316406, eval loss: [NA]
Epoch: 8, loss: 4.651715567016602, eval loss: [NA]
Epoch: 9, loss: 4.642644725036621, eval loss: [NA]
Epoch: 10, loss: 4.571542080688476, eval loss: [NA]
Epoch: 11, loss: 4.581389338684082, eval loss: [NA]
Epoch: 12, loss: 4.563631535339355, eval loss: [NA]
Epoch: 13, loss: 4.606671212768554, eval loss: [NA]
Epoch: 14, loss: 4.582862347412109, eval loss: [NA]
Epoch: 15, loss: 4.566453047180175, eval loss: [NA]
Epoch: 16, loss: 4.550162759399414, eval loss: [NA]
Epoch: 17, loss: 4.550358241271972, eval loss: [NA]
Epoch: 18, loss: 4.517205204772949, eval loss: [NA]
Epoch: 19, loss: 4.561163368225098, eval loss: [NA]
Epoch: 20, loss: 4.567325894165039, eval loss: [NA]
Epoch: 21, loss: 4.533889805603027, eval loss: [NA]
Epoch: 22, loss: 4.55336021270752, eval loss: [NA]
Epoch: 23, loss: 4.522540911865234, eval loss: [NA]
Epoch: 24, loss: 4.5358050949096675, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.09095499753952, eval loss: [NA]
Epoch: 1, loss: 8.103122153282165, eval loss: [NA]
Epoch: 2, loss: 8.117855393886567, eval loss: [NA]
Epoch: 3, loss: 8.10756399154663, eval loss: [NA]
Epoch: 4, loss: 8.082242648601532, eval loss: [NA]
Epoch: 5, loss: 8.095865259170532, eval loss: [NA]
Epoch: 6, loss: 8.085084271430969, eval loss: [NA]
Epoch: 7, loss: 8.10657061100006, eval loss: [NA]
Epoch: 8, loss: 8.105616846084594, eval loss: [NA]
Epoch: 9, loss: 8.097517712116241, eval loss: [NA]
Epoch: 10, loss: 8.096742660999299, eval loss: [NA]
Epoch: 11, loss: 8.10135461807251, eval loss: [NA]
Epoch: 12, loss: 8.099467134475708, eval loss: [NA]
Epoch: 13, loss: 8.099679701328277, eval loss: [NA]
Epoch: 14, loss: 8.10939427614212, eval loss: [NA]
Epoch: 15, loss: 8.086057775020599, eval loss: [NA]
Epoch: 16, loss: 8.113922483921051, eval loss: [NA]
Epoch: 17, loss: 8.10043749332428, eval loss: [NA]
Epoch: 18, loss: 8.089128165245056, eval loss: [NA]
Epoch: 19, loss: 8.094321405887603, eval loss: [NA]
Epoch: 20, loss: 8.089930765628814, eval loss: [NA]
Epoch: 21, loss: 8.08746809244156, eval loss: [NA]
Epoch: 22, loss: 8.089269046783448, eval loss: [NA]
Epoch: 23, loss: 8.13091315984726, eval loss: [NA]
Epoch: 24, loss: 8.104138903617859, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 4.458942648315429, eval loss: [NA]
Epoch: 1, loss: 4.428247573852539, eval loss: [NA]
Epoch: 2, loss: 4.364850415039062, eval loss: [NA]
Epoch: 3, loss: 4.039191841125488, eval loss: [NA]
Epoch: 4, loss: 3.8821982452392576, eval loss: [NA]
Epoch: 5, loss: 3.8661640869140625, eval loss: [NA]
Epoch: 6, loss: 3.7971602462768557, eval loss: [NA]
Epoch: 7, loss: 3.743588687133789, eval loss: [NA]
Epoch: 8, loss: 3.68517776184082, eval loss: [NA]
Epoch: 9, loss: 3.674067074584961, eval loss: [NA]
Epoch: 10, loss: 3.6084892639160158, eval loss: [NA]
Epoch: 11, loss: 3.536973291015625, eval loss: [NA]
Epoch: 12, loss: 3.5330183853149415, eval loss: [NA]
Epoch: 13, loss: 3.5597431747436525, eval loss: [NA]
Epoch: 14, loss: 3.5014700164794923, eval loss: [NA]
Epoch: 15, loss: 3.4931525848388674, eval loss: [NA]
Epoch: 16, loss: 3.5509483291625976, eval loss: [NA]
Epoch: 17, loss: 3.5240914642333983, eval loss: [NA]
Epoch: 18, loss: 3.4919845779418943, eval loss: [NA]
Epoch: 19, loss: 3.5137969848632813, eval loss: [NA]
Epoch: 20, loss: 3.4900877380371096, eval loss: [NA]
Epoch: 21, loss: 3.489359185791016, eval loss: [NA]
Epoch: 22, loss: 3.487088366699219, eval loss: [NA]
Epoch: 23, loss: 3.4910025741577146, eval loss: [NA]
Epoch: 24, loss: 3.5115403076171874, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.804468688964843, eval loss: [NA]
Epoch: 1, loss: 7.7793038773536685, eval loss: [NA]
Epoch: 2, loss: 7.787740657329559, eval loss: [NA]
Epoch: 3, loss: 7.801112017631531, eval loss: [NA]
Epoch: 4, loss: 7.769185426235199, eval loss: [NA]
Epoch: 5, loss: 7.767454941272735, eval loss: [NA]
Epoch: 6, loss: 7.774243927001953, eval loss: [NA]
Epoch: 7, loss: 7.7948159098625185, eval loss: [NA]
Epoch: 8, loss: 7.79978880405426, eval loss: [NA]
Epoch: 9, loss: 7.79809709072113, eval loss: [NA]
Epoch: 10, loss: 7.780603322982788, eval loss: [NA]
Epoch: 11, loss: 7.7885831618309025, eval loss: [NA]
Epoch: 12, loss: 7.772393431663513, eval loss: [NA]
Epoch: 13, loss: 7.7868673658370975, eval loss: [NA]
Epoch: 14, loss: 7.804071860313416, eval loss: [NA]
Epoch: 15, loss: 7.7955032110214235, eval loss: [NA]
Epoch: 16, loss: 7.76108829498291, eval loss: [NA]
Epoch: 17, loss: 7.77712327003479, eval loss: [NA]
Epoch: 18, loss: 7.780809421539306, eval loss: [NA]
Epoch: 19, loss: 7.782918117046356, eval loss: [NA]
Epoch: 20, loss: 7.7808717513084416, eval loss: [NA]
Epoch: 21, loss: 7.7861034250259396, eval loss: [NA]
Epoch: 22, loss: 7.773803102970123, eval loss: [NA]
Epoch: 23, loss: 7.8143999171257015, eval loss: [NA]
Epoch: 24, loss: 7.761985788345337, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.517372677612305, eval loss: [NA]
Epoch: 1, loss: 3.4962756256103518, eval loss: [NA]
Epoch: 2, loss: 3.4886223129272462, eval loss: [NA]
Epoch: 3, loss: 3.506410690307617, eval loss: [NA]
Epoch: 4, loss: 3.479529362487793, eval loss: [NA]
Epoch: 5, loss: 3.5258067001342774, eval loss: [NA]
Epoch: 6, loss: 3.4993737075805664, eval loss: [NA]
Epoch: 7, loss: 3.4983221939086913, eval loss: [NA]
Epoch: 8, loss: 3.4843357177734373, eval loss: [NA]
Epoch: 9, loss: 3.517909600830078, eval loss: [NA]
Epoch: 10, loss: 3.474284474182129, eval loss: [NA]
Epoch: 11, loss: 3.503241766357422, eval loss: [NA]
Epoch: 12, loss: 3.5050459091186523, eval loss: [NA]
Epoch: 13, loss: 3.477650778198242, eval loss: [NA]
Epoch: 14, loss: 3.524624021911621, eval loss: [NA]
Epoch: 15, loss: 3.503944654846191, eval loss: [NA]
Epoch: 16, loss: 3.4900929153442384, eval loss: [NA]
Epoch: 17, loss: 3.4697784729003907, eval loss: [NA]
Epoch: 18, loss: 3.4766525039672853, eval loss: [NA]
Epoch: 19, loss: 3.447232975769043, eval loss: [NA]
Epoch: 20, loss: 3.4458855178833008, eval loss: [NA]
Epoch: 21, loss: 3.466365213012695, eval loss: [NA]
Epoch: 22, loss: 3.478499722290039, eval loss: [NA]
Epoch: 23, loss: 3.4483336990356444, eval loss: [NA]
Epoch: 24, loss: 3.4566908782958983, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.353329131603241, eval loss: [NA]
Epoch: 1, loss: 7.356694891452789, eval loss: [NA]
Epoch: 2, loss: 7.360422847270965, eval loss: [NA]
Epoch: 3, loss: 7.357458157539368, eval loss: [NA]
Epoch: 4, loss: 7.325355441570282, eval loss: [NA]
Epoch: 5, loss: 7.361118495464325, eval loss: [NA]
Epoch: 6, loss: 7.379568078517914, eval loss: [NA]
Epoch: 7, loss: 7.357940051555634, eval loss: [NA]
Epoch: 8, loss: 7.3643394780159, eval loss: [NA]
Epoch: 9, loss: 7.362514665126801, eval loss: [NA]
Epoch: 10, loss: 7.357227373123169, eval loss: [NA]
Epoch: 11, loss: 7.357633001804352, eval loss: [NA]
Epoch: 12, loss: 7.376113686561585, eval loss: [NA]
Epoch: 13, loss: 7.354442703723907, eval loss: [NA]
Epoch: 14, loss: 7.370211610794067, eval loss: [NA]
Epoch: 15, loss: 7.33115492105484, eval loss: [NA]
Epoch: 16, loss: 7.3566391158103945, eval loss: [NA]
Epoch: 17, loss: 7.324293251037598, eval loss: [NA]
Epoch: 18, loss: 7.321082491874694, eval loss: [NA]
Epoch: 19, loss: 7.343600082397461, eval loss: [NA]
Epoch: 20, loss: 7.332923240661621, eval loss: [NA]
Epoch: 21, loss: 7.3315963411331175, eval loss: [NA]
Epoch: 22, loss: 7.3574205327034, eval loss: [NA]
Epoch: 23, loss: 7.36155356168747, eval loss: [NA]
Epoch: 24, loss: 7.344372403621674, eval loss: [NA]

Runtime:399.43
[6.634164125046282e+17, 1.0001, 0.2998, 0.2993]
[2.1263, 1.1364, 0.7158, 0.7349]
[2.1199, 1.0949, 0.8695, 0.7774]
tensor(0.7506, grad_fn=<MeanBackward0>)
tensor(0.6917, grad_fn=<MeanBackward0>)
tensor([ 3.9635,  0.4148,  2.1034, -1.4306,  0.0049, -3.8176,  2.8440, -0.7537,
         2.7191, -0.9145], grad_fn=<MeanBackward1>)
tensor([0.3320, 0.3541, 0.3590, 0.3625, 0.3272, 0.3460, 1.1681, 1.2623, 1.1191,
        1.2516], grad_fn=<StdBackward1>)
tensor([ 4.0900,  0.4088,  2.2699, -1.4159, -0.0398, -4.0895,  2.5841, -0.7083,
         1.3405, -2.4450])
KL div untrained: 4.78313916579475e+17
KL div trained: 0.1974
