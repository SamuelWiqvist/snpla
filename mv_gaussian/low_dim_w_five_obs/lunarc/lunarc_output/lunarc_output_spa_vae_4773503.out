Input args:
Dim: 2
seed: 29
seed_data: 10
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev
tensor(2.1743, grad_fn=<MeanBackward0>)
tensor(2.1805, grad_fn=<MeanBackward0>)
tensor([-0.0328, -0.1309, -0.0224, -0.0425, -0.1551,  0.1115,  0.1046, -0.1246,
         0.0121,  0.0680], grad_fn=<MeanBackward1>)
tensor([0.9384, 1.1356, 0.9075, 1.0586, 0.8725, 1.0054, 0.9779, 1.0896, 0.9931,
        1.0991], grad_fn=<StdBackward1>)
tensor([ 3.9166,  1.0194,  3.1240,  0.2892,  3.3714,  0.9591,  3.4490,  0.9705,
         2.3676, -0.1059])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.199453839111328, eval loss: [NA]
Epoch: 1, loss: 7.0947871643066405, eval loss: [NA]
Epoch: 2, loss: 7.04385966796875, eval loss: [NA]
Epoch: 3, loss: 6.996468539428711, eval loss: [NA]
Epoch: 4, loss: 6.910904266357422, eval loss: [NA]
Epoch: 5, loss: 6.8658797088623045, eval loss: [NA]
Epoch: 6, loss: 6.861609649658203, eval loss: [NA]
Epoch: 7, loss: 6.86079555053711, eval loss: [NA]
Epoch: 8, loss: 6.801424975585937, eval loss: [NA]
Epoch: 9, loss: 6.603978762817383, eval loss: [NA]
Epoch: 10, loss: 6.1287723190307615, eval loss: [NA]
Epoch: 11, loss: 5.387185514831543, eval loss: [NA]
Epoch: 12, loss: 5.021485087585449, eval loss: [NA]
Epoch: 13, loss: 4.888353401184082, eval loss: [NA]
Epoch: 14, loss: 4.752247344970703, eval loss: [NA]
Epoch: 15, loss: 4.723773512268067, eval loss: [NA]
Epoch: 16, loss: 4.672342678833008, eval loss: [NA]
Epoch: 17, loss: 4.650141638183594, eval loss: [NA]
Epoch: 18, loss: 4.667105015563965, eval loss: [NA]
Epoch: 19, loss: 4.6278737289428715, eval loss: [NA]
Epoch: 20, loss: 4.6079023132324215, eval loss: [NA]
Epoch: 21, loss: 4.616017741394043, eval loss: [NA]
Epoch: 22, loss: 4.597695950317383, eval loss: [NA]
Epoch: 23, loss: 4.58456685333252, eval loss: [NA]
Epoch: 24, loss: 4.59554377746582, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.0030023953318596, eval loss: [NA]
Epoch: 1, loss: 0.9011202327907085, eval loss: [NA]
Epoch: 2, loss: 0.6295215386152268, eval loss: [NA]
Epoch: 3, loss: 0.6115323722362518, eval loss: [NA]
Epoch: 4, loss: 0.5320216658711433, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.3532945656776425, eval loss: [NA]
Epoch: 1, loss: 5.33624794960022, eval loss: [NA]
Epoch: 2, loss: 5.320346794128418, eval loss: [NA]
Epoch: 3, loss: 5.338228597640991, eval loss: [NA]
Epoch: 4, loss: 5.318070104122162, eval loss: [NA]
Epoch: 5, loss: 5.332904527187347, eval loss: [NA]
Epoch: 6, loss: 5.326207163333893, eval loss: [NA]
Epoch: 7, loss: 5.331970546245575, eval loss: [NA]
Epoch: 8, loss: 5.3271373891830445, eval loss: [NA]
Epoch: 9, loss: 5.3364679479599, eval loss: [NA]
Epoch: 10, loss: 5.29036529302597, eval loss: [NA]
Epoch: 11, loss: 5.319432406425476, eval loss: [NA]
Epoch: 12, loss: 5.3219302773475645, eval loss: [NA]
Epoch: 13, loss: 5.333614280223847, eval loss: [NA]
Epoch: 14, loss: 5.292725827693939, eval loss: [NA]
Epoch: 15, loss: 5.320786900520325, eval loss: [NA]
Epoch: 16, loss: 5.297912721633911, eval loss: [NA]
Epoch: 17, loss: 5.3193519592285154, eval loss: [NA]
Epoch: 18, loss: 5.310355360507965, eval loss: [NA]
Epoch: 19, loss: 5.318147625923157, eval loss: [NA]
Epoch: 20, loss: 5.307061307430267, eval loss: [NA]
Epoch: 21, loss: 5.335675764083862, eval loss: [NA]
Epoch: 22, loss: 5.310927665233612, eval loss: [NA]
Epoch: 23, loss: 5.320082969665528, eval loss: [NA]
Epoch: 24, loss: 5.327036628723144, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.654272256469727, eval loss: [NA]
Epoch: 1, loss: 4.601629760742187, eval loss: [NA]
Epoch: 2, loss: 4.594525225830078, eval loss: [NA]
Epoch: 3, loss: 4.58497911529541, eval loss: [NA]
Epoch: 4, loss: 4.564463325500489, eval loss: [NA]
Epoch: 5, loss: 4.579879476928711, eval loss: [NA]
Epoch: 6, loss: 4.57933025970459, eval loss: [NA]
Epoch: 7, loss: 4.565269157409668, eval loss: [NA]
Epoch: 8, loss: 4.57543659362793, eval loss: [NA]
Epoch: 9, loss: 4.574833987426758, eval loss: [NA]
Epoch: 10, loss: 4.589528147888184, eval loss: [NA]
Epoch: 11, loss: 4.568636180114746, eval loss: [NA]
Epoch: 12, loss: 4.537287991333008, eval loss: [NA]
Epoch: 13, loss: 4.393125144958496, eval loss: [NA]
Epoch: 14, loss: 4.052242222595215, eval loss: [NA]
Epoch: 15, loss: 3.8465216033935548, eval loss: [NA]
Epoch: 16, loss: 3.7020533157348634, eval loss: [NA]
Epoch: 17, loss: 3.7153836990356446, eval loss: [NA]
Epoch: 18, loss: 3.6953420822143555, eval loss: [NA]
Epoch: 19, loss: 3.63135158996582, eval loss: [NA]
Epoch: 20, loss: 3.6254893157958983, eval loss: [NA]
Epoch: 21, loss: 3.609272904968262, eval loss: [NA]
Epoch: 22, loss: 3.622138488769531, eval loss: [NA]
Epoch: 23, loss: 3.604825752258301, eval loss: [NA]
Epoch: 24, loss: 3.6083714904785156, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 4.636299359798431, eval loss: [NA]
Epoch: 1, loss: 4.583565363883972, eval loss: [NA]
Epoch: 2, loss: 4.599596815109253, eval loss: [NA]
Epoch: 3, loss: 4.593176805973053, eval loss: [NA]
Epoch: 4, loss: 4.593617420196534, eval loss: [NA]
Epoch: 5, loss: 4.568724627494812, eval loss: [NA]
Epoch: 6, loss: 4.598017320632935, eval loss: [NA]
Epoch: 7, loss: 4.584809038639069, eval loss: [NA]
Epoch: 8, loss: 4.591092460155487, eval loss: [NA]
Epoch: 9, loss: 4.569461739063263, eval loss: [NA]
Epoch: 10, loss: 4.5988145399093625, eval loss: [NA]
Epoch: 11, loss: 4.6231884145736695, eval loss: [NA]
Epoch: 12, loss: 4.596342282295227, eval loss: [NA]
Epoch: 13, loss: 4.611433520317077, eval loss: [NA]
Epoch: 14, loss: 4.581290853023529, eval loss: [NA]
Epoch: 15, loss: 4.597524240016937, eval loss: [NA]
Epoch: 16, loss: 4.611916949748993, eval loss: [NA]
Epoch: 17, loss: 4.595633931159973, eval loss: [NA]
Epoch: 18, loss: 4.607153871059418, eval loss: [NA]
Epoch: 19, loss: 4.587249891757965, eval loss: [NA]
Epoch: 20, loss: 4.601645457744598, eval loss: [NA]
Epoch: 21, loss: 4.602926287651062, eval loss: [NA]
Epoch: 22, loss: 4.592836570739746, eval loss: [NA]
Epoch: 23, loss: 4.6093242597579955, eval loss: [NA]
Epoch: 24, loss: 4.573060550689697, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5480786437988283, eval loss: [NA]
Epoch: 1, loss: 3.5500348236083985, eval loss: [NA]
Epoch: 2, loss: 3.539365202331543, eval loss: [NA]
Epoch: 3, loss: 3.541516036987305, eval loss: [NA]
Epoch: 4, loss: 3.534001745605469, eval loss: [NA]
Epoch: 5, loss: 3.544585891723633, eval loss: [NA]
Epoch: 6, loss: 3.525048699951172, eval loss: [NA]
Epoch: 7, loss: 3.5306067459106445, eval loss: [NA]
Epoch: 8, loss: 3.529717463684082, eval loss: [NA]
Epoch: 9, loss: 3.5201157302856445, eval loss: [NA]
Epoch: 10, loss: 3.550833772277832, eval loss: [NA]
Epoch: 11, loss: 3.5504356521606444, eval loss: [NA]
Epoch: 12, loss: 3.4852023239135743, eval loss: [NA]
Epoch: 13, loss: 3.5387164642333984, eval loss: [NA]
Epoch: 14, loss: 3.527617416381836, eval loss: [NA]
Epoch: 15, loss: 3.497952247619629, eval loss: [NA]
Epoch: 16, loss: 3.5399413269042967, eval loss: [NA]
Epoch: 17, loss: 3.5259400619506835, eval loss: [NA]
Epoch: 18, loss: 3.506188868713379, eval loss: [NA]
Epoch: 19, loss: 3.5148549057006835, eval loss: [NA]
Epoch: 20, loss: 3.5060849533081053, eval loss: [NA]
Epoch: 21, loss: 3.5307629669189455, eval loss: [NA]
Epoch: 22, loss: 3.499547706604004, eval loss: [NA]
Epoch: 23, loss: 3.4978334854125976, eval loss: [NA]
Epoch: 24, loss: 3.4946077545166014, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 4.540778956413269, eval loss: [NA]
Epoch: 1, loss: 4.5781386685371395, eval loss: [NA]
Epoch: 2, loss: 4.532372298240662, eval loss: [NA]
Epoch: 3, loss: 4.536489453315735, eval loss: [NA]
Epoch: 4, loss: 4.573216590881348, eval loss: [NA]
Epoch: 5, loss: 4.550918076038361, eval loss: [NA]
Epoch: 6, loss: 4.532320446968079, eval loss: [NA]
Epoch: 7, loss: 4.542686295509339, eval loss: [NA]
Epoch: 8, loss: 4.575966787338257, eval loss: [NA]
Epoch: 9, loss: 4.576610858440399, eval loss: [NA]
Epoch: 10, loss: 4.548095712661743, eval loss: [NA]
Epoch: 11, loss: 4.542919890880585, eval loss: [NA]
Epoch: 12, loss: 4.545234489440918, eval loss: [NA]
Epoch: 13, loss: 4.538277885913849, eval loss: [NA]
Epoch: 14, loss: 4.557472760677338, eval loss: [NA]
Epoch: 15, loss: 4.567755200862885, eval loss: [NA]
Epoch: 16, loss: 4.526463756561279, eval loss: [NA]
Epoch: 17, loss: 4.538287978172303, eval loss: [NA]
Epoch: 18, loss: 4.552452492713928, eval loss: [NA]
Epoch: 19, loss: 4.552610719203949, eval loss: [NA]
Epoch: 20, loss: 4.543855955600739, eval loss: [NA]
Epoch: 21, loss: 4.549890201091767, eval loss: [NA]
Epoch: 22, loss: 4.566236937046051, eval loss: [NA]
Epoch: 23, loss: 4.54596316576004, eval loss: [NA]
Epoch: 24, loss: 4.567510948181153, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.541009228515625, eval loss: [NA]
Epoch: 1, loss: 3.4976752548217775, eval loss: [NA]
Epoch: 2, loss: 3.514303628540039, eval loss: [NA]
Epoch: 3, loss: 3.489257876586914, eval loss: [NA]
Epoch: 4, loss: 3.470790982055664, eval loss: [NA]
Epoch: 5, loss: 3.470922898864746, eval loss: [NA]
Epoch: 6, loss: 3.4775397354125976, eval loss: [NA]
Epoch: 7, loss: 3.499429750061035, eval loss: [NA]
Epoch: 8, loss: 3.4523441421508787, eval loss: [NA]
Epoch: 9, loss: 3.4857760528564454, eval loss: [NA]
Epoch: 10, loss: 3.4827242752075196, eval loss: [NA]
Epoch: 11, loss: 3.484221990966797, eval loss: [NA]
Epoch: 12, loss: 3.4827115646362303, eval loss: [NA]
Epoch: 13, loss: 3.5075801940917968, eval loss: [NA]
Epoch: 14, loss: 3.4249069122314455, eval loss: [NA]
Epoch: 15, loss: 3.480578564453125, eval loss: [NA]
Epoch: 16, loss: 3.454678239440918, eval loss: [NA]
Epoch: 17, loss: 3.4606412673950193, eval loss: [NA]
Epoch: 18, loss: 3.4831650619506838, eval loss: [NA]
Epoch: 19, loss: 3.4642027435302736, eval loss: [NA]
Epoch: 20, loss: 3.4753069229125977, eval loss: [NA]
Epoch: 21, loss: 3.4627613800048826, eval loss: [NA]
Epoch: 22, loss: 3.4698177047729493, eval loss: [NA]
Epoch: 23, loss: 3.464249458312988, eval loss: [NA]
Epoch: 24, loss: 3.475750309753418, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 4.432098692655563, eval loss: [NA]
Epoch: 1, loss: 4.446176638603211, eval loss: [NA]
Epoch: 2, loss: 4.449283269643783, eval loss: [NA]
Epoch: 3, loss: 4.429452223777771, eval loss: [NA]
Epoch: 4, loss: 4.451213479042053, eval loss: [NA]
Epoch: 5, loss: 4.448697595596314, eval loss: [NA]
Epoch: 6, loss: 4.448245487213135, eval loss: [NA]
Epoch: 7, loss: 4.429673886299133, eval loss: [NA]
Epoch: 8, loss: 4.4536294174194335, eval loss: [NA]
Epoch: 9, loss: 4.445819056034088, eval loss: [NA]
Epoch: 10, loss: 4.426469143629074, eval loss: [NA]
Epoch: 11, loss: 4.446248304843903, eval loss: [NA]
Epoch: 12, loss: 4.450012471675873, eval loss: [NA]
Epoch: 13, loss: 4.44964275598526, eval loss: [NA]
Epoch: 14, loss: 4.442809314727783, eval loss: [NA]
Epoch: 15, loss: 4.432650246620178, eval loss: [NA]
Epoch: 16, loss: 4.426660767793655, eval loss: [NA]
Epoch: 17, loss: 4.42831010222435, eval loss: [NA]
Epoch: 18, loss: 4.450687289237976, eval loss: [NA]
Epoch: 19, loss: 4.417462875843048, eval loss: [NA]
Epoch: 20, loss: 4.454613448381424, eval loss: [NA]
Epoch: 21, loss: 4.432183737754822, eval loss: [NA]
Epoch: 22, loss: 4.413873680830002, eval loss: [NA]
Epoch: 23, loss: 4.429668283462524, eval loss: [NA]
Epoch: 24, loss: 4.415820214748383, eval loss: [NA]

Runtime:398.57
[5.061354896052791e+17, 0.2885, 0.157, 0.1304]
[2.1805, 0.75, 0.6756, 0.7032]
[2.1743, 0.889, 0.7512, 0.7524]
tensor(0.7840, grad_fn=<MeanBackward0>)
tensor(0.6781, grad_fn=<MeanBackward0>)
tensor([ 3.7554,  1.0045,  3.1303,  0.3267,  2.5825, -0.3025,  2.6025, -0.1546,
         2.4116, -0.3855], grad_fn=<MeanBackward1>)
tensor([0.3112, 0.3368, 0.3113, 0.3115, 1.1330, 1.2796, 1.1475, 1.2565, 0.3079,
        0.3263], grad_fn=<StdBackward1>)
tensor([ 3.9166,  1.0194,  3.1240,  0.2892,  3.3714,  0.9591,  3.4490,  0.9705,
         2.3676, -0.1059])
KL div untrained: 7.866672055101093e+17
KL div trained: 0.1501
