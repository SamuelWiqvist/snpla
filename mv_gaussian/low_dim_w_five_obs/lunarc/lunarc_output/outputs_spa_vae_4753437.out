/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1852, grad_fn=<MeanBackward0>)
tensor(2.7053, grad_fn=<MeanBackward0>)
tensor([ 0.1961, -0.0454, -0.0402, -0.1135, -0.0741, -0.1749,  0.1635,  0.3013,
         0.1534,  0.1683], grad_fn=<MeanBackward1>)
tensor([0.9781, 0.9210, 0.8860, 1.0317, 1.0155, 1.0259, 0.9779, 1.0033, 0.9009,
        1.1139], grad_fn=<StdBackward1>)
tensor([-5.4795, -1.3369, -0.9523,  3.5409, -2.1759,  1.8250, -5.2685, -0.8735,
        -2.5820,  1.8081])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.666847402954101, eval loss: [NA]
Epoch: 1, loss: 7.136129711914062, eval loss: [NA]
Epoch: 2, loss: 7.066253118896484, eval loss: [NA]
Epoch: 3, loss: 6.996075201416016, eval loss: [NA]
Epoch: 4, loss: 6.968875512695313, eval loss: [NA]
Epoch: 5, loss: 6.934778271484375, eval loss: [NA]
Epoch: 6, loss: 6.931777923583985, eval loss: [NA]
Epoch: 7, loss: 6.914274765014649, eval loss: [NA]
Epoch: 8, loss: 6.83876569519043, eval loss: [NA]
Epoch: 9, loss: 6.462709060668946, eval loss: [NA]
Epoch: 10, loss: 6.116538595581055, eval loss: [NA]
Epoch: 11, loss: 5.977152487182617, eval loss: [NA]
Epoch: 12, loss: 5.907702792358398, eval loss: [NA]
Epoch: 13, loss: 5.873057664489746, eval loss: [NA]
Epoch: 14, loss: 5.817319151306152, eval loss: [NA]
Epoch: 15, loss: 5.826345433044434, eval loss: [NA]
Epoch: 16, loss: 5.81678758392334, eval loss: [NA]
Epoch: 17, loss: 5.806844180297851, eval loss: [NA]
Epoch: 18, loss: 5.79371219329834, eval loss: [NA]
Epoch: 19, loss: 5.770196752929688, eval loss: [NA]
Epoch: 20, loss: 5.7754882614135745, eval loss: [NA]
Epoch: 21, loss: 5.779867292785645, eval loss: [NA]
Epoch: 22, loss: 5.771918196105957, eval loss: [NA]
Epoch: 23, loss: 5.758921182250977, eval loss: [NA]
Epoch: 24, loss: 5.763387663269043, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.1924945715069772, eval loss: [NA]
Epoch: 1, loss: 0.930467814952135, eval loss: [NA]
Epoch: 2, loss: 0.6808358930051327, eval loss: [NA]
Epoch: 3, loss: 0.5956393810361624, eval loss: [NA]
Epoch: 4, loss: 0.575038126334548, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 17.589123697280883, eval loss: [NA]
Epoch: 1, loss: 17.545618858337402, eval loss: [NA]
Epoch: 2, loss: 17.56734492301941, eval loss: [NA]
Epoch: 3, loss: 17.535950784683227, eval loss: [NA]
Epoch: 4, loss: 17.559644412994384, eval loss: [NA]
Epoch: 5, loss: 17.536452827453612, eval loss: [NA]
Epoch: 6, loss: 17.5462403011322, eval loss: [NA]
Epoch: 7, loss: 17.560740404129028, eval loss: [NA]
Epoch: 8, loss: 17.553816471099854, eval loss: [NA]
Epoch: 9, loss: 17.563573122024536, eval loss: [NA]
Epoch: 10, loss: 17.552594242095946, eval loss: [NA]
Epoch: 11, loss: 17.54001799583435, eval loss: [NA]
Epoch: 12, loss: 17.546086883544923, eval loss: [NA]
Epoch: 13, loss: 17.537685136795044, eval loss: [NA]
Epoch: 14, loss: 17.56137971878052, eval loss: [NA]
Epoch: 15, loss: 17.527989406585693, eval loss: [NA]
Epoch: 16, loss: 17.539499139785768, eval loss: [NA]
Epoch: 17, loss: 17.53919722557068, eval loss: [NA]
Epoch: 18, loss: 17.53360281944275, eval loss: [NA]
Epoch: 19, loss: 17.530014390945436, eval loss: [NA]
Epoch: 20, loss: 17.537598180770875, eval loss: [NA]
Epoch: 21, loss: 17.532680292129516, eval loss: [NA]
Epoch: 22, loss: 17.540557527542113, eval loss: [NA]
Epoch: 23, loss: 17.538524923324584, eval loss: [NA]
Epoch: 24, loss: 17.525855531692503, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 5.738612646484375, eval loss: [NA]
Epoch: 1, loss: 5.716154765319824, eval loss: [NA]
Epoch: 2, loss: 5.675224418640137, eval loss: [NA]
Epoch: 3, loss: 5.665399674987793, eval loss: [NA]
Epoch: 4, loss: 5.681621214294434, eval loss: [NA]
Epoch: 5, loss: 5.671986845397949, eval loss: [NA]
Epoch: 6, loss: 5.633959968566894, eval loss: [NA]
Epoch: 7, loss: 5.210949078369141, eval loss: [NA]
Epoch: 8, loss: 4.874372865295411, eval loss: [NA]
Epoch: 9, loss: 4.710932373046875, eval loss: [NA]
Epoch: 10, loss: 4.668327400207519, eval loss: [NA]
Epoch: 11, loss: 4.5760370590209964, eval loss: [NA]
Epoch: 12, loss: 4.579754461669922, eval loss: [NA]
Epoch: 13, loss: 4.553391088867188, eval loss: [NA]
Epoch: 14, loss: 4.573358720397949, eval loss: [NA]
Epoch: 15, loss: 4.5513823928833, eval loss: [NA]
Epoch: 16, loss: 4.524614277648926, eval loss: [NA]
Epoch: 17, loss: 4.520323956298828, eval loss: [NA]
Epoch: 18, loss: 4.522310281372071, eval loss: [NA]
Epoch: 19, loss: 4.514070834350586, eval loss: [NA]
Epoch: 20, loss: 4.520995367431641, eval loss: [NA]
Epoch: 21, loss: 4.50966887512207, eval loss: [NA]
Epoch: 22, loss: 4.504672593688965, eval loss: [NA]
Epoch: 23, loss: 4.513512663269043, eval loss: [NA]
Epoch: 24, loss: 4.511552616882324, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 15.812852520942688, eval loss: [NA]
Epoch: 1, loss: 15.763043804168701, eval loss: [NA]
Epoch: 2, loss: 15.788143811225892, eval loss: [NA]
Epoch: 3, loss: 15.792207317352295, eval loss: [NA]
Epoch: 4, loss: 15.763939933776856, eval loss: [NA]
Epoch: 5, loss: 15.758180561065673, eval loss: [NA]
Epoch: 6, loss: 15.796241512298584, eval loss: [NA]
Epoch: 7, loss: 15.75996829032898, eval loss: [NA]
Epoch: 8, loss: 15.774976649284362, eval loss: [NA]
Epoch: 9, loss: 15.767623381614685, eval loss: [NA]
Epoch: 10, loss: 15.751200108528137, eval loss: [NA]
Epoch: 11, loss: 15.769843139648437, eval loss: [NA]
Epoch: 12, loss: 15.770768480300903, eval loss: [NA]
Epoch: 13, loss: 15.757092328071595, eval loss: [NA]
Epoch: 14, loss: 15.762797951698303, eval loss: [NA]
Epoch: 15, loss: 15.763342695236206, eval loss: [NA]
Epoch: 16, loss: 15.774830150604249, eval loss: [NA]
Epoch: 17, loss: 15.775814118385314, eval loss: [NA]
Epoch: 18, loss: 15.772982430458068, eval loss: [NA]
Epoch: 19, loss: 15.76478449344635, eval loss: [NA]
Epoch: 20, loss: 15.754793639183044, eval loss: [NA]
Epoch: 21, loss: 15.760641431808471, eval loss: [NA]
Epoch: 22, loss: 15.762687077522278, eval loss: [NA]
Epoch: 23, loss: 15.752457413673401, eval loss: [NA]
Epoch: 24, loss: 15.76382179737091, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 4.5377354904174805, eval loss: [NA]
Epoch: 1, loss: 4.575252590942383, eval loss: [NA]
Epoch: 2, loss: 4.544483419799804, eval loss: [NA]
Epoch: 3, loss: 4.582175828552246, eval loss: [NA]
Epoch: 4, loss: 4.522044898986817, eval loss: [NA]
Epoch: 5, loss: 4.559818893432618, eval loss: [NA]
Epoch: 6, loss: 4.526761569213868, eval loss: [NA]
Epoch: 7, loss: 4.534073361206055, eval loss: [NA]
Epoch: 8, loss: 4.53292423248291, eval loss: [NA]
Epoch: 9, loss: 4.506040333557129, eval loss: [NA]
Epoch: 10, loss: 4.49367611694336, eval loss: [NA]
Epoch: 11, loss: 4.467440406799317, eval loss: [NA]
Epoch: 12, loss: 4.150091151428223, eval loss: [NA]
Epoch: 13, loss: 3.961723922729492, eval loss: [NA]
Epoch: 14, loss: 3.8498493713378905, eval loss: [NA]
Epoch: 15, loss: 3.8196102798461915, eval loss: [NA]
Epoch: 16, loss: 3.7779519592285156, eval loss: [NA]
Epoch: 17, loss: 3.7074026138305665, eval loss: [NA]
Epoch: 18, loss: 3.7243883407592775, eval loss: [NA]
Epoch: 19, loss: 3.6407526443481446, eval loss: [NA]
Epoch: 20, loss: 3.6499163269042967, eval loss: [NA]
Epoch: 21, loss: 3.5658927124023436, eval loss: [NA]
Epoch: 22, loss: 3.5949391891479494, eval loss: [NA]
Epoch: 23, loss: 3.582150378417969, eval loss: [NA]
Epoch: 24, loss: 3.5844612548828123, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 13.419398159980775, eval loss: [NA]
Epoch: 1, loss: 13.40429214000702, eval loss: [NA]
Epoch: 2, loss: 13.425598492622376, eval loss: [NA]
Epoch: 3, loss: 13.394150919914246, eval loss: [NA]
Epoch: 4, loss: 13.401491680145263, eval loss: [NA]
Epoch: 5, loss: 13.396021556854247, eval loss: [NA]
Epoch: 6, loss: 13.41424081325531, eval loss: [NA]
Epoch: 7, loss: 13.394560461044312, eval loss: [NA]
Epoch: 8, loss: 13.404899363517762, eval loss: [NA]
Epoch: 9, loss: 13.383074817657471, eval loss: [NA]
Epoch: 10, loss: 13.444664950370788, eval loss: [NA]
Epoch: 11, loss: 13.388883690834046, eval loss: [NA]
Epoch: 12, loss: 13.427006196975707, eval loss: [NA]
Epoch: 13, loss: 13.399907817840576, eval loss: [NA]
Epoch: 14, loss: 13.402785992622375, eval loss: [NA]
Epoch: 15, loss: 13.421394381523132, eval loss: [NA]
Epoch: 16, loss: 13.404583444595337, eval loss: [NA]
Epoch: 17, loss: 13.391849246025085, eval loss: [NA]
Epoch: 18, loss: 13.408527131080627, eval loss: [NA]
Epoch: 19, loss: 13.406568412780763, eval loss: [NA]
Epoch: 20, loss: 13.409973640441894, eval loss: [NA]
Epoch: 21, loss: 13.409489421844482, eval loss: [NA]
Epoch: 22, loss: 13.395843472480774, eval loss: [NA]
Epoch: 23, loss: 13.390446848869324, eval loss: [NA]
Epoch: 24, loss: 13.370522952079773, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.583859585571289, eval loss: [NA]
Epoch: 1, loss: 3.5545220687866212, eval loss: [NA]
Epoch: 2, loss: 3.585342158508301, eval loss: [NA]
Epoch: 3, loss: 3.5208628295898436, eval loss: [NA]
Epoch: 4, loss: 3.547389863586426, eval loss: [NA]
Epoch: 5, loss: 3.57129758605957, eval loss: [NA]
Epoch: 6, loss: 3.5192925491333007, eval loss: [NA]
Epoch: 7, loss: 3.5310392822265624, eval loss: [NA]
Epoch: 8, loss: 3.517355563354492, eval loss: [NA]
Epoch: 9, loss: 3.502407440185547, eval loss: [NA]
Epoch: 10, loss: 3.504456245422363, eval loss: [NA]
Epoch: 11, loss: 3.4983050704956056, eval loss: [NA]
Epoch: 12, loss: 3.5067375396728515, eval loss: [NA]
Epoch: 13, loss: 3.508121961975098, eval loss: [NA]
Epoch: 14, loss: 3.5044319869995118, eval loss: [NA]
Epoch: 15, loss: 3.4986588836669923, eval loss: [NA]
Epoch: 16, loss: 3.5121340591430665, eval loss: [NA]
Epoch: 17, loss: 3.5221303482055664, eval loss: [NA]
Epoch: 18, loss: 3.480025971984863, eval loss: [NA]
Epoch: 19, loss: 3.5231971115112306, eval loss: [NA]
Epoch: 20, loss: 3.5235900573730468, eval loss: [NA]
Epoch: 21, loss: 3.4927086349487304, eval loss: [NA]
Epoch: 22, loss: 3.4974960388183596, eval loss: [NA]
Epoch: 23, loss: 3.4843837142944336, eval loss: [NA]
Epoch: 24, loss: 3.4890774185180664, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 13.393728699684143, eval loss: [NA]
Epoch: 1, loss: 13.364327583312988, eval loss: [NA]
Epoch: 2, loss: 13.366695837974548, eval loss: [NA]
Epoch: 3, loss: 13.382864699363708, eval loss: [NA]
Epoch: 4, loss: 13.388113598823548, eval loss: [NA]
Epoch: 5, loss: 13.351721630096435, eval loss: [NA]
Epoch: 6, loss: 13.369904861450195, eval loss: [NA]
Epoch: 7, loss: 13.33428921699524, eval loss: [NA]
Epoch: 8, loss: 13.353771233558655, eval loss: [NA]
Epoch: 9, loss: 13.389769239425659, eval loss: [NA]
Epoch: 10, loss: 13.366903471946717, eval loss: [NA]
Epoch: 11, loss: 13.357511134147645, eval loss: [NA]
Epoch: 12, loss: 13.364746990203857, eval loss: [NA]
Epoch: 13, loss: 13.36697247505188, eval loss: [NA]
Epoch: 14, loss: 13.37122956752777, eval loss: [NA]
Epoch: 15, loss: 13.378982315063476, eval loss: [NA]
Epoch: 16, loss: 13.392767419815064, eval loss: [NA]
Epoch: 17, loss: 13.368777799606324, eval loss: [NA]
Epoch: 18, loss: 13.379688596725464, eval loss: [NA]
Epoch: 19, loss: 13.386932940483094, eval loss: [NA]
Epoch: 20, loss: 13.365606288909913, eval loss: [NA]
Epoch: 21, loss: 13.372376146316528, eval loss: [NA]
Epoch: 22, loss: 13.373260040283203, eval loss: [NA]
Epoch: 23, loss: 13.367830486297608, eval loss: [NA]
Epoch: 24, loss: 13.369683866500855, eval loss: [NA]

Runtime:394.54
[991.0038, 1.933, 0.4049, 0.1379]
[2.7053, 1.6583, 1.3159, 1.137]
[2.1852, 1.1001, 0.8817, 0.7718]
tensor(0.7547, grad_fn=<MeanBackward0>)
tensor(1.1093, grad_fn=<MeanBackward0>)
tensor([-3.5730,  0.5505, -3.4357,  0.6525, -2.3824,  1.7944, -5.0089, -1.0714,
        -2.4883,  1.7531], grad_fn=<MeanBackward1>)
tensor([1.1924, 1.2281, 1.1297, 1.1760, 0.3322, 0.3395, 0.3221, 0.3313, 0.3204,
        0.3541], grad_fn=<StdBackward1>)
tensor([-5.4795, -1.3369, -0.9523,  3.5409, -2.1759,  1.8250, -5.2685, -0.8735,
        -2.5820,  1.8081])
KL div untrained: 974.0812
KL div trained: 0.1411
