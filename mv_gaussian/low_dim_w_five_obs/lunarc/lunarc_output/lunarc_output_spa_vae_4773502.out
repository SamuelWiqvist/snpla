Input args:
Dim: 2
seed: 28
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.2110, grad_fn=<MeanBackward0>)
tensor(2.4810, grad_fn=<MeanBackward0>)
tensor([ 0.1730,  0.0303, -0.2130, -0.0196, -0.2197,  0.3474, -0.0388,  0.2297,
        -0.0507, -0.0782], grad_fn=<MeanBackward1>)
tensor([1.0181, 1.0079, 1.0205, 1.0394, 1.1179, 0.9055, 1.0439, 1.0356, 1.0849,
        0.9383], grad_fn=<StdBackward1>)
tensor([ 3.5271,  1.5924,  3.1606,  1.0480,  3.3458,  1.6581,  4.4204,  3.4435,
         0.9044, -1.4765])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.378059555053712, eval loss: [NA]
Epoch: 1, loss: 7.138208340454102, eval loss: [NA]
Epoch: 2, loss: 7.090341455078125, eval loss: [NA]
Epoch: 3, loss: 7.010756384277344, eval loss: [NA]
Epoch: 4, loss: 6.938841107177734, eval loss: [NA]
Epoch: 5, loss: 6.906277233886719, eval loss: [NA]
Epoch: 6, loss: 6.886272525024414, eval loss: [NA]
Epoch: 7, loss: 6.868787316894531, eval loss: [NA]
Epoch: 8, loss: 6.801234753417969, eval loss: [NA]
Epoch: 9, loss: 6.495807907104492, eval loss: [NA]
Epoch: 10, loss: 5.5392584869384764, eval loss: [NA]
Epoch: 11, loss: 4.611881228637695, eval loss: [NA]
Epoch: 12, loss: 4.167301345825195, eval loss: [NA]
Epoch: 13, loss: 4.007036572265625, eval loss: [NA]
Epoch: 14, loss: 3.8826541397094725, eval loss: [NA]
Epoch: 15, loss: 3.8847257080078124, eval loss: [NA]
Epoch: 16, loss: 3.7834815017700194, eval loss: [NA]
Epoch: 17, loss: 3.81274811706543, eval loss: [NA]
Epoch: 18, loss: 3.778839617919922, eval loss: [NA]
Epoch: 19, loss: 3.7766529510498046, eval loss: [NA]
Epoch: 20, loss: 3.755120068359375, eval loss: [NA]
Epoch: 21, loss: 3.6948588516235352, eval loss: [NA]
Epoch: 22, loss: 3.701130793762207, eval loss: [NA]
Epoch: 23, loss: 3.718573731994629, eval loss: [NA]
Epoch: 24, loss: 3.6897395919799805, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.068603225648403, eval loss: [NA]
Epoch: 1, loss: 0.8022672107815743, eval loss: [NA]
Epoch: 2, loss: 0.705901417657733, eval loss: [NA]
Epoch: 3, loss: 0.5647441041469574, eval loss: [NA]
Epoch: 4, loss: 0.5409524793177843, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.465048027038574, eval loss: [NA]
Epoch: 1, loss: 8.463240880966186, eval loss: [NA]
Epoch: 2, loss: 8.455498099327087, eval loss: [NA]
Epoch: 3, loss: 8.444365384578704, eval loss: [NA]
Epoch: 4, loss: 8.439201869964599, eval loss: [NA]
Epoch: 5, loss: 8.43214403629303, eval loss: [NA]
Epoch: 6, loss: 8.453977077007293, eval loss: [NA]
Epoch: 7, loss: 8.453404326438903, eval loss: [NA]
Epoch: 8, loss: 8.449564628601074, eval loss: [NA]
Epoch: 9, loss: 8.462668581008911, eval loss: [NA]
Epoch: 10, loss: 8.426257796287537, eval loss: [NA]
Epoch: 11, loss: 8.44321831226349, eval loss: [NA]
Epoch: 12, loss: 8.424851307868957, eval loss: [NA]
Epoch: 13, loss: 8.442578148841857, eval loss: [NA]
Epoch: 14, loss: 8.427820587158203, eval loss: [NA]
Epoch: 15, loss: 8.448101706504822, eval loss: [NA]
Epoch: 16, loss: 8.438402512073516, eval loss: [NA]
Epoch: 17, loss: 8.401740834712982, eval loss: [NA]
Epoch: 18, loss: 8.450379881858826, eval loss: [NA]
Epoch: 19, loss: 8.45571293592453, eval loss: [NA]
Epoch: 20, loss: 8.439230628013611, eval loss: [NA]
Epoch: 21, loss: 8.420403747558593, eval loss: [NA]
Epoch: 22, loss: 8.410785927772523, eval loss: [NA]
Epoch: 23, loss: 8.434599022865296, eval loss: [NA]
Epoch: 24, loss: 8.434984107017517, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.6316678436279295, eval loss: [NA]
Epoch: 1, loss: 3.5721199478149415, eval loss: [NA]
Epoch: 2, loss: 3.5543077575683593, eval loss: [NA]
Epoch: 3, loss: 3.5843315948486327, eval loss: [NA]
Epoch: 4, loss: 3.558103251647949, eval loss: [NA]
Epoch: 5, loss: 3.5607973983764647, eval loss: [NA]
Epoch: 6, loss: 3.5421100814819337, eval loss: [NA]
Epoch: 7, loss: 3.5828087677001954, eval loss: [NA]
Epoch: 8, loss: 3.5172537384033205, eval loss: [NA]
Epoch: 9, loss: 3.5286132904052736, eval loss: [NA]
Epoch: 10, loss: 3.5035942474365234, eval loss: [NA]
Epoch: 11, loss: 3.5319682159423826, eval loss: [NA]
Epoch: 12, loss: 3.5284328994750975, eval loss: [NA]
Epoch: 13, loss: 3.5463490493774414, eval loss: [NA]
Epoch: 14, loss: 3.504233901977539, eval loss: [NA]
Epoch: 15, loss: 3.524049433898926, eval loss: [NA]
Epoch: 16, loss: 3.550931855773926, eval loss: [NA]
Epoch: 17, loss: 3.568707861328125, eval loss: [NA]
Epoch: 18, loss: 3.504957731628418, eval loss: [NA]
Epoch: 19, loss: 3.51506399230957, eval loss: [NA]
Epoch: 20, loss: 3.5059756576538086, eval loss: [NA]
Epoch: 21, loss: 3.5185451431274415, eval loss: [NA]
Epoch: 22, loss: 3.4809220809936523, eval loss: [NA]
Epoch: 23, loss: 3.509604751586914, eval loss: [NA]
Epoch: 24, loss: 3.5265905120849608, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.55747998714447, eval loss: [NA]
Epoch: 1, loss: 8.551845517158508, eval loss: [NA]
Epoch: 2, loss: 8.573726696968079, eval loss: [NA]
Epoch: 3, loss: 8.558158583641053, eval loss: [NA]
Epoch: 4, loss: 8.583054332733154, eval loss: [NA]
Epoch: 5, loss: 8.529694256782532, eval loss: [NA]
Epoch: 6, loss: 8.52176486492157, eval loss: [NA]
Epoch: 7, loss: 8.550457830429076, eval loss: [NA]
Epoch: 8, loss: 8.523743033409119, eval loss: [NA]
Epoch: 9, loss: 8.517973799705505, eval loss: [NA]
Epoch: 10, loss: 8.537745299339294, eval loss: [NA]
Epoch: 11, loss: 8.550083708763122, eval loss: [NA]
Epoch: 12, loss: 8.541605472564697, eval loss: [NA]
Epoch: 13, loss: 8.565754861831666, eval loss: [NA]
Epoch: 14, loss: 8.536913089752197, eval loss: [NA]
Epoch: 15, loss: 8.536499853134154, eval loss: [NA]
Epoch: 16, loss: 8.517709255218506, eval loss: [NA]
Epoch: 17, loss: 8.54538770198822, eval loss: [NA]
Epoch: 18, loss: 8.534172558784485, eval loss: [NA]
Epoch: 19, loss: 8.529377865791322, eval loss: [NA]
Epoch: 20, loss: 8.502892680168152, eval loss: [NA]
Epoch: 21, loss: 8.542437720298768, eval loss: [NA]
Epoch: 22, loss: 8.571944642066956, eval loss: [NA]
Epoch: 23, loss: 8.557970061302186, eval loss: [NA]
Epoch: 24, loss: 8.537853441238404, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5180143936157227, eval loss: [NA]
Epoch: 1, loss: 3.528025323486328, eval loss: [NA]
Epoch: 2, loss: 3.4866531936645506, eval loss: [NA]
Epoch: 3, loss: 3.5219630920410157, eval loss: [NA]
Epoch: 4, loss: 3.5346400741577146, eval loss: [NA]
Epoch: 5, loss: 3.5071251358032227, eval loss: [NA]
Epoch: 6, loss: 3.473862274169922, eval loss: [NA]
Epoch: 7, loss: 3.486174433898926, eval loss: [NA]
Epoch: 8, loss: 3.5440669296264646, eval loss: [NA]
Epoch: 9, loss: 3.509686441040039, eval loss: [NA]
Epoch: 10, loss: 3.539124937438965, eval loss: [NA]
Epoch: 11, loss: 3.4897273544311522, eval loss: [NA]
Epoch: 12, loss: 3.482428796386719, eval loss: [NA]
Epoch: 13, loss: 3.514770512390137, eval loss: [NA]
Epoch: 14, loss: 3.49456037902832, eval loss: [NA]
Epoch: 15, loss: 3.5035406478881836, eval loss: [NA]
Epoch: 16, loss: 3.5061098358154297, eval loss: [NA]
Epoch: 17, loss: 3.4791762802124024, eval loss: [NA]
Epoch: 18, loss: 3.4803461639404296, eval loss: [NA]
Epoch: 19, loss: 3.5010632568359377, eval loss: [NA]
Epoch: 20, loss: 3.4705558853149414, eval loss: [NA]
Epoch: 21, loss: 3.504172627258301, eval loss: [NA]
Epoch: 22, loss: 3.4986336517333982, eval loss: [NA]
Epoch: 23, loss: 3.4843444931030274, eval loss: [NA]
Epoch: 24, loss: 3.4908092346191406, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.80764907836914, eval loss: [NA]
Epoch: 1, loss: 8.816494736671448, eval loss: [NA]
Epoch: 2, loss: 8.794555654525757, eval loss: [NA]
Epoch: 3, loss: 8.806287393569946, eval loss: [NA]
Epoch: 4, loss: 8.81856402873993, eval loss: [NA]
Epoch: 5, loss: 8.810643019676208, eval loss: [NA]
Epoch: 6, loss: 8.786826362609863, eval loss: [NA]
Epoch: 7, loss: 8.798811240196228, eval loss: [NA]
Epoch: 8, loss: 8.801129560470581, eval loss: [NA]
Epoch: 9, loss: 8.80623242378235, eval loss: [NA]
Epoch: 10, loss: 8.819296293258667, eval loss: [NA]
Epoch: 11, loss: 8.793527865409851, eval loss: [NA]
Epoch: 12, loss: 8.832364983558655, eval loss: [NA]
Epoch: 13, loss: 8.82227306842804, eval loss: [NA]
Epoch: 14, loss: 8.814513850212098, eval loss: [NA]
Epoch: 15, loss: 8.81761474609375, eval loss: [NA]
Epoch: 16, loss: 8.792613792419434, eval loss: [NA]
Epoch: 17, loss: 8.82567153453827, eval loss: [NA]
Epoch: 18, loss: 8.805881052017211, eval loss: [NA]
Epoch: 19, loss: 8.810127873420715, eval loss: [NA]
Epoch: 20, loss: 8.807043380737305, eval loss: [NA]
Epoch: 21, loss: 8.814404335021973, eval loss: [NA]
Epoch: 22, loss: 8.788886570930481, eval loss: [NA]
Epoch: 23, loss: 8.799850153923035, eval loss: [NA]
Epoch: 24, loss: 8.803691878318787, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.503700166320801, eval loss: [NA]
Epoch: 1, loss: 3.4790306991577147, eval loss: [NA]
Epoch: 2, loss: 3.516031608581543, eval loss: [NA]
Epoch: 3, loss: 3.5011558349609375, eval loss: [NA]
Epoch: 4, loss: 3.4768641525268555, eval loss: [NA]
Epoch: 5, loss: 3.5183463317871095, eval loss: [NA]
Epoch: 6, loss: 3.524565620422363, eval loss: [NA]
Epoch: 7, loss: 3.4797957641601562, eval loss: [NA]
Epoch: 8, loss: 3.489120002746582, eval loss: [NA]
Epoch: 9, loss: 3.501513949584961, eval loss: [NA]
Epoch: 10, loss: 3.4740716796875, eval loss: [NA]
Epoch: 11, loss: 3.4706505569458006, eval loss: [NA]
Epoch: 12, loss: 3.4976994171142577, eval loss: [NA]
Epoch: 13, loss: 3.535037236022949, eval loss: [NA]
Epoch: 14, loss: 3.4986115158081055, eval loss: [NA]
Epoch: 15, loss: 3.5080080963134765, eval loss: [NA]
Epoch: 16, loss: 3.4865908157348633, eval loss: [NA]
Epoch: 17, loss: 3.4862946685791014, eval loss: [NA]
Epoch: 18, loss: 3.4850838165283204, eval loss: [NA]
Epoch: 19, loss: 3.509402668762207, eval loss: [NA]
Epoch: 20, loss: 3.4686339569091795, eval loss: [NA]
Epoch: 21, loss: 3.478775759887695, eval loss: [NA]
Epoch: 22, loss: 3.4760398849487304, eval loss: [NA]
Epoch: 23, loss: 3.458407487487793, eval loss: [NA]
Epoch: 24, loss: 3.4759945388793945, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.760922784805297, eval loss: [NA]
Epoch: 1, loss: 8.768549127578735, eval loss: [NA]
Epoch: 2, loss: 8.767168822288513, eval loss: [NA]
Epoch: 3, loss: 8.779286456108093, eval loss: [NA]
Epoch: 4, loss: 8.776740102767944, eval loss: [NA]
Epoch: 5, loss: 8.743366079330444, eval loss: [NA]
Epoch: 6, loss: 8.771289710998536, eval loss: [NA]
Epoch: 7, loss: 8.758330755233764, eval loss: [NA]
Epoch: 8, loss: 8.762473149299622, eval loss: [NA]
Epoch: 9, loss: 8.74199107170105, eval loss: [NA]
Epoch: 10, loss: 8.783312659263611, eval loss: [NA]
Epoch: 11, loss: 8.750928320884704, eval loss: [NA]
Epoch: 12, loss: 8.79163643360138, eval loss: [NA]
Epoch: 13, loss: 8.78741117477417, eval loss: [NA]
Epoch: 14, loss: 8.788942255973815, eval loss: [NA]
Epoch: 15, loss: 8.807136058807373, eval loss: [NA]
Epoch: 16, loss: 8.795636610984802, eval loss: [NA]
Epoch: 17, loss: 8.784078702926635, eval loss: [NA]
Epoch: 18, loss: 8.758182673454284, eval loss: [NA]
Epoch: 19, loss: 8.749927244186402, eval loss: [NA]
Epoch: 20, loss: 8.775080952644348, eval loss: [NA]
Epoch: 21, loss: 8.783827114105225, eval loss: [NA]
Epoch: 22, loss: 8.753641538619995, eval loss: [NA]
Epoch: 23, loss: 8.7897261095047, eval loss: [NA]
Epoch: 24, loss: 8.76426927089691, eval loss: [NA]

Runtime:403.23
[3.544232413213293e+16, 0.2634, 0.1596, 0.2351]
[2.481, 0.9251, 0.9375, 0.984]
[2.211, 0.7442, 0.7401, 0.7371]
tensor(0.7679, grad_fn=<MeanBackward0>)
tensor(0.9519, grad_fn=<MeanBackward0>)
tensor([ 3.4554,  1.5289,  2.3524,  0.2800,  3.3143,  1.3698,  2.2622,  0.1851,
         0.7929, -1.3050], grad_fn=<MeanBackward1>)
tensor([0.3397, 0.3801, 1.1418, 1.1989, 0.3425, 0.3415, 1.1277, 1.2903, 0.3361,
        0.3475], grad_fn=<StdBackward1>)
tensor([ 3.5271,  1.5924,  3.1606,  1.0480,  3.3458,  1.6581,  4.4204,  3.4435,
         0.9044, -1.4765])
KL div untrained: 1.9399370838318764e+16
KL div trained: 0.2521
