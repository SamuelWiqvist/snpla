Input args:
Dim: 2
seed: 44
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1853, grad_fn=<MeanBackward0>)
tensor(2.1135, grad_fn=<MeanBackward0>)
tensor([ 0.1642, -0.0866,  0.0481, -0.1356,  0.0220, -0.1960, -0.1921, -0.0342,
         0.0618, -0.3557], grad_fn=<MeanBackward1>)
tensor([1.0346, 0.9515, 1.0215, 1.0640, 1.0106, 0.9709, 1.0078, 1.0023, 1.0210,
        1.0292], grad_fn=<StdBackward1>)
tensor([ 0.2012, -3.5589,  1.1264, -2.0495,  1.4060, -2.2395, -1.8565, -5.0042,
        -0.0859, -2.9873])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.164575616455078, eval loss: [NA]
Epoch: 1, loss: 7.043810705566406, eval loss: [NA]
Epoch: 2, loss: 6.940285791015625, eval loss: [NA]
Epoch: 3, loss: 6.8952818176269535, eval loss: [NA]
Epoch: 4, loss: 6.860353796386719, eval loss: [NA]
Epoch: 5, loss: 6.8254783172607425, eval loss: [NA]
Epoch: 6, loss: 6.676483312988282, eval loss: [NA]
Epoch: 7, loss: 6.416365771484375, eval loss: [NA]
Epoch: 8, loss: 6.1168781188964845, eval loss: [NA]
Epoch: 9, loss: 5.931331536865234, eval loss: [NA]
Epoch: 10, loss: 5.848221377563476, eval loss: [NA]
Epoch: 11, loss: 5.813283445739746, eval loss: [NA]
Epoch: 12, loss: 5.750071913146972, eval loss: [NA]
Epoch: 13, loss: 5.722221368408203, eval loss: [NA]
Epoch: 14, loss: 5.717437622070313, eval loss: [NA]
Epoch: 15, loss: 5.55581724243164, eval loss: [NA]
Epoch: 16, loss: 5.3117784393310545, eval loss: [NA]
Epoch: 17, loss: 4.905688273620606, eval loss: [NA]
Epoch: 18, loss: 4.508502021789551, eval loss: [NA]
Epoch: 19, loss: 4.068204705810547, eval loss: [NA]
Epoch: 20, loss: 3.9126241409301756, eval loss: [NA]
Epoch: 21, loss: 3.830842866516113, eval loss: [NA]
Epoch: 22, loss: 3.785754301452637, eval loss: [NA]
Epoch: 23, loss: 3.728607554626465, eval loss: [NA]
Epoch: 24, loss: 3.6704681900024414, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.1119566467404365, eval loss: [NA]
Epoch: 1, loss: 0.8328233459591865, eval loss: [NA]
Epoch: 2, loss: 0.6665343743562698, eval loss: [NA]
Epoch: 3, loss: 0.5558233933150768, eval loss: [NA]
Epoch: 4, loss: 0.522572984173894, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.676508014202118, eval loss: [NA]
Epoch: 1, loss: 7.6373181676864625, eval loss: [NA]
Epoch: 2, loss: 7.677200274467468, eval loss: [NA]
Epoch: 3, loss: 7.630545794963837, eval loss: [NA]
Epoch: 4, loss: 7.672055428028107, eval loss: [NA]
Epoch: 5, loss: 7.641998431682587, eval loss: [NA]
Epoch: 6, loss: 7.637685642242432, eval loss: [NA]
Epoch: 7, loss: 7.624002649784088, eval loss: [NA]
Epoch: 8, loss: 7.644866139888763, eval loss: [NA]
Epoch: 9, loss: 7.641102180480957, eval loss: [NA]
Epoch: 10, loss: 7.639568164348602, eval loss: [NA]
Epoch: 11, loss: 7.642657089233398, eval loss: [NA]
Epoch: 12, loss: 7.6504326438903805, eval loss: [NA]
Epoch: 13, loss: 7.628599472045899, eval loss: [NA]
Epoch: 14, loss: 7.630267970561981, eval loss: [NA]
Epoch: 15, loss: 7.620492181777954, eval loss: [NA]
Epoch: 16, loss: 7.618971848487854, eval loss: [NA]
Epoch: 17, loss: 7.617470092773438, eval loss: [NA]
Epoch: 18, loss: 7.646419169902802, eval loss: [NA]
Epoch: 19, loss: 7.650086481571197, eval loss: [NA]
Epoch: 20, loss: 7.6560499739646914, eval loss: [NA]
Epoch: 21, loss: 7.634791741371155, eval loss: [NA]
Epoch: 22, loss: 7.652672126293182, eval loss: [NA]
Epoch: 23, loss: 7.662038094997406, eval loss: [NA]
Epoch: 24, loss: 7.624120132923126, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.7108856826782226, eval loss: [NA]
Epoch: 1, loss: 3.7051479812622072, eval loss: [NA]
Epoch: 2, loss: 3.670640588378906, eval loss: [NA]
Epoch: 3, loss: 3.6742675048828124, eval loss: [NA]
Epoch: 4, loss: 3.6187968124389647, eval loss: [NA]
Epoch: 5, loss: 3.6460244506835937, eval loss: [NA]
Epoch: 6, loss: 3.631820474243164, eval loss: [NA]
Epoch: 7, loss: 3.6073603607177733, eval loss: [NA]
Epoch: 8, loss: 3.6159004943847655, eval loss: [NA]
Epoch: 9, loss: 3.5774644973754883, eval loss: [NA]
Epoch: 10, loss: 3.5531350845336913, eval loss: [NA]
Epoch: 11, loss: 3.5948676071166994, eval loss: [NA]
Epoch: 12, loss: 3.605612301635742, eval loss: [NA]
Epoch: 13, loss: 3.6018781341552732, eval loss: [NA]
Epoch: 14, loss: 3.616398245239258, eval loss: [NA]
Epoch: 15, loss: 3.586859507751465, eval loss: [NA]
Epoch: 16, loss: 3.598674401855469, eval loss: [NA]
Epoch: 17, loss: 3.5695695724487306, eval loss: [NA]
Epoch: 18, loss: 3.599613040161133, eval loss: [NA]
Epoch: 19, loss: 3.5630983215332033, eval loss: [NA]
Epoch: 20, loss: 3.5586093521118163, eval loss: [NA]
Epoch: 21, loss: 3.551374043273926, eval loss: [NA]
Epoch: 22, loss: 3.5503807022094724, eval loss: [NA]
Epoch: 23, loss: 3.575224594116211, eval loss: [NA]
Epoch: 24, loss: 3.5566401153564455, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.485519552230835, eval loss: [NA]
Epoch: 1, loss: 7.471025183200836, eval loss: [NA]
Epoch: 2, loss: 7.4573603534698485, eval loss: [NA]
Epoch: 3, loss: 7.483809213638306, eval loss: [NA]
Epoch: 4, loss: 7.4806626868247985, eval loss: [NA]
Epoch: 5, loss: 7.463349788188935, eval loss: [NA]
Epoch: 6, loss: 7.5036145997047425, eval loss: [NA]
Epoch: 7, loss: 7.471700804233551, eval loss: [NA]
Epoch: 8, loss: 7.45589252948761, eval loss: [NA]
Epoch: 9, loss: 7.476742725372315, eval loss: [NA]
Epoch: 10, loss: 7.479021759033203, eval loss: [NA]
Epoch: 11, loss: 7.4777804636955265, eval loss: [NA]
Epoch: 12, loss: 7.4699611616134645, eval loss: [NA]
Epoch: 13, loss: 7.460384850502014, eval loss: [NA]
Epoch: 14, loss: 7.502652728557587, eval loss: [NA]
Epoch: 15, loss: 7.48468691110611, eval loss: [NA]
Epoch: 16, loss: 7.475802369117737, eval loss: [NA]
Epoch: 17, loss: 7.47200496673584, eval loss: [NA]
Epoch: 18, loss: 7.4568923211097715, eval loss: [NA]
Epoch: 19, loss: 7.487507619857788, eval loss: [NA]
Epoch: 20, loss: 7.468622200489044, eval loss: [NA]
Epoch: 21, loss: 7.490937249660492, eval loss: [NA]
Epoch: 22, loss: 7.465397551059723, eval loss: [NA]
Epoch: 23, loss: 7.494892592430115, eval loss: [NA]
Epoch: 24, loss: 7.456012742519379, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.553166813659668, eval loss: [NA]
Epoch: 1, loss: 3.548477131652832, eval loss: [NA]
Epoch: 2, loss: 3.5060834075927736, eval loss: [NA]
Epoch: 3, loss: 3.5038934753417967, eval loss: [NA]
Epoch: 4, loss: 3.5413124267578127, eval loss: [NA]
Epoch: 5, loss: 3.5213724838256835, eval loss: [NA]
Epoch: 6, loss: 3.5299944564819334, eval loss: [NA]
Epoch: 7, loss: 3.513119046020508, eval loss: [NA]
Epoch: 8, loss: 3.504003025817871, eval loss: [NA]
Epoch: 9, loss: 3.505364482116699, eval loss: [NA]
Epoch: 10, loss: 3.5236851272583007, eval loss: [NA]
Epoch: 11, loss: 3.5125875747680664, eval loss: [NA]
Epoch: 12, loss: 3.51075223236084, eval loss: [NA]
Epoch: 13, loss: 3.458852066040039, eval loss: [NA]
Epoch: 14, loss: 3.495625425720215, eval loss: [NA]
Epoch: 15, loss: 3.5467419845581056, eval loss: [NA]
Epoch: 16, loss: 3.529373661804199, eval loss: [NA]
Epoch: 17, loss: 3.502278073120117, eval loss: [NA]
Epoch: 18, loss: 3.51538419342041, eval loss: [NA]
Epoch: 19, loss: 3.522389974975586, eval loss: [NA]
Epoch: 20, loss: 3.5033407501220704, eval loss: [NA]
Epoch: 21, loss: 3.4670165313720704, eval loss: [NA]
Epoch: 22, loss: 3.4824053649902345, eval loss: [NA]
Epoch: 23, loss: 3.4925989791870116, eval loss: [NA]
Epoch: 24, loss: 3.4790758407592772, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.396854341030121, eval loss: [NA]
Epoch: 1, loss: 7.410343010425567, eval loss: [NA]
Epoch: 2, loss: 7.366806988716125, eval loss: [NA]
Epoch: 3, loss: 7.377984955310821, eval loss: [NA]
Epoch: 4, loss: 7.3735500025749205, eval loss: [NA]
Epoch: 5, loss: 7.4021861624717715, eval loss: [NA]
Epoch: 6, loss: 7.387986159324646, eval loss: [NA]
Epoch: 7, loss: 7.390071339607239, eval loss: [NA]
Epoch: 8, loss: 7.40188663482666, eval loss: [NA]
Epoch: 9, loss: 7.3847676730155944, eval loss: [NA]
Epoch: 10, loss: 7.382039811611175, eval loss: [NA]
Epoch: 11, loss: 7.390250763893127, eval loss: [NA]
Epoch: 12, loss: 7.378840551376343, eval loss: [NA]
Epoch: 13, loss: 7.349498689174652, eval loss: [NA]
Epoch: 14, loss: 7.352228085994721, eval loss: [NA]
Epoch: 15, loss: 7.376204941272736, eval loss: [NA]
Epoch: 16, loss: 7.3568585729599, eval loss: [NA]
Epoch: 17, loss: 7.385020091533661, eval loss: [NA]
Epoch: 18, loss: 7.357396864891053, eval loss: [NA]
Epoch: 19, loss: 7.373297486305237, eval loss: [NA]
Epoch: 20, loss: 7.386437957286835, eval loss: [NA]
Epoch: 21, loss: 7.38492288351059, eval loss: [NA]
Epoch: 22, loss: 7.375735399723053, eval loss: [NA]
Epoch: 23, loss: 7.404385704994201, eval loss: [NA]
Epoch: 24, loss: 7.372043516635895, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.5181129730224607, eval loss: [NA]
Epoch: 1, loss: 3.4821009323120116, eval loss: [NA]
Epoch: 2, loss: 3.4746455718994143, eval loss: [NA]
Epoch: 3, loss: 3.502937266540527, eval loss: [NA]
Epoch: 4, loss: 3.476242840576172, eval loss: [NA]
Epoch: 5, loss: 3.504957165527344, eval loss: [NA]
Epoch: 6, loss: 3.493992672729492, eval loss: [NA]
Epoch: 7, loss: 3.4828381912231445, eval loss: [NA]
Epoch: 8, loss: 3.4794095428466796, eval loss: [NA]
Epoch: 9, loss: 3.4677527084350586, eval loss: [NA]
Epoch: 10, loss: 3.4663232131958006, eval loss: [NA]
Epoch: 11, loss: 3.48298408203125, eval loss: [NA]
Epoch: 12, loss: 3.4722894790649415, eval loss: [NA]
Epoch: 13, loss: 3.4666509307861326, eval loss: [NA]
Epoch: 14, loss: 3.4913048751831055, eval loss: [NA]
Epoch: 15, loss: 3.4849946517944335, eval loss: [NA]
Epoch: 16, loss: 3.4376781661987303, eval loss: [NA]
Epoch: 17, loss: 3.477550425720215, eval loss: [NA]
Epoch: 18, loss: 3.486394105529785, eval loss: [NA]
Epoch: 19, loss: 3.4805298614501954, eval loss: [NA]
Epoch: 20, loss: 3.458488932800293, eval loss: [NA]
Epoch: 21, loss: 3.4662736480712892, eval loss: [NA]
Epoch: 22, loss: 3.4635746017456053, eval loss: [NA]
Epoch: 23, loss: 3.473191371154785, eval loss: [NA]
Epoch: 24, loss: 3.441720657348633, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.220697236061096, eval loss: [NA]
Epoch: 1, loss: 7.262206399440766, eval loss: [NA]
Epoch: 2, loss: 7.243931181430817, eval loss: [NA]
Epoch: 3, loss: 7.253726794719696, eval loss: [NA]
Epoch: 4, loss: 7.2741345477104185, eval loss: [NA]
Epoch: 5, loss: 7.253051278591156, eval loss: [NA]
Epoch: 6, loss: 7.272302968502045, eval loss: [NA]
Epoch: 7, loss: 7.251808042526245, eval loss: [NA]
Epoch: 8, loss: 7.252186756134034, eval loss: [NA]
Epoch: 9, loss: 7.284396214485168, eval loss: [NA]
Epoch: 10, loss: 7.26993437051773, eval loss: [NA]
Epoch: 11, loss: 7.233464140892028, eval loss: [NA]
Epoch: 12, loss: 7.277662589550018, eval loss: [NA]
Epoch: 13, loss: 7.245265066623688, eval loss: [NA]
Epoch: 14, loss: 7.2424982118606565, eval loss: [NA]
Epoch: 15, loss: 7.250108723640442, eval loss: [NA]
Epoch: 16, loss: 7.269234457015991, eval loss: [NA]
Epoch: 17, loss: 7.252902739048004, eval loss: [NA]
Epoch: 18, loss: 7.249377717971802, eval loss: [NA]
Epoch: 19, loss: 7.23447713136673, eval loss: [NA]
Epoch: 20, loss: 7.269200184345245, eval loss: [NA]
Epoch: 21, loss: 7.238992214202881, eval loss: [NA]
Epoch: 22, loss: 7.243820114135742, eval loss: [NA]
Epoch: 23, loss: 7.234796974658966, eval loss: [NA]
Epoch: 24, loss: 7.236329336166381, eval loss: [NA]

Runtime:412.57
[1.4770203187839517e+19, 0.2705, 0.1285, 0.1515]
[2.1135, 0.6898, 0.6608, 0.653]
[2.1853, 0.7664, 0.7563, 0.7591]
tensor(0.7418, grad_fn=<MeanBackward0>)
tensor(0.6427, grad_fn=<MeanBackward0>)
tensor([ 0.1525, -3.0525,  0.1979, -3.1140,  1.1239, -2.0847, -1.6509, -5.0433,
         0.0929, -3.2267], grad_fn=<MeanBackward1>)
tensor([1.1741, 1.2350, 1.1921, 1.2527, 0.3153, 0.3520, 0.3182, 0.3417, 0.3087,
        0.3475], grad_fn=<StdBackward1>)
tensor([ 0.2012, -3.5589,  1.1264, -2.0495,  1.4060, -2.2395, -1.8565, -5.0042,
        -0.0859, -2.9873])
KL div untrained: 9.603350649301725e+18
KL div trained: 0.1356
