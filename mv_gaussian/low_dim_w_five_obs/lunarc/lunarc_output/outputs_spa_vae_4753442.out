/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1821, grad_fn=<MeanBackward0>)
tensor(3.0382, grad_fn=<MeanBackward0>)
tensor([ 0.2079,  0.0783,  0.0932, -0.0863,  0.2650, -0.1161,  0.0703,  0.0849,
         0.2169,  0.1928], grad_fn=<MeanBackward1>)
tensor([0.9344, 0.9846, 1.1045, 1.1180, 0.9250, 1.1412, 1.0032, 0.9845, 0.9546,
        1.1073], grad_fn=<StdBackward1>)
tensor([ 0.1527,  5.0296, -0.1720,  4.1212,  1.6518,  6.0040,  0.5523,  4.8475,
         0.9799,  5.5771])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.359817364501954, eval loss: [NA]
Epoch: 1, loss: 7.034242736816406, eval loss: [NA]
Epoch: 2, loss: 6.946281488037109, eval loss: [NA]
Epoch: 3, loss: 6.894840161132812, eval loss: [NA]
Epoch: 4, loss: 6.870933721923828, eval loss: [NA]
Epoch: 5, loss: 6.735977090454101, eval loss: [NA]
Epoch: 6, loss: 6.298501446533203, eval loss: [NA]
Epoch: 7, loss: 5.453647871398926, eval loss: [NA]
Epoch: 8, loss: 5.077699104309082, eval loss: [NA]
Epoch: 9, loss: 4.891500427246093, eval loss: [NA]
Epoch: 10, loss: 4.822751161193848, eval loss: [NA]
Epoch: 11, loss: 4.761954296875, eval loss: [NA]
Epoch: 12, loss: 4.720689077758789, eval loss: [NA]
Epoch: 13, loss: 4.702152026367187, eval loss: [NA]
Epoch: 14, loss: 4.678745295715332, eval loss: [NA]
Epoch: 15, loss: 4.6637244873046875, eval loss: [NA]
Epoch: 16, loss: 4.6528580825805665, eval loss: [NA]
Epoch: 17, loss: 4.627437300109864, eval loss: [NA]
Epoch: 18, loss: 4.6110755020141605, eval loss: [NA]
Epoch: 19, loss: 4.6326653762817385, eval loss: [NA]
Epoch: 20, loss: 4.5542488845825195, eval loss: [NA]
Epoch: 21, loss: 4.567252229309082, eval loss: [NA]
Epoch: 22, loss: 4.295126547241211, eval loss: [NA]
Epoch: 23, loss: 3.8988807205200193, eval loss: [NA]
Epoch: 24, loss: 3.7542479370117188, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.9822543311119079, eval loss: [NA]
Epoch: 1, loss: 0.8970503795146942, eval loss: [NA]
Epoch: 2, loss: 0.6366199911385775, eval loss: [NA]
Epoch: 3, loss: 0.5928384656086564, eval loss: [NA]
Epoch: 4, loss: 0.5326467513293028, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.360134029388428, eval loss: [NA]
Epoch: 1, loss: 6.355956764221191, eval loss: [NA]
Epoch: 2, loss: 6.3117697930336, eval loss: [NA]
Epoch: 3, loss: 6.3278824853897095, eval loss: [NA]
Epoch: 4, loss: 6.321005711555481, eval loss: [NA]
Epoch: 5, loss: 6.320754444599151, eval loss: [NA]
Epoch: 6, loss: 6.340269563198089, eval loss: [NA]
Epoch: 7, loss: 6.3169751286506655, eval loss: [NA]
Epoch: 8, loss: 6.291202354431152, eval loss: [NA]
Epoch: 9, loss: 6.328341028690338, eval loss: [NA]
Epoch: 10, loss: 6.31598450422287, eval loss: [NA]
Epoch: 11, loss: 6.300177471637726, eval loss: [NA]
Epoch: 12, loss: 6.298068842887878, eval loss: [NA]
Epoch: 13, loss: 6.294481041431427, eval loss: [NA]
Epoch: 14, loss: 6.300414752960205, eval loss: [NA]
Epoch: 15, loss: 6.282830743789673, eval loss: [NA]
Epoch: 16, loss: 6.293637766838073, eval loss: [NA]
Epoch: 17, loss: 6.3163001704216, eval loss: [NA]
Epoch: 18, loss: 6.3046008539199825, eval loss: [NA]
Epoch: 19, loss: 6.279404716491699, eval loss: [NA]
Epoch: 20, loss: 6.316533887386322, eval loss: [NA]
Epoch: 21, loss: 6.303576540946961, eval loss: [NA]
Epoch: 22, loss: 6.287984037399292, eval loss: [NA]
Epoch: 23, loss: 6.297105534076691, eval loss: [NA]
Epoch: 24, loss: 6.295418920516968, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.914085693359375, eval loss: [NA]
Epoch: 1, loss: 3.686753073120117, eval loss: [NA]
Epoch: 2, loss: 3.731982696533203, eval loss: [NA]
Epoch: 3, loss: 3.629431269836426, eval loss: [NA]
Epoch: 4, loss: 3.6380908874511717, eval loss: [NA]
Epoch: 5, loss: 3.6267936889648436, eval loss: [NA]
Epoch: 6, loss: 3.6244127548217775, eval loss: [NA]
Epoch: 7, loss: 3.627277305603027, eval loss: [NA]
Epoch: 8, loss: 3.588705310058594, eval loss: [NA]
Epoch: 9, loss: 3.5939143463134764, eval loss: [NA]
Epoch: 10, loss: 3.6081572814941407, eval loss: [NA]
Epoch: 11, loss: 3.6386151458740232, eval loss: [NA]
Epoch: 12, loss: 3.5756066802978514, eval loss: [NA]
Epoch: 13, loss: 3.648223306274414, eval loss: [NA]
Epoch: 14, loss: 3.5938911499023436, eval loss: [NA]
Epoch: 15, loss: 3.567883087158203, eval loss: [NA]
Epoch: 16, loss: 3.5768880599975588, eval loss: [NA]
Epoch: 17, loss: 3.546153692626953, eval loss: [NA]
Epoch: 18, loss: 3.5850634826660155, eval loss: [NA]
Epoch: 19, loss: 3.569322296142578, eval loss: [NA]
Epoch: 20, loss: 3.5825257873535157, eval loss: [NA]
Epoch: 21, loss: 3.577496546936035, eval loss: [NA]
Epoch: 22, loss: 3.565543440246582, eval loss: [NA]
Epoch: 23, loss: 3.600463276672363, eval loss: [NA]
Epoch: 24, loss: 3.617661492919922, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.905920705795288, eval loss: [NA]
Epoch: 1, loss: 5.9064022827148435, eval loss: [NA]
Epoch: 2, loss: 5.854842305183411, eval loss: [NA]
Epoch: 3, loss: 5.885156280994416, eval loss: [NA]
Epoch: 4, loss: 5.877180233001709, eval loss: [NA]
Epoch: 5, loss: 5.896163322925568, eval loss: [NA]
Epoch: 6, loss: 5.893074932098389, eval loss: [NA]
Epoch: 7, loss: 5.8814432907104495, eval loss: [NA]
Epoch: 8, loss: 5.8891448140144345, eval loss: [NA]
Epoch: 9, loss: 5.887110092639923, eval loss: [NA]
Epoch: 10, loss: 5.86913245677948, eval loss: [NA]
Epoch: 11, loss: 5.880007882118225, eval loss: [NA]
Epoch: 12, loss: 5.882285554409027, eval loss: [NA]
Epoch: 13, loss: 5.91569355726242, eval loss: [NA]
Epoch: 14, loss: 5.890870573520661, eval loss: [NA]
Epoch: 15, loss: 5.891378140449524, eval loss: [NA]
Epoch: 16, loss: 5.844453268051147, eval loss: [NA]
Epoch: 17, loss: 5.876048951148987, eval loss: [NA]
Epoch: 18, loss: 5.846094651222229, eval loss: [NA]
Epoch: 19, loss: 5.862145402431488, eval loss: [NA]
Epoch: 20, loss: 5.870958261489868, eval loss: [NA]
Epoch: 21, loss: 5.877015743255615, eval loss: [NA]
Epoch: 22, loss: 5.856893455982208, eval loss: [NA]
Epoch: 23, loss: 5.862057762145996, eval loss: [NA]
Epoch: 24, loss: 5.876066415309906, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.62319806060791, eval loss: [NA]
Epoch: 1, loss: 3.5683782791137695, eval loss: [NA]
Epoch: 2, loss: 3.555488816833496, eval loss: [NA]
Epoch: 3, loss: 3.5635317459106446, eval loss: [NA]
Epoch: 4, loss: 3.5298201736450197, eval loss: [NA]
Epoch: 5, loss: 3.5437668380737306, eval loss: [NA]
Epoch: 6, loss: 3.585681976318359, eval loss: [NA]
Epoch: 7, loss: 3.5417154541015625, eval loss: [NA]
Epoch: 8, loss: 3.5455865692138673, eval loss: [NA]
Epoch: 9, loss: 3.545765182495117, eval loss: [NA]
Epoch: 10, loss: 3.503397010803223, eval loss: [NA]
Epoch: 11, loss: 3.5527948959350586, eval loss: [NA]
Epoch: 12, loss: 3.5556257873535158, eval loss: [NA]
Epoch: 13, loss: 3.5701341552734376, eval loss: [NA]
Epoch: 14, loss: 3.553315591430664, eval loss: [NA]
Epoch: 15, loss: 3.534403239440918, eval loss: [NA]
Epoch: 16, loss: 3.5455753982543947, eval loss: [NA]
Epoch: 17, loss: 3.5349296752929686, eval loss: [NA]
Epoch: 18, loss: 3.5017767517089844, eval loss: [NA]
Epoch: 19, loss: 3.5463401596069337, eval loss: [NA]
Epoch: 20, loss: 3.5521610580444336, eval loss: [NA]
Epoch: 21, loss: 3.552564010620117, eval loss: [NA]
Epoch: 22, loss: 3.5316752532958984, eval loss: [NA]
Epoch: 23, loss: 3.486784489440918, eval loss: [NA]
Epoch: 24, loss: 3.5188066833496094, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.034776456356049, eval loss: [NA]
Epoch: 1, loss: 6.049482009410858, eval loss: [NA]
Epoch: 2, loss: 6.0464169311523435, eval loss: [NA]
Epoch: 3, loss: 6.086833674907684, eval loss: [NA]
Epoch: 4, loss: 6.049289617538452, eval loss: [NA]
Epoch: 5, loss: 6.069147505760193, eval loss: [NA]
Epoch: 6, loss: 6.079618029594421, eval loss: [NA]
Epoch: 7, loss: 6.025387473106385, eval loss: [NA]
Epoch: 8, loss: 6.027263545989991, eval loss: [NA]
Epoch: 9, loss: 6.054808020591736, eval loss: [NA]
Epoch: 10, loss: 6.046356983184815, eval loss: [NA]
Epoch: 11, loss: 6.0849316740036015, eval loss: [NA]
Epoch: 12, loss: 6.0721404957771306, eval loss: [NA]
Epoch: 13, loss: 6.057275476455689, eval loss: [NA]
Epoch: 14, loss: 6.055194871425629, eval loss: [NA]
Epoch: 15, loss: 6.043392672538757, eval loss: [NA]
Epoch: 16, loss: 6.060849759578705, eval loss: [NA]
Epoch: 17, loss: 6.068595449924469, eval loss: [NA]
Epoch: 18, loss: 6.071463415622711, eval loss: [NA]
Epoch: 19, loss: 6.047702822685242, eval loss: [NA]
Epoch: 20, loss: 6.029318370819092, eval loss: [NA]
Epoch: 21, loss: 6.074357032775879, eval loss: [NA]
Epoch: 22, loss: 6.054421801567077, eval loss: [NA]
Epoch: 23, loss: 6.078410561084747, eval loss: [NA]
Epoch: 24, loss: 6.0783165121078495, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.556190005493164, eval loss: [NA]
Epoch: 1, loss: 3.49739737701416, eval loss: [NA]
Epoch: 2, loss: 3.4901063751220702, eval loss: [NA]
Epoch: 3, loss: 3.490569184875488, eval loss: [NA]
Epoch: 4, loss: 3.477755500793457, eval loss: [NA]
Epoch: 5, loss: 3.4834846923828127, eval loss: [NA]
Epoch: 6, loss: 3.510524612426758, eval loss: [NA]
Epoch: 7, loss: 3.496881851196289, eval loss: [NA]
Epoch: 8, loss: 3.4696849029541017, eval loss: [NA]
Epoch: 9, loss: 3.4855886138916015, eval loss: [NA]
Epoch: 10, loss: 3.4922301971435545, eval loss: [NA]
Epoch: 11, loss: 3.476625517272949, eval loss: [NA]
Epoch: 12, loss: 3.4925486572265627, eval loss: [NA]
Epoch: 13, loss: 3.5220113510131834, eval loss: [NA]
Epoch: 14, loss: 3.5176122100830076, eval loss: [NA]
Epoch: 15, loss: 3.505671627807617, eval loss: [NA]
Epoch: 16, loss: 3.43596981048584, eval loss: [NA]
Epoch: 17, loss: 3.4786798263549805, eval loss: [NA]
Epoch: 18, loss: 3.4601612075805663, eval loss: [NA]
Epoch: 19, loss: 3.448499508666992, eval loss: [NA]
Epoch: 20, loss: 3.484217266845703, eval loss: [NA]
Epoch: 21, loss: 3.485429281616211, eval loss: [NA]
Epoch: 22, loss: 3.5068354598999023, eval loss: [NA]
Epoch: 23, loss: 3.496447152709961, eval loss: [NA]
Epoch: 24, loss: 3.481443440246582, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.827992393970489, eval loss: [NA]
Epoch: 1, loss: 5.808550369739533, eval loss: [NA]
Epoch: 2, loss: 5.806161434650421, eval loss: [NA]
Epoch: 3, loss: 5.807133584022522, eval loss: [NA]
Epoch: 4, loss: 5.788971405029297, eval loss: [NA]
Epoch: 5, loss: 5.808111863136292, eval loss: [NA]
Epoch: 6, loss: 5.823404126167297, eval loss: [NA]
Epoch: 7, loss: 5.814458167552948, eval loss: [NA]
Epoch: 8, loss: 5.80188716173172, eval loss: [NA]
Epoch: 9, loss: 5.817416291236878, eval loss: [NA]
Epoch: 10, loss: 5.828258333206176, eval loss: [NA]
Epoch: 11, loss: 5.805200860500336, eval loss: [NA]
Epoch: 12, loss: 5.803664462566376, eval loss: [NA]
Epoch: 13, loss: 5.815304486751557, eval loss: [NA]
Epoch: 14, loss: 5.790683219432831, eval loss: [NA]
Epoch: 15, loss: 5.811482927799225, eval loss: [NA]
Epoch: 16, loss: 5.806295340061188, eval loss: [NA]
Epoch: 17, loss: 5.7923414158821105, eval loss: [NA]
Epoch: 18, loss: 5.814728763103485, eval loss: [NA]
Epoch: 19, loss: 5.837425932884217, eval loss: [NA]
Epoch: 20, loss: 5.811855385303497, eval loss: [NA]
Epoch: 21, loss: 5.820744142532349, eval loss: [NA]
Epoch: 22, loss: 5.803542425632477, eval loss: [NA]
Epoch: 23, loss: 5.787498548030853, eval loss: [NA]
Epoch: 24, loss: 5.79145705461502, eval loss: [NA]

Runtime:379.0
[494.4843, 0.2278, 0.1529, 0.1158]
[3.0382, 0.6637, 0.649, 0.656]
[2.1821, 0.7533, 0.7543, 0.7597]
tensor(0.7531, grad_fn=<MeanBackward0>)
tensor(0.6347, grad_fn=<MeanBackward0>)
tensor([ 0.1014,  4.2597, -0.2191,  3.9421,  1.6352,  5.9133,  0.5648,  4.7634,
         0.0873,  4.3699], grad_fn=<MeanBackward1>)
tensor([1.1588, 1.2407, 0.3104, 0.3523, 0.3005, 0.3379, 0.3053, 0.3464, 1.1728,
        1.3181], grad_fn=<StdBackward1>)
tensor([ 0.1527,  5.0296, -0.1720,  4.1212,  1.6518,  6.0040,  0.5523,  4.8475,
         0.9799,  5.5771])
KL div untrained: 452.7418
KL div trained: 0.1101
