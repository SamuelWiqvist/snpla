/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1772, grad_fn=<MeanBackward0>)
tensor(1.7770, grad_fn=<MeanBackward0>)
tensor([-0.0506,  0.1540, -0.1894, -0.2461,  0.1174,  0.0462, -0.1512,  0.0895,
        -0.0081, -0.0786], grad_fn=<MeanBackward1>)
tensor([1.0568, 1.0103, 1.0543, 0.8843, 1.0090, 0.9913, 0.9410, 0.9384, 1.1012,
        0.9803], grad_fn=<StdBackward1>)
tensor([-1.6616, -2.1609, -1.7456, -1.7803, -1.3209, -0.8756, -2.7388, -3.3261,
        -0.3453, -0.9167])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.772686083984375, eval loss: [NA]
Epoch: 1, loss: 7.129396469116211, eval loss: [NA]
Epoch: 2, loss: 7.023309698486328, eval loss: [NA]
Epoch: 3, loss: 6.996195751953125, eval loss: [NA]
Epoch: 4, loss: 6.986778674316406, eval loss: [NA]
Epoch: 5, loss: 6.9442283630371096, eval loss: [NA]
Epoch: 6, loss: 6.9395225036621095, eval loss: [NA]
Epoch: 7, loss: 6.8969580230712895, eval loss: [NA]
Epoch: 8, loss: 6.8766009765625, eval loss: [NA]
Epoch: 9, loss: 6.860938607788086, eval loss: [NA]
Epoch: 10, loss: 6.8687710968017575, eval loss: [NA]
Epoch: 11, loss: 6.827457556152344, eval loss: [NA]
Epoch: 12, loss: 6.767887097167969, eval loss: [NA]
Epoch: 13, loss: 6.664155984497071, eval loss: [NA]
Epoch: 14, loss: 6.4863126220703125, eval loss: [NA]
Epoch: 15, loss: 6.19898755645752, eval loss: [NA]
Epoch: 16, loss: 5.94494813079834, eval loss: [NA]
Epoch: 17, loss: 5.485944914245605, eval loss: [NA]
Epoch: 18, loss: 5.0987207809448245, eval loss: [NA]
Epoch: 19, loss: 4.8795098831176755, eval loss: [NA]
Epoch: 20, loss: 4.798458682250977, eval loss: [NA]
Epoch: 21, loss: 4.741134480285645, eval loss: [NA]
Epoch: 22, loss: 4.697279197692871, eval loss: [NA]
Epoch: 23, loss: 4.6946626419067385, eval loss: [NA]
Epoch: 24, loss: 4.597783583068848, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.2052656957507133, eval loss: [NA]
Epoch: 1, loss: 0.8519833643734455, eval loss: [NA]
Epoch: 2, loss: 0.6416000525653363, eval loss: [NA]
Epoch: 3, loss: 0.5888999492675066, eval loss: [NA]
Epoch: 4, loss: 0.5079273119568825, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.465316932201386, eval loss: [NA]
Epoch: 1, loss: 8.443700280189514, eval loss: [NA]
Epoch: 2, loss: 8.440988459587096, eval loss: [NA]
Epoch: 3, loss: 8.421362812519073, eval loss: [NA]
Epoch: 4, loss: 8.420969519615173, eval loss: [NA]
Epoch: 5, loss: 8.40021842956543, eval loss: [NA]
Epoch: 6, loss: 8.388126919269562, eval loss: [NA]
Epoch: 7, loss: 8.416489679813385, eval loss: [NA]
Epoch: 8, loss: 8.42525002002716, eval loss: [NA]
Epoch: 9, loss: 8.423652772903443, eval loss: [NA]
Epoch: 10, loss: 8.42068867444992, eval loss: [NA]
Epoch: 11, loss: 8.40413957118988, eval loss: [NA]
Epoch: 12, loss: 8.409964463710786, eval loss: [NA]
Epoch: 13, loss: 8.412405471801758, eval loss: [NA]
Epoch: 14, loss: 8.386518385410309, eval loss: [NA]
Epoch: 15, loss: 8.404178519248962, eval loss: [NA]
Epoch: 16, loss: 8.410850360393525, eval loss: [NA]
Epoch: 17, loss: 8.405674169063568, eval loss: [NA]
Epoch: 18, loss: 8.411514844894409, eval loss: [NA]
Epoch: 19, loss: 8.39373473405838, eval loss: [NA]
Epoch: 20, loss: 8.389692890644074, eval loss: [NA]
Epoch: 21, loss: 8.389742424488068, eval loss: [NA]
Epoch: 22, loss: 8.392065780162811, eval loss: [NA]
Epoch: 23, loss: 8.410510053634644, eval loss: [NA]
Epoch: 24, loss: 8.418957748413085, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.461032618713379, eval loss: [NA]
Epoch: 1, loss: 4.462325115966797, eval loss: [NA]
Epoch: 2, loss: 4.410712071228027, eval loss: [NA]
Epoch: 3, loss: 4.38818486328125, eval loss: [NA]
Epoch: 4, loss: 4.386034547424316, eval loss: [NA]
Epoch: 5, loss: 4.172927700805664, eval loss: [NA]
Epoch: 6, loss: 3.886120330810547, eval loss: [NA]
Epoch: 7, loss: 3.6621725173950197, eval loss: [NA]
Epoch: 8, loss: 3.5645788024902343, eval loss: [NA]
Epoch: 9, loss: 3.5430044631958006, eval loss: [NA]
Epoch: 10, loss: 3.543538279724121, eval loss: [NA]
Epoch: 11, loss: 3.4967452362060545, eval loss: [NA]
Epoch: 12, loss: 3.5168290267944338, eval loss: [NA]
Epoch: 13, loss: 3.477436149597168, eval loss: [NA]
Epoch: 14, loss: 3.478563262939453, eval loss: [NA]
Epoch: 15, loss: 3.4745357009887696, eval loss: [NA]
Epoch: 16, loss: 3.465159364318848, eval loss: [NA]
Epoch: 17, loss: 3.4333495788574218, eval loss: [NA]
Epoch: 18, loss: 3.4412187576293944, eval loss: [NA]
Epoch: 19, loss: 3.477937353515625, eval loss: [NA]
Epoch: 20, loss: 3.4453625778198242, eval loss: [NA]
Epoch: 21, loss: 3.3872913024902345, eval loss: [NA]
Epoch: 22, loss: 3.4293904678344727, eval loss: [NA]
Epoch: 23, loss: 3.4211247650146484, eval loss: [NA]
Epoch: 24, loss: 3.4215726501464845, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.095221495628357, eval loss: [NA]
Epoch: 1, loss: 7.114122936725616, eval loss: [NA]
Epoch: 2, loss: 7.115320770740509, eval loss: [NA]
Epoch: 3, loss: 7.1061793804168705, eval loss: [NA]
Epoch: 4, loss: 7.128567004203797, eval loss: [NA]
Epoch: 5, loss: 7.108404715061187, eval loss: [NA]
Epoch: 6, loss: 7.107928538322449, eval loss: [NA]
Epoch: 7, loss: 7.118091192245483, eval loss: [NA]
Epoch: 8, loss: 7.108877184391022, eval loss: [NA]
Epoch: 9, loss: 7.086510317325592, eval loss: [NA]
Epoch: 10, loss: 7.118596935272217, eval loss: [NA]
Epoch: 11, loss: 7.088623945713043, eval loss: [NA]
Epoch: 12, loss: 7.114238862991333, eval loss: [NA]
Epoch: 13, loss: 7.102724409103393, eval loss: [NA]
Epoch: 14, loss: 7.091539762020111, eval loss: [NA]
Epoch: 15, loss: 7.107077348232269, eval loss: [NA]
Epoch: 16, loss: 7.08516273021698, eval loss: [NA]
Epoch: 17, loss: 7.114074461460113, eval loss: [NA]
Epoch: 18, loss: 7.096499893665314, eval loss: [NA]
Epoch: 19, loss: 7.081846392154693, eval loss: [NA]
Epoch: 20, loss: 7.11321496963501, eval loss: [NA]
Epoch: 21, loss: 7.103150548934937, eval loss: [NA]
Epoch: 22, loss: 7.125766406059265, eval loss: [NA]
Epoch: 23, loss: 7.112416698932647, eval loss: [NA]
Epoch: 24, loss: 7.1256460857391355, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5075253784179687, eval loss: [NA]
Epoch: 1, loss: 3.5031352447509767, eval loss: [NA]
Epoch: 2, loss: 3.4947687622070314, eval loss: [NA]
Epoch: 3, loss: 3.458241404724121, eval loss: [NA]
Epoch: 4, loss: 3.5292288330078123, eval loss: [NA]
Epoch: 5, loss: 3.502036178588867, eval loss: [NA]
Epoch: 6, loss: 3.475347552490234, eval loss: [NA]
Epoch: 7, loss: 3.4802267990112306, eval loss: [NA]
Epoch: 8, loss: 3.4758830139160155, eval loss: [NA]
Epoch: 9, loss: 3.533470204162598, eval loss: [NA]
Epoch: 10, loss: 3.4631222976684573, eval loss: [NA]
Epoch: 11, loss: 3.4917636642456054, eval loss: [NA]
Epoch: 12, loss: 3.450079830932617, eval loss: [NA]
Epoch: 13, loss: 3.468617529296875, eval loss: [NA]
Epoch: 14, loss: 3.4166005447387695, eval loss: [NA]
Epoch: 15, loss: 3.449774858093262, eval loss: [NA]
Epoch: 16, loss: 3.502927755737305, eval loss: [NA]
Epoch: 17, loss: 3.441428125, eval loss: [NA]
Epoch: 18, loss: 3.442549899291992, eval loss: [NA]
Epoch: 19, loss: 3.4922093307495117, eval loss: [NA]
Epoch: 20, loss: 3.4545028762817385, eval loss: [NA]
Epoch: 21, loss: 3.481588806152344, eval loss: [NA]
Epoch: 22, loss: 3.4139650329589846, eval loss: [NA]
Epoch: 23, loss: 3.4289344329833984, eval loss: [NA]
Epoch: 24, loss: 3.4685195861816407, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.274228088855743, eval loss: [NA]
Epoch: 1, loss: 7.260072550773621, eval loss: [NA]
Epoch: 2, loss: 7.268743953704834, eval loss: [NA]
Epoch: 3, loss: 7.270451822280884, eval loss: [NA]
Epoch: 4, loss: 7.286385135650635, eval loss: [NA]
Epoch: 5, loss: 7.263054506778717, eval loss: [NA]
Epoch: 6, loss: 7.255957255363464, eval loss: [NA]
Epoch: 7, loss: 7.264403111934662, eval loss: [NA]
Epoch: 8, loss: 7.277882745265961, eval loss: [NA]
Epoch: 9, loss: 7.242331736087799, eval loss: [NA]
Epoch: 10, loss: 7.272251853942871, eval loss: [NA]
Epoch: 11, loss: 7.264346077442169, eval loss: [NA]
Epoch: 12, loss: 7.253340067863465, eval loss: [NA]
Epoch: 13, loss: 7.245400116443634, eval loss: [NA]
Epoch: 14, loss: 7.268018996715545, eval loss: [NA]
Epoch: 15, loss: 7.253805100917816, eval loss: [NA]
Epoch: 16, loss: 7.2788513660430905, eval loss: [NA]
Epoch: 17, loss: 7.286699137687683, eval loss: [NA]
Epoch: 18, loss: 7.27543167591095, eval loss: [NA]
Epoch: 19, loss: 7.265427846908569, eval loss: [NA]
Epoch: 20, loss: 7.2575183415412905, eval loss: [NA]
Epoch: 21, loss: 7.257174823284149, eval loss: [NA]
Epoch: 22, loss: 7.239358582496643, eval loss: [NA]
Epoch: 23, loss: 7.259604866504669, eval loss: [NA]
Epoch: 24, loss: 7.265872871875763, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.3736031158447264, eval loss: [NA]
Epoch: 1, loss: 3.388230416870117, eval loss: [NA]
Epoch: 2, loss: 3.3571929107666016, eval loss: [NA]
Epoch: 3, loss: 3.3475628662109376, eval loss: [NA]
Epoch: 4, loss: 3.3501912353515624, eval loss: [NA]
Epoch: 5, loss: 3.3604469268798827, eval loss: [NA]
Epoch: 6, loss: 3.355153855895996, eval loss: [NA]
Epoch: 7, loss: 3.3713937927246094, eval loss: [NA]
Epoch: 8, loss: 3.3438310394287107, eval loss: [NA]
Epoch: 9, loss: 3.361769494628906, eval loss: [NA]
Epoch: 10, loss: 3.3584824676513674, eval loss: [NA]
Epoch: 11, loss: 3.359911445617676, eval loss: [NA]
Epoch: 12, loss: 3.3625934432983398, eval loss: [NA]
Epoch: 13, loss: 3.3558475357055664, eval loss: [NA]
Epoch: 14, loss: 3.3802736877441406, eval loss: [NA]
Epoch: 15, loss: 3.33198770904541, eval loss: [NA]
Epoch: 16, loss: 3.3322731826782226, eval loss: [NA]
Epoch: 17, loss: 3.3222053741455078, eval loss: [NA]
Epoch: 18, loss: 3.329223309326172, eval loss: [NA]
Epoch: 19, loss: 3.307662873840332, eval loss: [NA]
Epoch: 20, loss: 3.3739684600830078, eval loss: [NA]
Epoch: 21, loss: 3.3518711959838865, eval loss: [NA]
Epoch: 22, loss: 3.318838845825195, eval loss: [NA]
Epoch: 23, loss: 3.346266453552246, eval loss: [NA]
Epoch: 24, loss: 3.308375444030762, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.114570124149322, eval loss: [NA]
Epoch: 1, loss: 7.134450266361236, eval loss: [NA]
Epoch: 2, loss: 7.160516004562378, eval loss: [NA]
Epoch: 3, loss: 7.156242091655731, eval loss: [NA]
Epoch: 4, loss: 7.1472527480125425, eval loss: [NA]
Epoch: 5, loss: 7.165391886234284, eval loss: [NA]
Epoch: 6, loss: 7.164617562294007, eval loss: [NA]
Epoch: 7, loss: 7.156563596725464, eval loss: [NA]
Epoch: 8, loss: 7.140867178440094, eval loss: [NA]
Epoch: 9, loss: 7.139058320522309, eval loss: [NA]
Epoch: 10, loss: 7.155267555713653, eval loss: [NA]
Epoch: 11, loss: 7.110180678367615, eval loss: [NA]
Epoch: 12, loss: 7.148172218799591, eval loss: [NA]
Epoch: 13, loss: 7.140150947570801, eval loss: [NA]
Epoch: 14, loss: 7.139372591972351, eval loss: [NA]
Epoch: 15, loss: 7.158326942920684, eval loss: [NA]
Epoch: 16, loss: 7.148476116657257, eval loss: [NA]
Epoch: 17, loss: 7.146808395385742, eval loss: [NA]
Epoch: 18, loss: 7.148928778171539, eval loss: [NA]
Epoch: 19, loss: 7.126715319156647, eval loss: [NA]
Epoch: 20, loss: 7.1508725428581235, eval loss: [NA]
Epoch: 21, loss: 7.125443024635315, eval loss: [NA]
Epoch: 22, loss: 7.132262418270111, eval loss: [NA]
Epoch: 23, loss: 7.141646435260773, eval loss: [NA]
Epoch: 24, loss: 7.130872790813446, eval loss: [NA]

Runtime:389.4
[3568.0567, 0.4701, 0.1458, 0.1172]
[1.777, 0.9177, 0.8031, 0.8256]
[2.1772, 0.8748, 0.7166, 0.7324]
tensor(0.7492, grad_fn=<MeanBackward0>)
tensor(0.8244, grad_fn=<MeanBackward0>)
tensor([-1.7889, -2.0458, -1.6277, -1.8439, -1.0079, -1.2039, -1.2888, -1.4129,
        -1.3047, -1.5996], grad_fn=<MeanBackward1>)
tensor([0.3146, 0.3328, 0.3127, 0.3335, 0.3011, 0.3523, 1.3818, 1.4151, 1.4304,
        1.5357], grad_fn=<StdBackward1>)
tensor([-1.6616, -2.1609, -1.7456, -1.7803, -1.3209, -0.8756, -2.7388, -3.3261,
        -0.3453, -0.9167])
KL div untrained: 3115.0612
KL div trained: 0.0591
