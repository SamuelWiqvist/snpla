/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1580, grad_fn=<MeanBackward0>)
tensor(1.4855, grad_fn=<MeanBackward0>)
tensor([ 0.0137, -0.0313,  0.0624, -0.3587,  0.2313, -0.0715, -0.1071,  0.1075,
         0.1896, -0.1145], grad_fn=<MeanBackward1>)
tensor([0.9378, 0.8848, 0.9345, 1.0308, 0.9687, 0.9609, 0.9917, 0.9539, 0.9669,
        1.0252], grad_fn=<StdBackward1>)
tensor([ 2.7419,  1.4270,  1.9009,  0.2732,  1.8506, -0.0556,  2.1935,  1.1706,
         0.1064, -0.9865])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.791158099365234, eval loss: [NA]
Epoch: 1, loss: 7.11554833984375, eval loss: [NA]
Epoch: 2, loss: 7.078730880737305, eval loss: [NA]
Epoch: 3, loss: 6.968369006347657, eval loss: [NA]
Epoch: 4, loss: 6.951065740966797, eval loss: [NA]
Epoch: 5, loss: 6.89112985534668, eval loss: [NA]
Epoch: 6, loss: 6.807475378417969, eval loss: [NA]
Epoch: 7, loss: 6.688461102294922, eval loss: [NA]
Epoch: 8, loss: 6.41519069519043, eval loss: [NA]
Epoch: 9, loss: 6.274717553710937, eval loss: [NA]
Epoch: 10, loss: 6.123030229187012, eval loss: [NA]
Epoch: 11, loss: 5.975249291992188, eval loss: [NA]
Epoch: 12, loss: 5.834976119995117, eval loss: [NA]
Epoch: 13, loss: 5.625531932067871, eval loss: [NA]
Epoch: 14, loss: 5.0206163833618165, eval loss: [NA]
Epoch: 15, loss: 4.545820533752441, eval loss: [NA]
Epoch: 16, loss: 4.251005000305176, eval loss: [NA]
Epoch: 17, loss: 3.9977163650512697, eval loss: [NA]
Epoch: 18, loss: 3.936149826049805, eval loss: [NA]
Epoch: 19, loss: 3.833459880065918, eval loss: [NA]
Epoch: 20, loss: 3.7826406860351565, eval loss: [NA]
Epoch: 21, loss: 3.766543379211426, eval loss: [NA]
Epoch: 22, loss: 3.7655189514160154, eval loss: [NA]
Epoch: 23, loss: 3.696775917053223, eval loss: [NA]
Epoch: 24, loss: 3.6825504318237305, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 89.57188809633254, eval loss: [NA]
Epoch: 1, loss: 6.431763768196106, eval loss: [NA]
Epoch: 2, loss: 6.42773054599762, eval loss: [NA]
Epoch: 3, loss: 6.402658331394195, eval loss: [NA]
Epoch: 4, loss: 6.377553436756134, eval loss: [NA]
Epoch: 5, loss: 6.396691887378693, eval loss: [NA]
Epoch: 6, loss: 6.398087832927704, eval loss: [NA]
Epoch: 7, loss: 6.411629195213318, eval loss: [NA]
Epoch: 8, loss: 6.401532678604126, eval loss: [NA]
Epoch: 9, loss: 6.379163193702698, eval loss: [NA]
Epoch: 10, loss: 6.380627808570861, eval loss: [NA]
Epoch: 11, loss: 6.375200824737549, eval loss: [NA]
Epoch: 12, loss: 6.386165249347687, eval loss: [NA]
Epoch: 13, loss: 6.3598264741897585, eval loss: [NA]
Epoch: 14, loss: 6.373950045108796, eval loss: [NA]
Epoch: 15, loss: 6.404375097751617, eval loss: [NA]
Epoch: 16, loss: 6.38627658367157, eval loss: [NA]
Epoch: 17, loss: 6.401631405353546, eval loss: [NA]
Epoch: 18, loss: 6.3919517993927, eval loss: [NA]
Epoch: 19, loss: 6.387218794822693, eval loss: [NA]
Epoch: 20, loss: 6.384286489486694, eval loss: [NA]
Epoch: 21, loss: 6.3959360337257385, eval loss: [NA]
Epoch: 22, loss: 6.3917563533782955, eval loss: [NA]
Epoch: 23, loss: 6.379040989875794, eval loss: [NA]
Epoch: 24, loss: 6.3710294485092165, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.6293102920532228, eval loss: [NA]
Epoch: 1, loss: 3.602299685668945, eval loss: [NA]
Epoch: 2, loss: 3.6174211959838867, eval loss: [NA]
Epoch: 3, loss: 3.580560055541992, eval loss: [NA]
Epoch: 4, loss: 3.588295216369629, eval loss: [NA]
Epoch: 5, loss: 3.5912807510375977, eval loss: [NA]
Epoch: 6, loss: 3.5417362594604493, eval loss: [NA]
Epoch: 7, loss: 3.5607892715454104, eval loss: [NA]
Epoch: 8, loss: 3.603985972595215, eval loss: [NA]
Epoch: 9, loss: 3.553364610290527, eval loss: [NA]
Epoch: 10, loss: 3.559734190368652, eval loss: [NA]
Epoch: 11, loss: 3.547521710205078, eval loss: [NA]
Epoch: 12, loss: 3.5364799560546873, eval loss: [NA]
Epoch: 13, loss: 3.543002328491211, eval loss: [NA]
Epoch: 14, loss: 3.558515138244629, eval loss: [NA]
Epoch: 15, loss: 3.558106625366211, eval loss: [NA]
Epoch: 16, loss: 3.567214189147949, eval loss: [NA]
Epoch: 17, loss: 3.56966106262207, eval loss: [NA]
Epoch: 18, loss: 3.555002261352539, eval loss: [NA]
Epoch: 19, loss: 3.543507652282715, eval loss: [NA]
Epoch: 20, loss: 3.5146692993164064, eval loss: [NA]
Epoch: 21, loss: 3.5276257263183592, eval loss: [NA]
Epoch: 22, loss: 3.5353940048217773, eval loss: [NA]
Epoch: 23, loss: 3.537900619506836, eval loss: [NA]
Epoch: 24, loss: 3.514344709777832, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.323541061878204, eval loss: [NA]
Epoch: 1, loss: 6.310020279884339, eval loss: [NA]
Epoch: 2, loss: 6.320548145771027, eval loss: [NA]
Epoch: 3, loss: 6.316762247085571, eval loss: [NA]
Epoch: 4, loss: 6.315270900726318, eval loss: [NA]
Epoch: 5, loss: 6.295179793834686, eval loss: [NA]
Epoch: 6, loss: 6.30699898481369, eval loss: [NA]
Epoch: 7, loss: 6.29882078409195, eval loss: [NA]
Epoch: 8, loss: 6.3139345479011535, eval loss: [NA]
Epoch: 9, loss: 6.295115222930908, eval loss: [NA]
Epoch: 10, loss: 6.307752521038055, eval loss: [NA]
Epoch: 11, loss: 6.326172745227813, eval loss: [NA]
Epoch: 12, loss: 6.292488718032837, eval loss: [NA]
Epoch: 13, loss: 6.315727078914643, eval loss: [NA]
Epoch: 14, loss: 6.320454609394074, eval loss: [NA]
Epoch: 15, loss: 6.303097989559173, eval loss: [NA]
Epoch: 16, loss: 6.3023227286338805, eval loss: [NA]
Epoch: 17, loss: 6.3007870054245, eval loss: [NA]
Epoch: 18, loss: 6.299574625492096, eval loss: [NA]
Epoch: 19, loss: 6.293340179920197, eval loss: [NA]
Epoch: 20, loss: 6.324783957004547, eval loss: [NA]
Epoch: 21, loss: 6.285789711475372, eval loss: [NA]
Epoch: 22, loss: 6.320293583869934, eval loss: [NA]
Epoch: 23, loss: 6.309739513397217, eval loss: [NA]
Epoch: 24, loss: 6.281694383621216, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.538879350280762, eval loss: [NA]
Epoch: 1, loss: 3.5695089477539064, eval loss: [NA]
Epoch: 2, loss: 3.5463183166503907, eval loss: [NA]
Epoch: 3, loss: 3.579093125915527, eval loss: [NA]
Epoch: 4, loss: 3.5625663467407227, eval loss: [NA]
Epoch: 5, loss: 3.5459080307006836, eval loss: [NA]
Epoch: 6, loss: 3.532703695678711, eval loss: [NA]
Epoch: 7, loss: 3.518543109130859, eval loss: [NA]
Epoch: 8, loss: 3.514665005493164, eval loss: [NA]
Epoch: 9, loss: 3.575543437194824, eval loss: [NA]
Epoch: 10, loss: 3.534460874938965, eval loss: [NA]
Epoch: 11, loss: 3.522725665283203, eval loss: [NA]
Epoch: 12, loss: 3.526575476074219, eval loss: [NA]
Epoch: 13, loss: 3.546652963256836, eval loss: [NA]
Epoch: 14, loss: 3.563430603027344, eval loss: [NA]
Epoch: 15, loss: 3.518925616455078, eval loss: [NA]
Epoch: 16, loss: 3.530151889038086, eval loss: [NA]
Epoch: 17, loss: 3.504359194946289, eval loss: [NA]
Epoch: 18, loss: 3.531638429260254, eval loss: [NA]
Epoch: 19, loss: 3.524341014099121, eval loss: [NA]
Epoch: 20, loss: 3.4991344848632813, eval loss: [NA]
Epoch: 21, loss: 3.5196827239990234, eval loss: [NA]
Epoch: 22, loss: 3.5470303909301757, eval loss: [NA]
Epoch: 23, loss: 3.4923232040405274, eval loss: [NA]
Epoch: 24, loss: 3.5325398345947265, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.269054257869721, eval loss: [NA]
Epoch: 1, loss: 6.281088514328003, eval loss: [NA]
Epoch: 2, loss: 6.292261977195739, eval loss: [NA]
Epoch: 3, loss: 6.269150078296661, eval loss: [NA]
Epoch: 4, loss: 6.288619482517243, eval loss: [NA]
Epoch: 5, loss: 6.268026721477509, eval loss: [NA]
Epoch: 6, loss: 6.276722812652588, eval loss: [NA]
Epoch: 7, loss: 6.259098739624023, eval loss: [NA]
Epoch: 8, loss: 6.290804769992828, eval loss: [NA]
Epoch: 9, loss: 6.281880650520325, eval loss: [NA]
Epoch: 10, loss: 6.297174642086029, eval loss: [NA]
Epoch: 11, loss: 6.290861337184906, eval loss: [NA]
Epoch: 12, loss: 6.291170296669006, eval loss: [NA]
Epoch: 13, loss: 6.291035294532776, eval loss: [NA]
Epoch: 14, loss: 6.278337750434876, eval loss: [NA]
Epoch: 15, loss: 6.27184289932251, eval loss: [NA]
Epoch: 16, loss: 6.264149432182312, eval loss: [NA]
Epoch: 17, loss: 6.288322179317475, eval loss: [NA]
Epoch: 18, loss: 6.280676689147949, eval loss: [NA]
Epoch: 19, loss: 6.292557437419891, eval loss: [NA]
Epoch: 20, loss: 6.285590198040008, eval loss: [NA]
Epoch: 21, loss: 6.263474192619324, eval loss: [NA]
Epoch: 22, loss: 6.297721025943756, eval loss: [NA]
Epoch: 23, loss: 6.271317796707153, eval loss: [NA]
Epoch: 24, loss: 6.303543727397919, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4573587524414062, eval loss: [NA]
Epoch: 1, loss: 3.4463871551513674, eval loss: [NA]
Epoch: 2, loss: 3.442337776184082, eval loss: [NA]
Epoch: 3, loss: 3.4156967071533204, eval loss: [NA]
Epoch: 4, loss: 3.4535178924560546, eval loss: [NA]
Epoch: 5, loss: 3.4267750579833987, eval loss: [NA]
Epoch: 6, loss: 3.455309765625, eval loss: [NA]
Epoch: 7, loss: 3.404136201477051, eval loss: [NA]
Epoch: 8, loss: 3.4551953475952146, eval loss: [NA]
Epoch: 9, loss: 3.4230963745117187, eval loss: [NA]
Epoch: 10, loss: 3.4138867431640625, eval loss: [NA]
Epoch: 11, loss: 3.4385171157836916, eval loss: [NA]
Epoch: 12, loss: 3.419368829345703, eval loss: [NA]
Epoch: 13, loss: 3.4430039321899413, eval loss: [NA]
Epoch: 14, loss: 3.415393524169922, eval loss: [NA]
Epoch: 15, loss: 3.4216053802490234, eval loss: [NA]
Epoch: 16, loss: 3.4320793014526365, eval loss: [NA]
Epoch: 17, loss: 3.426842265319824, eval loss: [NA]
Epoch: 18, loss: 3.442469155883789, eval loss: [NA]
Epoch: 19, loss: 3.4495770263671877, eval loss: [NA]
Epoch: 20, loss: 3.420072373962402, eval loss: [NA]
Epoch: 21, loss: 3.4147324157714842, eval loss: [NA]
Epoch: 22, loss: 3.4057088668823243, eval loss: [NA]
Epoch: 23, loss: 3.4248010040283203, eval loss: [NA]
Epoch: 24, loss: 3.38208271484375, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.385862028598785, eval loss: [NA]
Epoch: 1, loss: 6.405415658950806, eval loss: [NA]
Epoch: 2, loss: 6.3936882495880125, eval loss: [NA]
Epoch: 3, loss: 6.401662189960479, eval loss: [NA]
Epoch: 4, loss: 6.420831589698792, eval loss: [NA]
Epoch: 5, loss: 6.394132690429688, eval loss: [NA]
Epoch: 6, loss: 6.413524875640869, eval loss: [NA]
Epoch: 7, loss: 6.430184466838837, eval loss: [NA]
Epoch: 8, loss: 6.412377202510834, eval loss: [NA]
Epoch: 9, loss: 6.403609907627105, eval loss: [NA]
Epoch: 10, loss: 6.399493093490601, eval loss: [NA]
Epoch: 11, loss: 6.420556461811065, eval loss: [NA]
Epoch: 12, loss: 6.389732503890992, eval loss: [NA]
Epoch: 13, loss: 6.414801185131073, eval loss: [NA]
Epoch: 14, loss: 6.424741921424865, eval loss: [NA]
Epoch: 15, loss: 6.413585062026978, eval loss: [NA]
Epoch: 16, loss: 6.438096652030945, eval loss: [NA]
Epoch: 17, loss: 6.404584972858429, eval loss: [NA]
Epoch: 18, loss: 6.382020325660705, eval loss: [NA]
Epoch: 19, loss: 6.4065730047225955, eval loss: [NA]
Epoch: 20, loss: 6.397612631320953, eval loss: [NA]
Epoch: 21, loss: 6.420436837673187, eval loss: [NA]
Epoch: 22, loss: 6.423197495937347, eval loss: [NA]
Epoch: 23, loss: 6.38594450712204, eval loss: [NA]
Epoch: 24, loss: 6.395322737693786, eval loss: [NA]

Runtime:375.19
[350713680.1272, 0.1799, 0.2164, 0.0929]
[1.4855, 0.6487, 0.6468, 0.6459]
[2.158, 0.7477, 0.7464, 0.7549]
tensor(0.7703, grad_fn=<MeanBackward0>)
tensor(0.6456, grad_fn=<MeanBackward0>)
tensor([ 1.7154,  0.2317,  1.7918,  0.3528,  1.6364,  0.1717,  2.4610,  1.0759,
         0.3507, -1.2018], grad_fn=<MeanBackward1>)
tensor([1.1225, 1.2105, 1.1269, 1.2218, 0.3181, 0.3367, 0.3211, 0.3291, 0.3231,
        0.3352], grad_fn=<StdBackward1>)
tensor([ 2.7419,  1.4270,  1.9009,  0.2732,  1.8506, -0.0556,  2.1935,  1.1706,
         0.1064, -0.9865])
KL div untrained: 2290964029.7511
KL div trained: 0.094
