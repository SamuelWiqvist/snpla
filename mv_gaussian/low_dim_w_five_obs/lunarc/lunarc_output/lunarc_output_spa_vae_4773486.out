Input args:
Dim: 2
seed: 12
seed_data: 10
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev
tensor(2.1537, grad_fn=<MeanBackward0>)
tensor(2.0996, grad_fn=<MeanBackward0>)
tensor([-0.0798,  0.1838, -0.0579, -0.0190, -0.0410, -0.1534, -0.1064, -0.0258,
        -0.2798, -0.1313], grad_fn=<MeanBackward1>)
tensor([0.9952, 0.9260, 0.9233, 0.9881, 0.9813, 0.9289, 0.9363, 0.9910, 0.9797,
        0.9351], grad_fn=<StdBackward1>)
tensor([-0.7298, -3.8459, -0.5424, -2.9815,  0.4471, -2.5302, -1.1373, -4.1014,
        -0.4217, -3.0542])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.666789346313477, eval loss: [NA]
Epoch: 1, loss: 7.092398846435547, eval loss: [NA]
Epoch: 2, loss: 7.039759521484375, eval loss: [NA]
Epoch: 3, loss: 6.949202713012696, eval loss: [NA]
Epoch: 4, loss: 6.886829110717773, eval loss: [NA]
Epoch: 5, loss: 6.851739505004883, eval loss: [NA]
Epoch: 6, loss: 6.854195343017578, eval loss: [NA]
Epoch: 7, loss: 6.855450134277344, eval loss: [NA]
Epoch: 8, loss: 6.832832379150391, eval loss: [NA]
Epoch: 9, loss: 6.844101873779297, eval loss: [NA]
Epoch: 10, loss: 6.828691293334961, eval loss: [NA]
Epoch: 11, loss: 6.8367062774658205, eval loss: [NA]
Epoch: 12, loss: 6.813922717285156, eval loss: [NA]
Epoch: 13, loss: 6.779468603515625, eval loss: [NA]
Epoch: 14, loss: 6.6055553375244145, eval loss: [NA]
Epoch: 15, loss: 6.194050106811523, eval loss: [NA]
Epoch: 16, loss: 5.911880351257325, eval loss: [NA]
Epoch: 17, loss: 5.832474223327637, eval loss: [NA]
Epoch: 18, loss: 5.793135809326172, eval loss: [NA]
Epoch: 19, loss: 5.755226817321778, eval loss: [NA]
Epoch: 20, loss: 5.706543545532226, eval loss: [NA]
Epoch: 21, loss: 5.694522271728515, eval loss: [NA]
Epoch: 22, loss: 5.664343925476074, eval loss: [NA]
Epoch: 23, loss: 5.307522610473633, eval loss: [NA]
Epoch: 24, loss: 4.939444375610352, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.0021149814128876, eval loss: [NA]
Epoch: 1, loss: 0.794689135402441, eval loss: [NA]
Epoch: 2, loss: 0.6044169899821281, eval loss: [NA]
Epoch: 3, loss: 0.5983847176283598, eval loss: [NA]
Epoch: 4, loss: 0.5407991222292184, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.456639120578766, eval loss: [NA]
Epoch: 1, loss: 6.445276684761048, eval loss: [NA]
Epoch: 2, loss: 6.428015339374542, eval loss: [NA]
Epoch: 3, loss: 6.41755515575409, eval loss: [NA]
Epoch: 4, loss: 6.405953104496002, eval loss: [NA]
Epoch: 5, loss: 6.4040070104599, eval loss: [NA]
Epoch: 6, loss: 6.428960485458374, eval loss: [NA]
Epoch: 7, loss: 6.421723725795746, eval loss: [NA]
Epoch: 8, loss: 6.41772643327713, eval loss: [NA]
Epoch: 9, loss: 6.402355935573578, eval loss: [NA]
Epoch: 10, loss: 6.399861419200898, eval loss: [NA]
Epoch: 11, loss: 6.399943354129792, eval loss: [NA]
Epoch: 12, loss: 6.40893082857132, eval loss: [NA]
Epoch: 13, loss: 6.387684412002564, eval loss: [NA]
Epoch: 14, loss: 6.418660969734192, eval loss: [NA]
Epoch: 15, loss: 6.406405851840973, eval loss: [NA]
Epoch: 16, loss: 6.406570615768433, eval loss: [NA]
Epoch: 17, loss: 6.398854460716247, eval loss: [NA]
Epoch: 18, loss: 6.4146017694473265, eval loss: [NA]
Epoch: 19, loss: 6.430158765316009, eval loss: [NA]
Epoch: 20, loss: 6.385481233596802, eval loss: [NA]
Epoch: 21, loss: 6.428224329948425, eval loss: [NA]
Epoch: 22, loss: 6.400893299579621, eval loss: [NA]
Epoch: 23, loss: 6.394691298007965, eval loss: [NA]
Epoch: 24, loss: 6.388589572906494, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.90059132232666, eval loss: [NA]
Epoch: 1, loss: 4.747547442626953, eval loss: [NA]
Epoch: 2, loss: 4.771331617736816, eval loss: [NA]
Epoch: 3, loss: 4.744732344055175, eval loss: [NA]
Epoch: 4, loss: 4.71779171295166, eval loss: [NA]
Epoch: 5, loss: 4.735126681518555, eval loss: [NA]
Epoch: 6, loss: 4.7158181167602535, eval loss: [NA]
Epoch: 7, loss: 4.727686340332031, eval loss: [NA]
Epoch: 8, loss: 4.73552495727539, eval loss: [NA]
Epoch: 9, loss: 4.6820308853149415, eval loss: [NA]
Epoch: 10, loss: 4.688746723937988, eval loss: [NA]
Epoch: 11, loss: 4.716747183227539, eval loss: [NA]
Epoch: 12, loss: 4.7007930541992184, eval loss: [NA]
Epoch: 13, loss: 4.7078437332153324, eval loss: [NA]
Epoch: 14, loss: 4.678317073059082, eval loss: [NA]
Epoch: 15, loss: 4.695279776000977, eval loss: [NA]
Epoch: 16, loss: 4.667377445983886, eval loss: [NA]
Epoch: 17, loss: 4.679250317382812, eval loss: [NA]
Epoch: 18, loss: 4.67550263671875, eval loss: [NA]
Epoch: 19, loss: 4.693335038757324, eval loss: [NA]
Epoch: 20, loss: 4.676361538696289, eval loss: [NA]
Epoch: 21, loss: 4.67787014465332, eval loss: [NA]
Epoch: 22, loss: 4.669504942321777, eval loss: [NA]
Epoch: 23, loss: 4.662944320678711, eval loss: [NA]
Epoch: 24, loss: 4.666878512573242, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.8958507966995235, eval loss: [NA]
Epoch: 1, loss: 5.876873042583465, eval loss: [NA]
Epoch: 2, loss: 5.871779403686523, eval loss: [NA]
Epoch: 3, loss: 5.88633398771286, eval loss: [NA]
Epoch: 4, loss: 5.888766877651214, eval loss: [NA]
Epoch: 5, loss: 5.89656486749649, eval loss: [NA]
Epoch: 6, loss: 5.866306042671203, eval loss: [NA]
Epoch: 7, loss: 5.873233451843261, eval loss: [NA]
Epoch: 8, loss: 5.890157489776612, eval loss: [NA]
Epoch: 9, loss: 5.896081039905548, eval loss: [NA]
Epoch: 10, loss: 5.887181820869446, eval loss: [NA]
Epoch: 11, loss: 5.875427513122559, eval loss: [NA]
Epoch: 12, loss: 5.8957564687728885, eval loss: [NA]
Epoch: 13, loss: 5.872707691192627, eval loss: [NA]
Epoch: 14, loss: 5.879816014766693, eval loss: [NA]
Epoch: 15, loss: 5.8650360107421875, eval loss: [NA]
Epoch: 16, loss: 5.89323706150055, eval loss: [NA]
Epoch: 17, loss: 5.8851246166229245, eval loss: [NA]
Epoch: 18, loss: 5.873688013553619, eval loss: [NA]
Epoch: 19, loss: 5.888929886817932, eval loss: [NA]
Epoch: 20, loss: 5.9002849078178405, eval loss: [NA]
Epoch: 21, loss: 5.866031446456909, eval loss: [NA]
Epoch: 22, loss: 5.874331030845642, eval loss: [NA]
Epoch: 23, loss: 5.8846870303153995, eval loss: [NA]
Epoch: 24, loss: 5.880507383346558, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 4.736621102905273, eval loss: [NA]
Epoch: 1, loss: 4.727869720458984, eval loss: [NA]
Epoch: 2, loss: 4.692596270751953, eval loss: [NA]
Epoch: 3, loss: 4.7771848205566405, eval loss: [NA]
Epoch: 4, loss: 4.714058598327637, eval loss: [NA]
Epoch: 5, loss: 4.727105868530273, eval loss: [NA]
Epoch: 6, loss: 4.694842643737793, eval loss: [NA]
Epoch: 7, loss: 4.708750813293457, eval loss: [NA]
Epoch: 8, loss: 4.698424621582031, eval loss: [NA]
Epoch: 9, loss: 4.738385096740723, eval loss: [NA]
Epoch: 10, loss: 4.756095776367188, eval loss: [NA]
Epoch: 11, loss: 4.714694207763672, eval loss: [NA]
Epoch: 12, loss: 4.710493887329101, eval loss: [NA]
Epoch: 13, loss: 4.717718446350098, eval loss: [NA]
Epoch: 14, loss: 4.712266033935546, eval loss: [NA]
Epoch: 15, loss: 4.7006601791381835, eval loss: [NA]
Epoch: 16, loss: 4.717199166870117, eval loss: [NA]
Epoch: 17, loss: 4.714043553161621, eval loss: [NA]
Epoch: 18, loss: 4.678254222106934, eval loss: [NA]
Epoch: 19, loss: 4.680134425354004, eval loss: [NA]
Epoch: 20, loss: 4.700111955261231, eval loss: [NA]
Epoch: 21, loss: 4.684279835510254, eval loss: [NA]
Epoch: 22, loss: 4.685653321838379, eval loss: [NA]
Epoch: 23, loss: 4.680594717407226, eval loss: [NA]
Epoch: 24, loss: 4.693760499572754, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.8791668152809144, eval loss: [NA]
Epoch: 1, loss: 5.888376767635346, eval loss: [NA]
Epoch: 2, loss: 5.875836601257324, eval loss: [NA]
Epoch: 3, loss: 5.8822636222839355, eval loss: [NA]
Epoch: 4, loss: 5.878132164478302, eval loss: [NA]
Epoch: 5, loss: 5.881769785881042, eval loss: [NA]
Epoch: 6, loss: 5.844150705337524, eval loss: [NA]
Epoch: 7, loss: 5.878253667354584, eval loss: [NA]
Epoch: 8, loss: 5.877057158946991, eval loss: [NA]
Epoch: 9, loss: 5.901493847370148, eval loss: [NA]
Epoch: 10, loss: 5.90083571434021, eval loss: [NA]
Epoch: 11, loss: 5.870691621303559, eval loss: [NA]
Epoch: 12, loss: 5.869843864440918, eval loss: [NA]
Epoch: 13, loss: 5.863292636871338, eval loss: [NA]
Epoch: 14, loss: 5.85626268863678, eval loss: [NA]
Epoch: 15, loss: 5.871265325546265, eval loss: [NA]
Epoch: 16, loss: 5.871333887577057, eval loss: [NA]
Epoch: 17, loss: 5.87298814535141, eval loss: [NA]
Epoch: 18, loss: 5.862879416942596, eval loss: [NA]
Epoch: 19, loss: 5.883643143177032, eval loss: [NA]
Epoch: 20, loss: 5.863986825942993, eval loss: [NA]
Epoch: 21, loss: 5.881304817199707, eval loss: [NA]
Epoch: 22, loss: 5.890466997623443, eval loss: [NA]
Epoch: 23, loss: 5.878484714031219, eval loss: [NA]
Epoch: 24, loss: 5.872901446819306, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 4.692736239624024, eval loss: [NA]
Epoch: 1, loss: 4.659904977416992, eval loss: [NA]
Epoch: 2, loss: 4.658755046081543, eval loss: [NA]
Epoch: 3, loss: 4.671374392700195, eval loss: [NA]
Epoch: 4, loss: 4.660100149536133, eval loss: [NA]
Epoch: 5, loss: 4.637647329711914, eval loss: [NA]
Epoch: 6, loss: 4.659504194641113, eval loss: [NA]
Epoch: 7, loss: 4.636753994750976, eval loss: [NA]
Epoch: 8, loss: 4.667806532287598, eval loss: [NA]
Epoch: 9, loss: 4.63806208190918, eval loss: [NA]
Epoch: 10, loss: 4.660954777526856, eval loss: [NA]
Epoch: 11, loss: 4.6529708694458005, eval loss: [NA]
Epoch: 12, loss: 4.637829772949218, eval loss: [NA]
Epoch: 13, loss: 4.674252058410644, eval loss: [NA]
Epoch: 14, loss: 4.651541494750977, eval loss: [NA]
Epoch: 15, loss: 4.651563906860352, eval loss: [NA]
Epoch: 16, loss: 4.646935615539551, eval loss: [NA]
Epoch: 17, loss: 4.648642288208007, eval loss: [NA]
Epoch: 18, loss: 4.661647215270996, eval loss: [NA]
Epoch: 19, loss: 4.6391009429931644, eval loss: [NA]
Epoch: 20, loss: 4.66420845489502, eval loss: [NA]
Epoch: 21, loss: 4.685198178100586, eval loss: [NA]
Epoch: 22, loss: 4.656310108947754, eval loss: [NA]
Epoch: 23, loss: 4.680217121887207, eval loss: [NA]
Epoch: 24, loss: 4.631863771057129, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.907490491867065, eval loss: [NA]
Epoch: 1, loss: 5.881847369670868, eval loss: [NA]
Epoch: 2, loss: 5.89143303155899, eval loss: [NA]
Epoch: 3, loss: 5.9196320271492, eval loss: [NA]
Epoch: 4, loss: 5.906361153125763, eval loss: [NA]
Epoch: 5, loss: 5.901072919368744, eval loss: [NA]
Epoch: 6, loss: 5.91696549654007, eval loss: [NA]
Epoch: 7, loss: 5.921802618503571, eval loss: [NA]
Epoch: 8, loss: 5.912886328697205, eval loss: [NA]
Epoch: 9, loss: 5.903669414520263, eval loss: [NA]
Epoch: 10, loss: 5.910413744449616, eval loss: [NA]
Epoch: 11, loss: 5.905020778179169, eval loss: [NA]
Epoch: 12, loss: 5.9022747421264645, eval loss: [NA]
Epoch: 13, loss: 5.920052354335785, eval loss: [NA]
Epoch: 14, loss: 5.894920628070832, eval loss: [NA]
Epoch: 15, loss: 5.8953222489357, eval loss: [NA]
Epoch: 16, loss: 5.9281079697608945, eval loss: [NA]
Epoch: 17, loss: 5.897640731334686, eval loss: [NA]
Epoch: 18, loss: 5.897618367671966, eval loss: [NA]
Epoch: 19, loss: 5.906465322971344, eval loss: [NA]
Epoch: 20, loss: 5.89708952665329, eval loss: [NA]
Epoch: 21, loss: 5.899479868412018, eval loss: [NA]
Epoch: 22, loss: 5.913047196865082, eval loss: [NA]
Epoch: 23, loss: 5.922814648151398, eval loss: [NA]
Epoch: 24, loss: 5.906331295967102, eval loss: [NA]

Runtime:392.28
[1.7074358186383025e+18, 0.6765, 0.3688, 0.4036]
[2.0996, 0.7881, 0.7573, 0.7427]
[2.1537, 0.9591, 0.9565, 0.9576]
tensor(0.9466, grad_fn=<MeanBackward0>)
tensor(0.7668, grad_fn=<MeanBackward0>)
tensor([-0.4564, -3.0272, -0.4898, -3.0487,  0.1856, -2.3461, -0.4444, -3.0767,
        -0.6131, -3.2138], grad_fn=<MeanBackward1>)
tensor([1.2208, 1.2804, 0.3160, 0.3532, 0.3081, 0.3316, 1.1418, 1.2440, 1.1151,
        1.2123], grad_fn=<StdBackward1>)
tensor([-0.7298, -3.8459, -0.5424, -2.9815,  0.4471, -2.5302, -1.1373, -4.1014,
        -0.4217, -3.0542])
KL div untrained: 1.520566463488017e+18
KL div trained: 0.3447
