/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1820, grad_fn=<MeanBackward0>)
tensor(2.1557, grad_fn=<MeanBackward0>)
tensor([ 0.0151,  0.1546,  0.0269, -0.2112,  0.0550, -0.0400, -0.0399, -0.0804,
        -0.0781,  0.0224], grad_fn=<MeanBackward1>)
tensor([0.9357, 0.9428, 0.9529, 0.9885, 1.0172, 0.9356, 0.9022, 0.9515, 0.9922,
        1.0824], grad_fn=<StdBackward1>)
tensor([ 0.9260, -2.9856,  1.1985, -2.0846, -0.1463, -3.8626,  0.4379, -3.0580,
        -1.1963, -4.4669])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.342691830444336, eval loss: [NA]
Epoch: 1, loss: 7.047542587280273, eval loss: [NA]
Epoch: 2, loss: 6.954659024047851, eval loss: [NA]
Epoch: 3, loss: 6.903515850830078, eval loss: [NA]
Epoch: 4, loss: 6.8698615631103515, eval loss: [NA]
Epoch: 5, loss: 6.855638253784179, eval loss: [NA]
Epoch: 6, loss: 6.8344288970947265, eval loss: [NA]
Epoch: 7, loss: 6.69197036743164, eval loss: [NA]
Epoch: 8, loss: 6.312901702880859, eval loss: [NA]
Epoch: 9, loss: 5.994870680236817, eval loss: [NA]
Epoch: 10, loss: 5.434853967285156, eval loss: [NA]
Epoch: 11, loss: 4.986583137512207, eval loss: [NA]
Epoch: 12, loss: 4.813198480224609, eval loss: [NA]
Epoch: 13, loss: 4.792273106384277, eval loss: [NA]
Epoch: 14, loss: 4.731781266784668, eval loss: [NA]
Epoch: 15, loss: 4.691560258483887, eval loss: [NA]
Epoch: 16, loss: 4.64523720703125, eval loss: [NA]
Epoch: 17, loss: 4.630747261047364, eval loss: [NA]
Epoch: 18, loss: 4.600441934204102, eval loss: [NA]
Epoch: 19, loss: 4.594550912475586, eval loss: [NA]
Epoch: 20, loss: 4.61867021484375, eval loss: [NA]
Epoch: 21, loss: 4.578410975646973, eval loss: [NA]
Epoch: 22, loss: 4.549803067016602, eval loss: [NA]
Epoch: 23, loss: 4.59257043762207, eval loss: [NA]
Epoch: 24, loss: 4.54545684967041, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.5576095420122145, eval loss: [NA]
Epoch: 1, loss: 0.9379731261730194, eval loss: [NA]
Epoch: 2, loss: 0.6415660637617111, eval loss: [NA]
Epoch: 3, loss: 0.6332177370786667, eval loss: [NA]
Epoch: 4, loss: 0.572622869387269, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.277270271778106, eval loss: [NA]
Epoch: 1, loss: 7.2745389556884765, eval loss: [NA]
Epoch: 2, loss: 7.2763869142532345, eval loss: [NA]
Epoch: 3, loss: 7.260111451148987, eval loss: [NA]
Epoch: 4, loss: 7.261015424728393, eval loss: [NA]
Epoch: 5, loss: 7.241087772846222, eval loss: [NA]
Epoch: 6, loss: 7.252389094829559, eval loss: [NA]
Epoch: 7, loss: 7.258842830657959, eval loss: [NA]
Epoch: 8, loss: 7.249836943149567, eval loss: [NA]
Epoch: 9, loss: 7.269120061397553, eval loss: [NA]
Epoch: 10, loss: 7.238747878074646, eval loss: [NA]
Epoch: 11, loss: 7.24229237318039, eval loss: [NA]
Epoch: 12, loss: 7.240207240581513, eval loss: [NA]
Epoch: 13, loss: 7.2456617617607115, eval loss: [NA]
Epoch: 14, loss: 7.2612493920326235, eval loss: [NA]
Epoch: 15, loss: 7.244659130573273, eval loss: [NA]
Epoch: 16, loss: 7.2374306225776674, eval loss: [NA]
Epoch: 17, loss: 7.245970203876495, eval loss: [NA]
Epoch: 18, loss: 7.25109561920166, eval loss: [NA]
Epoch: 19, loss: 7.230567421913147, eval loss: [NA]
Epoch: 20, loss: 7.223929829597473, eval loss: [NA]
Epoch: 21, loss: 7.249677197933197, eval loss: [NA]
Epoch: 22, loss: 7.235897490978241, eval loss: [NA]
Epoch: 23, loss: 7.236952800750732, eval loss: [NA]
Epoch: 24, loss: 7.24945769071579, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.539559243774414, eval loss: [NA]
Epoch: 1, loss: 4.341400680541992, eval loss: [NA]
Epoch: 2, loss: 3.985950161743164, eval loss: [NA]
Epoch: 3, loss: 3.758218307495117, eval loss: [NA]
Epoch: 4, loss: 3.705279859924316, eval loss: [NA]
Epoch: 5, loss: 3.6341288330078125, eval loss: [NA]
Epoch: 6, loss: 3.6048327407836913, eval loss: [NA]
Epoch: 7, loss: 3.639075019836426, eval loss: [NA]
Epoch: 8, loss: 3.605833206176758, eval loss: [NA]
Epoch: 9, loss: 3.5775329849243165, eval loss: [NA]
Epoch: 10, loss: 3.617562609863281, eval loss: [NA]
Epoch: 11, loss: 3.5784681243896483, eval loss: [NA]
Epoch: 12, loss: 3.608385414123535, eval loss: [NA]
Epoch: 13, loss: 3.623496746826172, eval loss: [NA]
Epoch: 14, loss: 3.6076227447509766, eval loss: [NA]
Epoch: 15, loss: 3.547662153625488, eval loss: [NA]
Epoch: 16, loss: 3.5734993011474607, eval loss: [NA]
Epoch: 17, loss: 3.575829539489746, eval loss: [NA]
Epoch: 18, loss: 3.5724924652099608, eval loss: [NA]
Epoch: 19, loss: 3.6259694732666015, eval loss: [NA]
Epoch: 20, loss: 3.5346326889038084, eval loss: [NA]
Epoch: 21, loss: 3.5188157608032227, eval loss: [NA]
Epoch: 22, loss: 3.5542580657958984, eval loss: [NA]
Epoch: 23, loss: 3.5336362426757812, eval loss: [NA]
Epoch: 24, loss: 3.5507428176879885, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.7446875, eval loss: [NA]
Epoch: 1, loss: 5.746541509628296, eval loss: [NA]
Epoch: 2, loss: 5.741616077423096, eval loss: [NA]
Epoch: 3, loss: 5.754141659736633, eval loss: [NA]
Epoch: 4, loss: 5.7429143333435055, eval loss: [NA]
Epoch: 5, loss: 5.745373475551605, eval loss: [NA]
Epoch: 6, loss: 5.76444787979126, eval loss: [NA]
Epoch: 7, loss: 5.759351496696472, eval loss: [NA]
Epoch: 8, loss: 5.768168647289276, eval loss: [NA]
Epoch: 9, loss: 5.742279322147369, eval loss: [NA]
Epoch: 10, loss: 5.750142021179199, eval loss: [NA]
Epoch: 11, loss: 5.7534430432319645, eval loss: [NA]
Epoch: 12, loss: 5.74081063747406, eval loss: [NA]
Epoch: 13, loss: 5.7384519338607785, eval loss: [NA]
Epoch: 14, loss: 5.736188180446625, eval loss: [NA]
Epoch: 15, loss: 5.752710239887238, eval loss: [NA]
Epoch: 16, loss: 5.745001633167266, eval loss: [NA]
Epoch: 17, loss: 5.752273347377777, eval loss: [NA]
Epoch: 18, loss: 5.765250236988067, eval loss: [NA]
Epoch: 19, loss: 5.75559686422348, eval loss: [NA]
Epoch: 20, loss: 5.767559816837311, eval loss: [NA]
Epoch: 21, loss: 5.7508744263648985, eval loss: [NA]
Epoch: 22, loss: 5.75936368227005, eval loss: [NA]
Epoch: 23, loss: 5.7600486278533936, eval loss: [NA]
Epoch: 24, loss: 5.757937183380127, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.595317903137207, eval loss: [NA]
Epoch: 1, loss: 3.5097351791381834, eval loss: [NA]
Epoch: 2, loss: 3.5116799896240236, eval loss: [NA]
Epoch: 3, loss: 3.5387414031982423, eval loss: [NA]
Epoch: 4, loss: 3.5260418975830077, eval loss: [NA]
Epoch: 5, loss: 3.518693539428711, eval loss: [NA]
Epoch: 6, loss: 3.521285319519043, eval loss: [NA]
Epoch: 7, loss: 3.4951565505981446, eval loss: [NA]
Epoch: 8, loss: 3.5226709655761717, eval loss: [NA]
Epoch: 9, loss: 3.491619953918457, eval loss: [NA]
Epoch: 10, loss: 3.5025591171264647, eval loss: [NA]
Epoch: 11, loss: 3.4901982681274415, eval loss: [NA]
Epoch: 12, loss: 3.509116033935547, eval loss: [NA]
Epoch: 13, loss: 3.5267814849853516, eval loss: [NA]
Epoch: 14, loss: 3.511482878112793, eval loss: [NA]
Epoch: 15, loss: 3.5075065155029295, eval loss: [NA]
Epoch: 16, loss: 3.4960901107788085, eval loss: [NA]
Epoch: 17, loss: 3.5278488677978515, eval loss: [NA]
Epoch: 18, loss: 3.48488211517334, eval loss: [NA]
Epoch: 19, loss: 3.492590687561035, eval loss: [NA]
Epoch: 20, loss: 3.528616653442383, eval loss: [NA]
Epoch: 21, loss: 3.4660349533081054, eval loss: [NA]
Epoch: 22, loss: 3.5407423843383787, eval loss: [NA]
Epoch: 23, loss: 3.4689721786499024, eval loss: [NA]
Epoch: 24, loss: 3.5141279357910156, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.60156578540802, eval loss: [NA]
Epoch: 1, loss: 5.602068376541138, eval loss: [NA]
Epoch: 2, loss: 5.638828735351563, eval loss: [NA]
Epoch: 3, loss: 5.629540822505951, eval loss: [NA]
Epoch: 4, loss: 5.609513578414917, eval loss: [NA]
Epoch: 5, loss: 5.615870413780212, eval loss: [NA]
Epoch: 6, loss: 5.601047358512878, eval loss: [NA]
Epoch: 7, loss: 5.625098104476929, eval loss: [NA]
Epoch: 8, loss: 5.612969081401825, eval loss: [NA]
Epoch: 9, loss: 5.608762946128845, eval loss: [NA]
Epoch: 10, loss: 5.622410776615143, eval loss: [NA]
Epoch: 11, loss: 5.595150830745697, eval loss: [NA]
Epoch: 12, loss: 5.6113014626502995, eval loss: [NA]
Epoch: 13, loss: 5.610292220115662, eval loss: [NA]
Epoch: 14, loss: 5.605072062015534, eval loss: [NA]
Epoch: 15, loss: 5.613035752773285, eval loss: [NA]
Epoch: 16, loss: 5.606182749271393, eval loss: [NA]
Epoch: 17, loss: 5.625038537979126, eval loss: [NA]
Epoch: 18, loss: 5.61080549955368, eval loss: [NA]
Epoch: 19, loss: 5.614898619651794, eval loss: [NA]
Epoch: 20, loss: 5.618747508525848, eval loss: [NA]
Epoch: 21, loss: 5.603437044620514, eval loss: [NA]
Epoch: 22, loss: 5.608974194526672, eval loss: [NA]
Epoch: 23, loss: 5.653519260883331, eval loss: [NA]
Epoch: 24, loss: 5.607571225166321, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4944867263793946, eval loss: [NA]
Epoch: 1, loss: 3.483771385192871, eval loss: [NA]
Epoch: 2, loss: 3.4446042709350584, eval loss: [NA]
Epoch: 3, loss: 3.4811762741088867, eval loss: [NA]
Epoch: 4, loss: 3.470003921508789, eval loss: [NA]
Epoch: 5, loss: 3.473842526245117, eval loss: [NA]
Epoch: 6, loss: 3.4836421279907226, eval loss: [NA]
Epoch: 7, loss: 3.4630056762695314, eval loss: [NA]
Epoch: 8, loss: 3.4887481506347657, eval loss: [NA]
Epoch: 9, loss: 3.478691459655762, eval loss: [NA]
Epoch: 10, loss: 3.4774264434814453, eval loss: [NA]
Epoch: 11, loss: 3.463963636779785, eval loss: [NA]
Epoch: 12, loss: 3.4668423614501953, eval loss: [NA]
Epoch: 13, loss: 3.4691588302612306, eval loss: [NA]
Epoch: 14, loss: 3.4524054000854494, eval loss: [NA]
Epoch: 15, loss: 3.4576014114379885, eval loss: [NA]
Epoch: 16, loss: 3.4376541870117188, eval loss: [NA]
Epoch: 17, loss: 3.472453547668457, eval loss: [NA]
Epoch: 18, loss: 3.494082727050781, eval loss: [NA]
Epoch: 19, loss: 3.452062530517578, eval loss: [NA]
Epoch: 20, loss: 3.45612716217041, eval loss: [NA]
Epoch: 21, loss: 3.444084846496582, eval loss: [NA]
Epoch: 22, loss: 3.4325234512329104, eval loss: [NA]
Epoch: 23, loss: 3.449443167114258, eval loss: [NA]
Epoch: 24, loss: 3.402257844543457, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.371611313819885, eval loss: [NA]
Epoch: 1, loss: 5.38186749458313, eval loss: [NA]
Epoch: 2, loss: 5.381507816314698, eval loss: [NA]
Epoch: 3, loss: 5.368254699707031, eval loss: [NA]
Epoch: 4, loss: 5.395724189281464, eval loss: [NA]
Epoch: 5, loss: 5.386126079559326, eval loss: [NA]
Epoch: 6, loss: 5.3651605677604675, eval loss: [NA]
Epoch: 7, loss: 5.37906274318695, eval loss: [NA]
Epoch: 8, loss: 5.399645793437958, eval loss: [NA]
Epoch: 9, loss: 5.3729914593696595, eval loss: [NA]
Epoch: 10, loss: 5.384879553318024, eval loss: [NA]
Epoch: 11, loss: 5.363083181381225, eval loss: [NA]
Epoch: 12, loss: 5.385230309963227, eval loss: [NA]
Epoch: 13, loss: 5.408352036476135, eval loss: [NA]
Epoch: 14, loss: 5.388065679073334, eval loss: [NA]
Epoch: 15, loss: 5.371037886142731, eval loss: [NA]
Epoch: 16, loss: 5.385106546878815, eval loss: [NA]
Epoch: 17, loss: 5.398681318759918, eval loss: [NA]
Epoch: 18, loss: 5.389354910850525, eval loss: [NA]
Epoch: 19, loss: 5.390110290050506, eval loss: [NA]
Epoch: 20, loss: 5.384240417480469, eval loss: [NA]
Epoch: 21, loss: 5.395562727451324, eval loss: [NA]
Epoch: 22, loss: 5.376181726455688, eval loss: [NA]
Epoch: 23, loss: 5.39412935256958, eval loss: [NA]
Epoch: 24, loss: 5.389647614955902, eval loss: [NA]

Runtime:399.85
[276463870474.9356, 0.4843, 0.1892, 0.2156]
[2.1557, 0.8627, 0.7056, 0.7118]
[2.182, 0.8705, 0.7482, 0.7544]
tensor(0.7799, grad_fn=<MeanBackward0>)
tensor(0.7020, grad_fn=<MeanBackward0>)
tensor([ 0.6005, -2.8711,  1.2438, -2.2255, -0.2616, -3.8054,  0.4133, -3.1128,
         0.5314, -2.8808], grad_fn=<MeanBackward1>)
tensor([1.1216, 1.1955, 0.3209, 0.3473, 0.3173, 0.3584, 0.3086, 0.3467, 1.1834,
        1.2806], grad_fn=<StdBackward1>)
tensor([ 0.9260, -2.9856,  1.1985, -2.0846, -0.1463, -3.8626,  0.4379, -3.0580,
        -1.1963, -4.4669])
KL div untrained: 5550029643354.305
KL div trained: 0.1807
