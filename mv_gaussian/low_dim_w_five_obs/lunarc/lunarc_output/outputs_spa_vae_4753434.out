/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1851, grad_fn=<MeanBackward0>)
tensor(1.2208, grad_fn=<MeanBackward0>)
tensor([ 0.0055, -0.1593,  0.1186,  0.2071,  0.0718, -0.0734, -0.1040, -0.0841,
         0.1084,  0.1632], grad_fn=<MeanBackward1>)
tensor([0.9649, 1.0266, 1.0857, 1.0248, 1.0024, 0.9360, 0.9434, 0.9114, 0.9342,
        1.0777], grad_fn=<StdBackward1>)
tensor([ 2.2575,  1.4950,  1.5514,  0.8996,  0.9468, -0.0109, -0.3141, -1.1053,
         0.2689, -0.8532])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 12.137633456420899, eval loss: [NA]
Epoch: 1, loss: 7.109059432983399, eval loss: [NA]
Epoch: 2, loss: 7.006844610595703, eval loss: [NA]
Epoch: 3, loss: 6.943588674926758, eval loss: [NA]
Epoch: 4, loss: 6.907261291503906, eval loss: [NA]
Epoch: 5, loss: 6.868865966796875, eval loss: [NA]
Epoch: 6, loss: 6.834427551269531, eval loss: [NA]
Epoch: 7, loss: 6.762923782348633, eval loss: [NA]
Epoch: 8, loss: 6.683720977783203, eval loss: [NA]
Epoch: 9, loss: 6.497253085327149, eval loss: [NA]
Epoch: 10, loss: 6.210323956298828, eval loss: [NA]
Epoch: 11, loss: 5.425315838623047, eval loss: [NA]
Epoch: 12, loss: 5.066737942504883, eval loss: [NA]
Epoch: 13, loss: 4.943024026489258, eval loss: [NA]
Epoch: 14, loss: 4.8553463668823245, eval loss: [NA]
Epoch: 15, loss: 4.800227688598633, eval loss: [NA]
Epoch: 16, loss: 4.735652725219727, eval loss: [NA]
Epoch: 17, loss: 4.7243047607421875, eval loss: [NA]
Epoch: 18, loss: 4.70036619720459, eval loss: [NA]
Epoch: 19, loss: 4.722535191345215, eval loss: [NA]
Epoch: 20, loss: 4.692036297607422, eval loss: [NA]
Epoch: 21, loss: 4.6608835830688475, eval loss: [NA]
Epoch: 22, loss: 4.641225283813476, eval loss: [NA]
Epoch: 23, loss: 4.627954016113281, eval loss: [NA]
Epoch: 24, loss: 4.604030928039551, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.508156979084015, eval loss: [NA]
Epoch: 1, loss: 1.037729355096817, eval loss: [NA]
Epoch: 2, loss: 0.7244824852049351, eval loss: [NA]
Epoch: 3, loss: 0.6143068934977055, eval loss: [NA]
Epoch: 4, loss: 0.5525077203661204, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.793084371089935, eval loss: [NA]
Epoch: 1, loss: 5.806252982616424, eval loss: [NA]
Epoch: 2, loss: 5.813127162456513, eval loss: [NA]
Epoch: 3, loss: 5.804930803775787, eval loss: [NA]
Epoch: 4, loss: 5.784766283035278, eval loss: [NA]
Epoch: 5, loss: 5.795291738510132, eval loss: [NA]
Epoch: 6, loss: 5.793664882183075, eval loss: [NA]
Epoch: 7, loss: 5.792828681468964, eval loss: [NA]
Epoch: 8, loss: 5.826687574386597, eval loss: [NA]
Epoch: 9, loss: 5.811753745079041, eval loss: [NA]
Epoch: 10, loss: 5.802029373645783, eval loss: [NA]
Epoch: 11, loss: 5.790885343551635, eval loss: [NA]
Epoch: 12, loss: 5.787172567844391, eval loss: [NA]
Epoch: 13, loss: 5.787054307460785, eval loss: [NA]
Epoch: 14, loss: 5.824485142230987, eval loss: [NA]
Epoch: 15, loss: 5.787448315620423, eval loss: [NA]
Epoch: 16, loss: 5.7845672559738155, eval loss: [NA]
Epoch: 17, loss: 5.80521406173706, eval loss: [NA]
Epoch: 18, loss: 5.801724951267243, eval loss: [NA]
Epoch: 19, loss: 5.784463529586792, eval loss: [NA]
Epoch: 20, loss: 5.816052570343017, eval loss: [NA]
Epoch: 21, loss: 5.785091602802277, eval loss: [NA]
Epoch: 22, loss: 5.790164318084717, eval loss: [NA]
Epoch: 23, loss: 5.791572091579437, eval loss: [NA]
Epoch: 24, loss: 5.7758368349075315, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.580208894348145, eval loss: [NA]
Epoch: 1, loss: 4.516588299560547, eval loss: [NA]
Epoch: 2, loss: 4.541378872680664, eval loss: [NA]
Epoch: 3, loss: 4.5469755386352535, eval loss: [NA]
Epoch: 4, loss: 4.533890426635742, eval loss: [NA]
Epoch: 5, loss: 4.5213447830200195, eval loss: [NA]
Epoch: 6, loss: 4.515289852905274, eval loss: [NA]
Epoch: 7, loss: 4.488844496154785, eval loss: [NA]
Epoch: 8, loss: 4.510167866516113, eval loss: [NA]
Epoch: 9, loss: 4.489384992980957, eval loss: [NA]
Epoch: 10, loss: 4.475153326416016, eval loss: [NA]
Epoch: 11, loss: 4.354321983337402, eval loss: [NA]
Epoch: 12, loss: 3.8674012161254883, eval loss: [NA]
Epoch: 13, loss: 3.6897752670288084, eval loss: [NA]
Epoch: 14, loss: 3.6671824310302736, eval loss: [NA]
Epoch: 15, loss: 3.6478426239013673, eval loss: [NA]
Epoch: 16, loss: 3.6074414932250978, eval loss: [NA]
Epoch: 17, loss: 3.5679759735107424, eval loss: [NA]
Epoch: 18, loss: 3.5762398208618165, eval loss: [NA]
Epoch: 19, loss: 3.603417234802246, eval loss: [NA]
Epoch: 20, loss: 3.5368393814086914, eval loss: [NA]
Epoch: 21, loss: 3.590273941040039, eval loss: [NA]
Epoch: 22, loss: 3.5986304122924806, eval loss: [NA]
Epoch: 23, loss: 3.555664309692383, eval loss: [NA]
Epoch: 24, loss: 3.527872035217285, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.308287456035614, eval loss: [NA]
Epoch: 1, loss: 5.366474738121033, eval loss: [NA]
Epoch: 2, loss: 5.320357146263123, eval loss: [NA]
Epoch: 3, loss: 5.315532321929932, eval loss: [NA]
Epoch: 4, loss: 5.321626341342926, eval loss: [NA]
Epoch: 5, loss: 5.314639298915863, eval loss: [NA]
Epoch: 6, loss: 5.335388121604919, eval loss: [NA]
Epoch: 7, loss: 5.345242881774903, eval loss: [NA]
Epoch: 8, loss: 5.3075253295898435, eval loss: [NA]
Epoch: 9, loss: 5.323895976543427, eval loss: [NA]
Epoch: 10, loss: 5.30152375459671, eval loss: [NA]
Epoch: 11, loss: 5.332849407196045, eval loss: [NA]
Epoch: 12, loss: 5.330369439125061, eval loss: [NA]
Epoch: 13, loss: 5.308202035427094, eval loss: [NA]
Epoch: 14, loss: 5.335293626785278, eval loss: [NA]
Epoch: 15, loss: 5.300700237751007, eval loss: [NA]
Epoch: 16, loss: 5.3127627944946285, eval loss: [NA]
Epoch: 17, loss: 5.310753669738769, eval loss: [NA]
Epoch: 18, loss: 5.32307778596878, eval loss: [NA]
Epoch: 19, loss: 5.32155966758728, eval loss: [NA]
Epoch: 20, loss: 5.320390706062317, eval loss: [NA]
Epoch: 21, loss: 5.3149574184417725, eval loss: [NA]
Epoch: 22, loss: 5.310382513999939, eval loss: [NA]
Epoch: 23, loss: 5.325314912796021, eval loss: [NA]
Epoch: 24, loss: 5.302210853099823, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.524055891418457, eval loss: [NA]
Epoch: 1, loss: 3.531519361877441, eval loss: [NA]
Epoch: 2, loss: 3.560241236877441, eval loss: [NA]
Epoch: 3, loss: 3.5490826889038085, eval loss: [NA]
Epoch: 4, loss: 3.5455273010253907, eval loss: [NA]
Epoch: 5, loss: 3.496534135437012, eval loss: [NA]
Epoch: 6, loss: 3.5124199813842774, eval loss: [NA]
Epoch: 7, loss: 3.5278450302124025, eval loss: [NA]
Epoch: 8, loss: 3.5235718460083008, eval loss: [NA]
Epoch: 9, loss: 3.489078500366211, eval loss: [NA]
Epoch: 10, loss: 3.4961495910644533, eval loss: [NA]
Epoch: 11, loss: 3.5209599365234374, eval loss: [NA]
Epoch: 12, loss: 3.499978251647949, eval loss: [NA]
Epoch: 13, loss: 3.530365298461914, eval loss: [NA]
Epoch: 14, loss: 3.4588799758911133, eval loss: [NA]
Epoch: 15, loss: 3.5099752670288087, eval loss: [NA]
Epoch: 16, loss: 3.5281603424072268, eval loss: [NA]
Epoch: 17, loss: 3.5150718292236327, eval loss: [NA]
Epoch: 18, loss: 3.486562173461914, eval loss: [NA]
Epoch: 19, loss: 3.4850805725097658, eval loss: [NA]
Epoch: 20, loss: 3.49221173248291, eval loss: [NA]
Epoch: 21, loss: 3.513952229309082, eval loss: [NA]
Epoch: 22, loss: 3.5001407623291017, eval loss: [NA]
Epoch: 23, loss: 3.4850913970947266, eval loss: [NA]
Epoch: 24, loss: 3.4769851501464846, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.121705758571625, eval loss: [NA]
Epoch: 1, loss: 5.12070056438446, eval loss: [NA]
Epoch: 2, loss: 5.121768417358399, eval loss: [NA]
Epoch: 3, loss: 5.120463778972626, eval loss: [NA]
Epoch: 4, loss: 5.1120964574813845, eval loss: [NA]
Epoch: 5, loss: 5.136065113544464, eval loss: [NA]
Epoch: 6, loss: 5.132032883167267, eval loss: [NA]
Epoch: 7, loss: 5.1314989900588985, eval loss: [NA]
Epoch: 8, loss: 5.1488854956626895, eval loss: [NA]
Epoch: 9, loss: 5.124895827770233, eval loss: [NA]
Epoch: 10, loss: 5.122266888618469, eval loss: [NA]
Epoch: 11, loss: 5.113269762992859, eval loss: [NA]
Epoch: 12, loss: 5.154906349182129, eval loss: [NA]
Epoch: 13, loss: 5.128998367786408, eval loss: [NA]
Epoch: 14, loss: 5.110779111385345, eval loss: [NA]
Epoch: 15, loss: 5.136702601909637, eval loss: [NA]
Epoch: 16, loss: 5.135644309520721, eval loss: [NA]
Epoch: 17, loss: 5.1240108728408815, eval loss: [NA]
Epoch: 18, loss: 5.137373218536377, eval loss: [NA]
Epoch: 19, loss: 5.157610175609588, eval loss: [NA]
Epoch: 20, loss: 5.155819160938263, eval loss: [NA]
Epoch: 21, loss: 5.118965096473694, eval loss: [NA]
Epoch: 22, loss: 5.131543786525726, eval loss: [NA]
Epoch: 23, loss: 5.094112062454224, eval loss: [NA]
Epoch: 24, loss: 5.136484668254853, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.478802737426758, eval loss: [NA]
Epoch: 1, loss: 3.456969711303711, eval loss: [NA]
Epoch: 2, loss: 3.483821060180664, eval loss: [NA]
Epoch: 3, loss: 3.468064601135254, eval loss: [NA]
Epoch: 4, loss: 3.4639909820556642, eval loss: [NA]
Epoch: 5, loss: 3.4863707794189454, eval loss: [NA]
Epoch: 6, loss: 3.4633777908325194, eval loss: [NA]
Epoch: 7, loss: 3.483571453857422, eval loss: [NA]
Epoch: 8, loss: 3.4652516891479492, eval loss: [NA]
Epoch: 9, loss: 3.451877621459961, eval loss: [NA]
Epoch: 10, loss: 3.4798854904174803, eval loss: [NA]
Epoch: 11, loss: 3.446617578125, eval loss: [NA]
Epoch: 12, loss: 3.475634896850586, eval loss: [NA]
Epoch: 13, loss: 3.4523857025146483, eval loss: [NA]
Epoch: 14, loss: 3.4756008834838865, eval loss: [NA]
Epoch: 15, loss: 3.4617112213134766, eval loss: [NA]
Epoch: 16, loss: 3.459660241699219, eval loss: [NA]
Epoch: 17, loss: 3.4558754959106444, eval loss: [NA]
Epoch: 18, loss: 3.425279052734375, eval loss: [NA]
Epoch: 19, loss: 3.4358062744140625, eval loss: [NA]
Epoch: 20, loss: 3.485073373413086, eval loss: [NA]
Epoch: 21, loss: 3.4589762802124024, eval loss: [NA]
Epoch: 22, loss: 3.4090772094726565, eval loss: [NA]
Epoch: 23, loss: 3.4560547286987306, eval loss: [NA]
Epoch: 24, loss: 3.4563635223388673, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.0997554039955135, eval loss: [NA]
Epoch: 1, loss: 5.093449971675873, eval loss: [NA]
Epoch: 2, loss: 5.104111561775207, eval loss: [NA]
Epoch: 3, loss: 5.079324095249176, eval loss: [NA]
Epoch: 4, loss: 5.1087216997146605, eval loss: [NA]
Epoch: 5, loss: 5.0875156474113465, eval loss: [NA]
Epoch: 6, loss: 5.137954411506652, eval loss: [NA]
Epoch: 7, loss: 5.126707401275635, eval loss: [NA]
Epoch: 8, loss: 5.097963094711304, eval loss: [NA]
Epoch: 9, loss: 5.107096090316772, eval loss: [NA]
Epoch: 10, loss: 5.099197285175324, eval loss: [NA]
Epoch: 11, loss: 5.110781774520874, eval loss: [NA]
Epoch: 12, loss: 5.126302275657654, eval loss: [NA]
Epoch: 13, loss: 5.101116907596588, eval loss: [NA]
Epoch: 14, loss: 5.0952432823181155, eval loss: [NA]
Epoch: 15, loss: 5.096764452457428, eval loss: [NA]
Epoch: 16, loss: 5.0975483655929565, eval loss: [NA]
Epoch: 17, loss: 5.096500945091248, eval loss: [NA]
Epoch: 18, loss: 5.103430087566376, eval loss: [NA]
Epoch: 19, loss: 5.099571573734283, eval loss: [NA]
Epoch: 20, loss: 5.071139433383942, eval loss: [NA]
Epoch: 21, loss: 5.1120654964447025, eval loss: [NA]
Epoch: 22, loss: 5.101539359092713, eval loss: [NA]
Epoch: 23, loss: 5.107246541976929, eval loss: [NA]
Epoch: 24, loss: 5.100934646129608, eval loss: [NA]

Runtime:386.54
[1576909814.8646, 0.4766, 0.1959, 0.1663]
[1.2208, 0.7461, 0.6164, 0.6105]
[2.1851, 0.885, 0.744, 0.746]
tensor(0.7436, grad_fn=<MeanBackward0>)
tensor(0.6067, grad_fn=<MeanBackward0>)
tensor([ 1.5556,  0.6396,  1.4025,  0.5604,  0.9379, -0.0294, -0.0964, -1.1123,
         0.2293, -0.7401], grad_fn=<MeanBackward1>)
tensor([1.2383, 1.3068, 1.1472, 1.2672, 0.3418, 0.3682, 0.3201, 0.3334, 0.3200,
        0.3542], grad_fn=<StdBackward1>)
tensor([ 2.2575,  1.4950,  1.5514,  0.8996,  0.9468, -0.0109, -0.3141, -1.1053,
         0.2689, -0.8532])
KL div untrained: 2679063767.8146
KL div trained: 0.166
