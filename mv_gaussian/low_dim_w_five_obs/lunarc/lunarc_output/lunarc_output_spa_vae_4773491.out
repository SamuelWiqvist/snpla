Input args:
Dim: 2
seed: 17
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1764, grad_fn=<MeanBackward0>)
tensor(2.4454, grad_fn=<MeanBackward0>)
tensor([-0.0604,  0.2062, -0.0116, -0.2343, -0.0752,  0.1351, -0.0141,  0.0735,
        -0.0080, -0.0762], grad_fn=<MeanBackward1>)
tensor([1.0038, 0.9237, 1.0766, 1.0376, 1.0276, 1.0364, 0.9765, 0.9679, 1.0602,
        1.0405], grad_fn=<StdBackward1>)
tensor([-4.8250, -1.1019, -3.1206,  0.6921, -3.1778,  0.2800, -4.5542, -1.4541,
        -1.0409,  2.7042])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.93413210144043, eval loss: [NA]
Epoch: 1, loss: 7.111178182983399, eval loss: [NA]
Epoch: 2, loss: 7.020647229003906, eval loss: [NA]
Epoch: 3, loss: 6.965873052978516, eval loss: [NA]
Epoch: 4, loss: 6.937955545043946, eval loss: [NA]
Epoch: 5, loss: 6.902955575561523, eval loss: [NA]
Epoch: 6, loss: 6.883078344726562, eval loss: [NA]
Epoch: 7, loss: 6.881510757446289, eval loss: [NA]
Epoch: 8, loss: 6.822172427368164, eval loss: [NA]
Epoch: 9, loss: 6.618690618896484, eval loss: [NA]
Epoch: 10, loss: 6.021860327148437, eval loss: [NA]
Epoch: 11, loss: 4.9907847579956055, eval loss: [NA]
Epoch: 12, loss: 4.360881495666504, eval loss: [NA]
Epoch: 13, loss: 4.069991007995606, eval loss: [NA]
Epoch: 14, loss: 3.9214417449951173, eval loss: [NA]
Epoch: 15, loss: 3.8122663528442384, eval loss: [NA]
Epoch: 16, loss: 3.784116320800781, eval loss: [NA]
Epoch: 17, loss: 3.751984475708008, eval loss: [NA]
Epoch: 18, loss: 3.7453602798461914, eval loss: [NA]
Epoch: 19, loss: 3.7573842102050783, eval loss: [NA]
Epoch: 20, loss: 3.6738275421142577, eval loss: [NA]
Epoch: 21, loss: 3.681127647399902, eval loss: [NA]
Epoch: 22, loss: 3.6580621185302733, eval loss: [NA]
Epoch: 23, loss: 3.654509329223633, eval loss: [NA]
Epoch: 24, loss: 3.6113445022583006, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.9679673954844474, eval loss: [NA]
Epoch: 1, loss: 0.8607365192472934, eval loss: [NA]
Epoch: 2, loss: 0.6442673155665397, eval loss: [NA]
Epoch: 3, loss: 0.5347117421030998, eval loss: [NA]
Epoch: 4, loss: 0.5531035132706166, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.578480005264282, eval loss: [NA]
Epoch: 1, loss: 8.542162079811096, eval loss: [NA]
Epoch: 2, loss: 8.550586061477661, eval loss: [NA]
Epoch: 3, loss: 8.549045906066894, eval loss: [NA]
Epoch: 4, loss: 8.535176310539246, eval loss: [NA]
Epoch: 5, loss: 8.531215481758117, eval loss: [NA]
Epoch: 6, loss: 8.528840942382812, eval loss: [NA]
Epoch: 7, loss: 8.508945019245148, eval loss: [NA]
Epoch: 8, loss: 8.535486216545104, eval loss: [NA]
Epoch: 9, loss: 8.521356749534608, eval loss: [NA]
Epoch: 10, loss: 8.51690745830536, eval loss: [NA]
Epoch: 11, loss: 8.509990844726563, eval loss: [NA]
Epoch: 12, loss: 8.500129628181458, eval loss: [NA]
Epoch: 13, loss: 8.503711323738099, eval loss: [NA]
Epoch: 14, loss: 8.554112749099732, eval loss: [NA]
Epoch: 15, loss: 8.494635038375854, eval loss: [NA]
Epoch: 16, loss: 8.540638933181762, eval loss: [NA]
Epoch: 17, loss: 8.53453957080841, eval loss: [NA]
Epoch: 18, loss: 8.54308512687683, eval loss: [NA]
Epoch: 19, loss: 8.526622257232667, eval loss: [NA]
Epoch: 20, loss: 8.498665506839751, eval loss: [NA]
Epoch: 21, loss: 8.503039960861207, eval loss: [NA]
Epoch: 22, loss: 8.500045657157898, eval loss: [NA]
Epoch: 23, loss: 8.503562984466553, eval loss: [NA]
Epoch: 24, loss: 8.536715755462646, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.6941026321411132, eval loss: [NA]
Epoch: 1, loss: 3.664767251586914, eval loss: [NA]
Epoch: 2, loss: 3.613543669128418, eval loss: [NA]
Epoch: 3, loss: 3.681592918395996, eval loss: [NA]
Epoch: 4, loss: 3.622469371032715, eval loss: [NA]
Epoch: 5, loss: 3.6303351333618163, eval loss: [NA]
Epoch: 6, loss: 3.6062136474609376, eval loss: [NA]
Epoch: 7, loss: 3.593002900695801, eval loss: [NA]
Epoch: 8, loss: 3.585873109436035, eval loss: [NA]
Epoch: 9, loss: 3.586914192199707, eval loss: [NA]
Epoch: 10, loss: 3.5721633193969726, eval loss: [NA]
Epoch: 11, loss: 3.597354585266113, eval loss: [NA]
Epoch: 12, loss: 3.599558953857422, eval loss: [NA]
Epoch: 13, loss: 3.5656734771728518, eval loss: [NA]
Epoch: 14, loss: 3.5649347244262697, eval loss: [NA]
Epoch: 15, loss: 3.5501978744506837, eval loss: [NA]
Epoch: 16, loss: 3.60463738861084, eval loss: [NA]
Epoch: 17, loss: 3.5468507751464844, eval loss: [NA]
Epoch: 18, loss: 3.5661410430908203, eval loss: [NA]
Epoch: 19, loss: 3.5792547286987304, eval loss: [NA]
Epoch: 20, loss: 3.5806506256103514, eval loss: [NA]
Epoch: 21, loss: 3.5607931335449217, eval loss: [NA]
Epoch: 22, loss: 3.590754992675781, eval loss: [NA]
Epoch: 23, loss: 3.571992640686035, eval loss: [NA]
Epoch: 24, loss: 3.56785382232666, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.954106352329254, eval loss: [NA]
Epoch: 1, loss: 7.917467219829559, eval loss: [NA]
Epoch: 2, loss: 7.927672724723816, eval loss: [NA]
Epoch: 3, loss: 7.939602813720703, eval loss: [NA]
Epoch: 4, loss: 7.938796215057373, eval loss: [NA]
Epoch: 5, loss: 7.939996495246887, eval loss: [NA]
Epoch: 6, loss: 7.931644022464752, eval loss: [NA]
Epoch: 7, loss: 7.917840111255646, eval loss: [NA]
Epoch: 8, loss: 7.938467016220093, eval loss: [NA]
Epoch: 9, loss: 7.9343078589439395, eval loss: [NA]
Epoch: 10, loss: 7.929349195957184, eval loss: [NA]
Epoch: 11, loss: 7.921870436668396, eval loss: [NA]
Epoch: 12, loss: 7.9270977520942685, eval loss: [NA]
Epoch: 13, loss: 7.909989020824432, eval loss: [NA]
Epoch: 14, loss: 7.91844661951065, eval loss: [NA]
Epoch: 15, loss: 7.9498958897590635, eval loss: [NA]
Epoch: 16, loss: 7.937236995697021, eval loss: [NA]
Epoch: 17, loss: 7.929461808204651, eval loss: [NA]
Epoch: 18, loss: 7.918415439128876, eval loss: [NA]
Epoch: 19, loss: 7.9571290516853335, eval loss: [NA]
Epoch: 20, loss: 7.935067400932312, eval loss: [NA]
Epoch: 21, loss: 7.91011901140213, eval loss: [NA]
Epoch: 22, loss: 7.914698264598846, eval loss: [NA]
Epoch: 23, loss: 7.890570044517517, eval loss: [NA]
Epoch: 24, loss: 7.9371661281585695, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5231318145751955, eval loss: [NA]
Epoch: 1, loss: 3.5076886993408203, eval loss: [NA]
Epoch: 2, loss: 3.5174867553710936, eval loss: [NA]
Epoch: 3, loss: 3.4902127639770506, eval loss: [NA]
Epoch: 4, loss: 3.502344059753418, eval loss: [NA]
Epoch: 5, loss: 3.4890795959472656, eval loss: [NA]
Epoch: 6, loss: 3.4788503509521482, eval loss: [NA]
Epoch: 7, loss: 3.5008301559448243, eval loss: [NA]
Epoch: 8, loss: 3.4875650390625, eval loss: [NA]
Epoch: 9, loss: 3.516116093444824, eval loss: [NA]
Epoch: 10, loss: 3.5415644668579103, eval loss: [NA]
Epoch: 11, loss: 3.4642083251953126, eval loss: [NA]
Epoch: 12, loss: 3.4963508255004885, eval loss: [NA]
Epoch: 13, loss: 3.4570999893188477, eval loss: [NA]
Epoch: 14, loss: 3.4683174057006836, eval loss: [NA]
Epoch: 15, loss: 3.507612480163574, eval loss: [NA]
Epoch: 16, loss: 3.479031898498535, eval loss: [NA]
Epoch: 17, loss: 3.474202018737793, eval loss: [NA]
Epoch: 18, loss: 3.4485051971435547, eval loss: [NA]
Epoch: 19, loss: 3.4882329467773436, eval loss: [NA]
Epoch: 20, loss: 3.488140950012207, eval loss: [NA]
Epoch: 21, loss: 3.487707421875, eval loss: [NA]
Epoch: 22, loss: 3.4931988677978514, eval loss: [NA]
Epoch: 23, loss: 3.4535075469970704, eval loss: [NA]
Epoch: 24, loss: 3.4759675399780274, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 8.65217321395874, eval loss: [NA]
Epoch: 1, loss: 8.660350213050842, eval loss: [NA]
Epoch: 2, loss: 8.6595068359375, eval loss: [NA]
Epoch: 3, loss: 8.670718479156495, eval loss: [NA]
Epoch: 4, loss: 8.650427393913269, eval loss: [NA]
Epoch: 5, loss: 8.618589725494385, eval loss: [NA]
Epoch: 6, loss: 8.706428484916687, eval loss: [NA]
Epoch: 7, loss: 8.658371772766113, eval loss: [NA]
Epoch: 8, loss: 8.638409390449524, eval loss: [NA]
Epoch: 9, loss: 8.637551717758178, eval loss: [NA]
Epoch: 10, loss: 8.654731492996216, eval loss: [NA]
Epoch: 11, loss: 8.637198882102966, eval loss: [NA]
Epoch: 12, loss: 8.643553714752198, eval loss: [NA]
Epoch: 13, loss: 8.675333771705628, eval loss: [NA]
Epoch: 14, loss: 8.641742315292358, eval loss: [NA]
Epoch: 15, loss: 8.6569375705719, eval loss: [NA]
Epoch: 16, loss: 8.659768991470337, eval loss: [NA]
Epoch: 17, loss: 8.647559900283813, eval loss: [NA]
Epoch: 18, loss: 8.632792563438416, eval loss: [NA]
Epoch: 19, loss: 8.654627208709718, eval loss: [NA]
Epoch: 20, loss: 8.658848719596863, eval loss: [NA]
Epoch: 21, loss: 8.658800039291382, eval loss: [NA]
Epoch: 22, loss: 8.624277391433715, eval loss: [NA]
Epoch: 23, loss: 8.654089541435242, eval loss: [NA]
Epoch: 24, loss: 8.631116652488709, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.502161311340332, eval loss: [NA]
Epoch: 1, loss: 3.54023836517334, eval loss: [NA]
Epoch: 2, loss: 3.5321172882080076, eval loss: [NA]
Epoch: 3, loss: 3.502517752075195, eval loss: [NA]
Epoch: 4, loss: 3.5125990936279297, eval loss: [NA]
Epoch: 5, loss: 3.4994785919189453, eval loss: [NA]
Epoch: 6, loss: 3.483128189086914, eval loss: [NA]
Epoch: 7, loss: 3.47275802154541, eval loss: [NA]
Epoch: 8, loss: 3.5305351013183595, eval loss: [NA]
Epoch: 9, loss: 3.505354150390625, eval loss: [NA]
Epoch: 10, loss: 3.4936610916137694, eval loss: [NA]
Epoch: 11, loss: 3.4977777145385742, eval loss: [NA]
Epoch: 12, loss: 3.457058024597168, eval loss: [NA]
Epoch: 13, loss: 3.472875521850586, eval loss: [NA]
Epoch: 14, loss: 3.491571936035156, eval loss: [NA]
Epoch: 15, loss: 3.5018445098876954, eval loss: [NA]
Epoch: 16, loss: 3.504578910827637, eval loss: [NA]
Epoch: 17, loss: 3.4924223709106443, eval loss: [NA]
Epoch: 18, loss: 3.474731861877441, eval loss: [NA]
Epoch: 19, loss: 3.4699082092285156, eval loss: [NA]
Epoch: 20, loss: 3.478890933227539, eval loss: [NA]
Epoch: 21, loss: 3.492463703918457, eval loss: [NA]
Epoch: 22, loss: 3.4990442276000975, eval loss: [NA]
Epoch: 23, loss: 3.507233123779297, eval loss: [NA]
Epoch: 24, loss: 3.4715843856811524, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.958832926750183, eval loss: [NA]
Epoch: 1, loss: 7.957232723236084, eval loss: [NA]
Epoch: 2, loss: 7.952107594013214, eval loss: [NA]
Epoch: 3, loss: 7.96901041507721, eval loss: [NA]
Epoch: 4, loss: 7.943325643539429, eval loss: [NA]
Epoch: 5, loss: 7.971333975791931, eval loss: [NA]
Epoch: 6, loss: 7.947658202648163, eval loss: [NA]
Epoch: 7, loss: 7.941617584228515, eval loss: [NA]
Epoch: 8, loss: 7.952539415359497, eval loss: [NA]
Epoch: 9, loss: 7.95745728969574, eval loss: [NA]
Epoch: 10, loss: 7.944707579612732, eval loss: [NA]
Epoch: 11, loss: 7.969664349555969, eval loss: [NA]
Epoch: 12, loss: 7.963146002292633, eval loss: [NA]
Epoch: 13, loss: 7.965318076610565, eval loss: [NA]
Epoch: 14, loss: 7.966385788917542, eval loss: [NA]
Epoch: 15, loss: 7.928468513488769, eval loss: [NA]
Epoch: 16, loss: 7.949916405677795, eval loss: [NA]
Epoch: 17, loss: 7.957790186405182, eval loss: [NA]
Epoch: 18, loss: 7.945919210910797, eval loss: [NA]
Epoch: 19, loss: 7.942192404270172, eval loss: [NA]
Epoch: 20, loss: 7.9555328392982485, eval loss: [NA]
Epoch: 21, loss: 7.967230389118194, eval loss: [NA]
Epoch: 22, loss: 7.951472005844116, eval loss: [NA]
Epoch: 23, loss: 7.955209062099457, eval loss: [NA]
Epoch: 24, loss: 7.960473184585571, eval loss: [NA]

Runtime:409.22
[35819361706331.664, 0.4334, 0.1192, 0.199]
[2.4454, 0.7294, 0.728, 0.7439]
[2.1764, 0.7612, 0.7519, 0.7584]
tensor(0.7505, grad_fn=<MeanBackward0>)
tensor(0.7383, grad_fn=<MeanBackward0>)
tensor([-3.2958,  0.4951, -3.2867,  0.4624, -3.3066,  0.4455, -4.8514, -1.1871,
        -1.1423,  2.8675], grad_fn=<MeanBackward1>)
tensor([1.2208, 1.3073, 1.2200, 1.3275, 0.3329, 0.3408, 0.3419, 0.3419, 0.3341,
        0.3608], grad_fn=<StdBackward1>)
tensor([-4.8250, -1.1019, -3.1206,  0.6921, -3.1778,  0.2800, -4.5542, -1.4541,
        -1.0409,  2.7042])
KL div untrained: 47587443394594.805
KL div trained: 0.2052
