/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1688, grad_fn=<MeanBackward0>)
tensor(1.5733, grad_fn=<MeanBackward0>)
tensor([-0.1680,  0.3307,  0.0192, -0.0703, -0.1006,  0.2060, -0.0345,  0.1356,
        -0.0340,  0.1783], grad_fn=<MeanBackward1>)
tensor([0.9249, 0.9368, 0.9876, 1.0175, 0.8775, 0.9649, 0.9486, 0.9269, 1.0288,
        1.0838], grad_fn=<StdBackward1>)
tensor([-0.5011,  1.8690,  0.7865,  2.4942,  1.6625,  3.4749, -0.7470,  1.7802,
        -0.1656,  1.3073])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 12.122295654296876, eval loss: [NA]
Epoch: 1, loss: 7.106868576049805, eval loss: [NA]
Epoch: 2, loss: 7.0014042449951175, eval loss: [NA]
Epoch: 3, loss: 6.9670001953125, eval loss: [NA]
Epoch: 4, loss: 6.894577206420898, eval loss: [NA]
Epoch: 5, loss: 6.699035971069336, eval loss: [NA]
Epoch: 6, loss: 6.352935479736328, eval loss: [NA]
Epoch: 7, loss: 6.126541177368164, eval loss: [NA]
Epoch: 8, loss: 5.929164012145996, eval loss: [NA]
Epoch: 9, loss: 5.6761598358154295, eval loss: [NA]
Epoch: 10, loss: 5.384083195495606, eval loss: [NA]
Epoch: 11, loss: 5.109355027770996, eval loss: [NA]
Epoch: 12, loss: 4.579288581848145, eval loss: [NA]
Epoch: 13, loss: 4.175587861633301, eval loss: [NA]
Epoch: 14, loss: 3.986164875793457, eval loss: [NA]
Epoch: 15, loss: 3.9122348175048827, eval loss: [NA]
Epoch: 16, loss: 3.8840613540649414, eval loss: [NA]
Epoch: 17, loss: 3.8549282638549807, eval loss: [NA]
Epoch: 18, loss: 3.7654927810668943, eval loss: [NA]
Epoch: 19, loss: 3.751957516479492, eval loss: [NA]
Epoch: 20, loss: 3.74592619934082, eval loss: [NA]
Epoch: 21, loss: 3.725137649536133, eval loss: [NA]
Epoch: 22, loss: 3.7237812805175783, eval loss: [NA]
Epoch: 23, loss: 3.684294873046875, eval loss: [NA]
Epoch: 24, loss: 3.6501238906860354, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 23.37875886440277, eval loss: [NA]
Epoch: 1, loss: 5.9389794421195985, eval loss: [NA]
Epoch: 2, loss: 5.920227842330933, eval loss: [NA]
Epoch: 3, loss: 5.8928939056396485, eval loss: [NA]
Epoch: 4, loss: 5.888658833503723, eval loss: [NA]
Epoch: 5, loss: 5.901310825347901, eval loss: [NA]
Epoch: 6, loss: 5.881220726966858, eval loss: [NA]
Epoch: 7, loss: 5.894718236923218, eval loss: [NA]
Epoch: 8, loss: 5.9238956880569456, eval loss: [NA]
Epoch: 9, loss: 5.891085176467896, eval loss: [NA]
Epoch: 10, loss: 5.912277388572693, eval loss: [NA]
Epoch: 11, loss: 5.915422675609588, eval loss: [NA]
Epoch: 12, loss: 5.8899465179443355, eval loss: [NA]
Epoch: 13, loss: 5.88144038438797, eval loss: [NA]
Epoch: 14, loss: 5.895032572746277, eval loss: [NA]
Epoch: 15, loss: 5.905399508476258, eval loss: [NA]
Epoch: 16, loss: 5.900200214385986, eval loss: [NA]
Epoch: 17, loss: 5.920167787075043, eval loss: [NA]
Epoch: 18, loss: 5.881056761741638, eval loss: [NA]
Epoch: 19, loss: 5.909511263370514, eval loss: [NA]
Epoch: 20, loss: 5.899054811000824, eval loss: [NA]
Epoch: 21, loss: 5.9043424654006955, eval loss: [NA]
Epoch: 22, loss: 5.921966714859009, eval loss: [NA]
Epoch: 23, loss: 5.905087528228759, eval loss: [NA]
Epoch: 24, loss: 5.9273794388771055, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.601158969116211, eval loss: [NA]
Epoch: 1, loss: 3.5900350677490236, eval loss: [NA]
Epoch: 2, loss: 3.5586630447387697, eval loss: [NA]
Epoch: 3, loss: 3.542441716003418, eval loss: [NA]
Epoch: 4, loss: 3.5078796127319336, eval loss: [NA]
Epoch: 5, loss: 3.5310502487182616, eval loss: [NA]
Epoch: 6, loss: 3.5424757095336914, eval loss: [NA]
Epoch: 7, loss: 3.5320664916992186, eval loss: [NA]
Epoch: 8, loss: 3.5398475128173827, eval loss: [NA]
Epoch: 9, loss: 3.5792637832641603, eval loss: [NA]
Epoch: 10, loss: 3.5105847290039063, eval loss: [NA]
Epoch: 11, loss: 3.5193882522583007, eval loss: [NA]
Epoch: 12, loss: 3.5282847381591798, eval loss: [NA]
Epoch: 13, loss: 3.4819957748413084, eval loss: [NA]
Epoch: 14, loss: 3.502487438964844, eval loss: [NA]
Epoch: 15, loss: 3.5262304107666016, eval loss: [NA]
Epoch: 16, loss: 3.5438682662963865, eval loss: [NA]
Epoch: 17, loss: 3.492604248046875, eval loss: [NA]
Epoch: 18, loss: 3.521118357849121, eval loss: [NA]
Epoch: 19, loss: 3.496057261657715, eval loss: [NA]
Epoch: 20, loss: 3.5127657119750975, eval loss: [NA]
Epoch: 21, loss: 3.497273278808594, eval loss: [NA]
Epoch: 22, loss: 3.4987880752563476, eval loss: [NA]
Epoch: 23, loss: 3.5429373809814453, eval loss: [NA]
Epoch: 24, loss: 3.497961151123047, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.318693435192108, eval loss: [NA]
Epoch: 1, loss: 5.29640748500824, eval loss: [NA]
Epoch: 2, loss: 5.2913452959060665, eval loss: [NA]
Epoch: 3, loss: 5.298016624450684, eval loss: [NA]
Epoch: 4, loss: 5.307120099067688, eval loss: [NA]
Epoch: 5, loss: 5.312216691970825, eval loss: [NA]
Epoch: 6, loss: 5.300286114215851, eval loss: [NA]
Epoch: 7, loss: 5.300083329677582, eval loss: [NA]
Epoch: 8, loss: 5.317899980545044, eval loss: [NA]
Epoch: 9, loss: 5.279347450733185, eval loss: [NA]
Epoch: 10, loss: 5.28605806350708, eval loss: [NA]
Epoch: 11, loss: 5.300771696567535, eval loss: [NA]
Epoch: 12, loss: 5.300670523643493, eval loss: [NA]
Epoch: 13, loss: 5.295114443302155, eval loss: [NA]
Epoch: 14, loss: 5.281835384368897, eval loss: [NA]
Epoch: 15, loss: 5.280541791915893, eval loss: [NA]
Epoch: 16, loss: 5.3220062875747685, eval loss: [NA]
Epoch: 17, loss: 5.312414836883545, eval loss: [NA]
Epoch: 18, loss: 5.334176480770111, eval loss: [NA]
Epoch: 19, loss: 5.295264203548431, eval loss: [NA]
Epoch: 20, loss: 5.304578034877777, eval loss: [NA]
Epoch: 21, loss: 5.308201434612275, eval loss: [NA]
Epoch: 22, loss: 5.293660542964935, eval loss: [NA]
Epoch: 23, loss: 5.302066497802734, eval loss: [NA]
Epoch: 24, loss: 5.2998779273033145, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5409761810302736, eval loss: [NA]
Epoch: 1, loss: 3.548682827758789, eval loss: [NA]
Epoch: 2, loss: 3.501679020690918, eval loss: [NA]
Epoch: 3, loss: 3.509742642211914, eval loss: [NA]
Epoch: 4, loss: 3.5082512710571288, eval loss: [NA]
Epoch: 5, loss: 3.4790416595458984, eval loss: [NA]
Epoch: 6, loss: 3.4956653930664063, eval loss: [NA]
Epoch: 7, loss: 3.509254917907715, eval loss: [NA]
Epoch: 8, loss: 3.4790383224487305, eval loss: [NA]
Epoch: 9, loss: 3.5169080215454103, eval loss: [NA]
Epoch: 10, loss: 3.481599305725098, eval loss: [NA]
Epoch: 11, loss: 3.4630435928344725, eval loss: [NA]
Epoch: 12, loss: 3.5218422698974607, eval loss: [NA]
Epoch: 13, loss: 3.4798194580078126, eval loss: [NA]
Epoch: 14, loss: 3.4637303802490234, eval loss: [NA]
Epoch: 15, loss: 3.5195327850341798, eval loss: [NA]
Epoch: 16, loss: 3.4961709884643555, eval loss: [NA]
Epoch: 17, loss: 3.522551022338867, eval loss: [NA]
Epoch: 18, loss: 3.4797169845581055, eval loss: [NA]
Epoch: 19, loss: 3.4787866088867188, eval loss: [NA]
Epoch: 20, loss: 3.451236781311035, eval loss: [NA]
Epoch: 21, loss: 3.461673582458496, eval loss: [NA]
Epoch: 22, loss: 3.4708965881347655, eval loss: [NA]
Epoch: 23, loss: 3.46332880859375, eval loss: [NA]
Epoch: 24, loss: 3.5305306900024416, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.942811381816864, eval loss: [NA]
Epoch: 1, loss: 5.933635535240174, eval loss: [NA]
Epoch: 2, loss: 5.941612989902496, eval loss: [NA]
Epoch: 3, loss: 5.923628289699554, eval loss: [NA]
Epoch: 4, loss: 5.8948879814147945, eval loss: [NA]
Epoch: 5, loss: 5.9025057721138, eval loss: [NA]
Epoch: 6, loss: 5.921945493221283, eval loss: [NA]
Epoch: 7, loss: 5.9158481287956235, eval loss: [NA]
Epoch: 8, loss: 5.9064045643806455, eval loss: [NA]
Epoch: 9, loss: 5.932040121555328, eval loss: [NA]
Epoch: 10, loss: 5.938199110031128, eval loss: [NA]
Epoch: 11, loss: 5.9105178427696226, eval loss: [NA]
Epoch: 12, loss: 5.924002151489258, eval loss: [NA]
Epoch: 13, loss: 5.926355612277985, eval loss: [NA]
Epoch: 14, loss: 5.916838054656982, eval loss: [NA]
Epoch: 15, loss: 5.9368827080726625, eval loss: [NA]
Epoch: 16, loss: 5.906845941543579, eval loss: [NA]
Epoch: 17, loss: 5.921887805461884, eval loss: [NA]
Epoch: 18, loss: 5.9155151915550235, eval loss: [NA]
Epoch: 19, loss: 5.897454602718353, eval loss: [NA]
Epoch: 20, loss: 5.917389903068543, eval loss: [NA]
Epoch: 21, loss: 5.915225594043732, eval loss: [NA]
Epoch: 22, loss: 5.913705615997315, eval loss: [NA]
Epoch: 23, loss: 5.906602931022644, eval loss: [NA]
Epoch: 24, loss: 5.9220734572410585, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4989714859008787, eval loss: [NA]
Epoch: 1, loss: 3.442060678100586, eval loss: [NA]
Epoch: 2, loss: 3.45268973236084, eval loss: [NA]
Epoch: 3, loss: 3.4340039810180665, eval loss: [NA]
Epoch: 4, loss: 3.443344827270508, eval loss: [NA]
Epoch: 5, loss: 3.4424665924072264, eval loss: [NA]
Epoch: 6, loss: 3.43586251373291, eval loss: [NA]
Epoch: 7, loss: 3.466517446899414, eval loss: [NA]
Epoch: 8, loss: 3.4436497497558594, eval loss: [NA]
Epoch: 9, loss: 3.43878975982666, eval loss: [NA]
Epoch: 10, loss: 3.4843603286743163, eval loss: [NA]
Epoch: 11, loss: 3.4594012847900393, eval loss: [NA]
Epoch: 12, loss: 3.4322559539794923, eval loss: [NA]
Epoch: 13, loss: 3.4725063323974608, eval loss: [NA]
Epoch: 14, loss: 3.447483319091797, eval loss: [NA]
Epoch: 15, loss: 3.4160913925170897, eval loss: [NA]
Epoch: 16, loss: 3.4404476135253907, eval loss: [NA]
Epoch: 17, loss: 3.4311814636230467, eval loss: [NA]
Epoch: 18, loss: 3.4261483032226563, eval loss: [NA]
Epoch: 19, loss: 3.416626768493652, eval loss: [NA]
Epoch: 20, loss: 3.420287626647949, eval loss: [NA]
Epoch: 21, loss: 3.4389991439819334, eval loss: [NA]
Epoch: 22, loss: 3.4234021224975586, eval loss: [NA]
Epoch: 23, loss: 3.453816357421875, eval loss: [NA]
Epoch: 24, loss: 3.4088751953125, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.373856110572815, eval loss: [NA]
Epoch: 1, loss: 5.359876058101654, eval loss: [NA]
Epoch: 2, loss: 5.365596647262573, eval loss: [NA]
Epoch: 3, loss: 5.3635058808326725, eval loss: [NA]
Epoch: 4, loss: 5.356669659614563, eval loss: [NA]
Epoch: 5, loss: 5.365950276851654, eval loss: [NA]
Epoch: 6, loss: 5.371795420646667, eval loss: [NA]
Epoch: 7, loss: 5.351967265605927, eval loss: [NA]
Epoch: 8, loss: 5.352298009395599, eval loss: [NA]
Epoch: 9, loss: 5.361556150913239, eval loss: [NA]
Epoch: 10, loss: 5.339899151325226, eval loss: [NA]
Epoch: 11, loss: 5.370419487953186, eval loss: [NA]
Epoch: 12, loss: 5.322032344341278, eval loss: [NA]
Epoch: 13, loss: 5.34227379322052, eval loss: [NA]
Epoch: 14, loss: 5.372581739425659, eval loss: [NA]
Epoch: 15, loss: 5.374206171035767, eval loss: [NA]
Epoch: 16, loss: 5.347945394515992, eval loss: [NA]
Epoch: 17, loss: 5.345344281196594, eval loss: [NA]
Epoch: 18, loss: 5.370916781425476, eval loss: [NA]
Epoch: 19, loss: 5.34813143491745, eval loss: [NA]
Epoch: 20, loss: 5.334264495372772, eval loss: [NA]
Epoch: 21, loss: 5.349937303066254, eval loss: [NA]
Epoch: 22, loss: 5.366518437862396, eval loss: [NA]
Epoch: 23, loss: 5.348205389976502, eval loss: [NA]
Epoch: 24, loss: 5.3699094319343565, eval loss: [NA]

Runtime:391.69
[2710.9055, 0.2721, 0.1522, 0.1439]
[1.5733, 0.6052, 0.5916, 0.5856]
[2.1688, 0.7565, 0.7445, 0.7551]
tensor(0.7499, grad_fn=<MeanBackward0>)
tensor(0.5868, grad_fn=<MeanBackward0>)
tensor([-0.3932,  1.6977,  0.4734,  2.5890,  1.4292,  3.6212, -0.5150,  1.6284,
        -0.3623,  1.7104], grad_fn=<MeanBackward1>)
tensor([0.3158, 0.3377, 0.3112, 0.3452, 0.3099, 0.3387, 1.2470, 1.2383, 1.1524,
        1.2947], grad_fn=<StdBackward1>)
tensor([-0.5011,  1.8690,  0.7865,  2.4942,  1.6625,  3.4749, -0.7470,  1.7802,
        -0.1656,  1.3073])
KL div untrained: 12508.5209
KL div trained: 0.0993
