Input args:
Dim: 2
seed: 25
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1724, grad_fn=<MeanBackward0>)
tensor(2.7552, grad_fn=<MeanBackward0>)
tensor([-0.0303, -0.0731, -0.0977, -0.0300, -0.1215,  0.1442, -0.2380, -0.1705,
        -0.0573,  0.0605], grad_fn=<MeanBackward1>)
tensor([1.0420, 0.9609, 1.0515, 0.9891, 1.0556, 1.0390, 0.9056, 0.9532, 0.9903,
        0.9880], grad_fn=<StdBackward1>)
tensor([4.0212, 1.7001, 4.4372, 2.3203, 3.6942, 1.1774, 2.9750, 0.3447, 3.7581,
        1.9258])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.829631259155274, eval loss: [NA]
Epoch: 1, loss: 7.098298873901367, eval loss: [NA]
Epoch: 2, loss: 6.992323709106445, eval loss: [NA]
Epoch: 3, loss: 6.941874227905274, eval loss: [NA]
Epoch: 4, loss: 6.91564557800293, eval loss: [NA]
Epoch: 5, loss: 6.902437023925781, eval loss: [NA]
Epoch: 6, loss: 6.891223257446289, eval loss: [NA]
Epoch: 7, loss: 6.8451073974609375, eval loss: [NA]
Epoch: 8, loss: 6.657773721313476, eval loss: [NA]
Epoch: 9, loss: 6.327408378601074, eval loss: [NA]
Epoch: 10, loss: 5.984988566589355, eval loss: [NA]
Epoch: 11, loss: 5.91583176574707, eval loss: [NA]
Epoch: 12, loss: 5.845517208862304, eval loss: [NA]
Epoch: 13, loss: 5.837425057983398, eval loss: [NA]
Epoch: 14, loss: 5.795459683227539, eval loss: [NA]
Epoch: 15, loss: 5.771039152526855, eval loss: [NA]
Epoch: 16, loss: 5.677169131469727, eval loss: [NA]
Epoch: 17, loss: 5.355342153930664, eval loss: [NA]
Epoch: 18, loss: 4.9367105056762695, eval loss: [NA]
Epoch: 19, loss: 4.787308038330078, eval loss: [NA]
Epoch: 20, loss: 4.695350428771973, eval loss: [NA]
Epoch: 21, loss: 4.690050540161133, eval loss: [NA]
Epoch: 22, loss: 4.639528271484375, eval loss: [NA]
Epoch: 23, loss: 4.692768501281738, eval loss: [NA]
Epoch: 24, loss: 4.625868954467774, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.9760909229516983, eval loss: [NA]
Epoch: 1, loss: 0.8591967579722405, eval loss: [NA]
Epoch: 2, loss: 0.6416183565557003, eval loss: [NA]
Epoch: 3, loss: 0.5757124195992946, eval loss: [NA]
Epoch: 4, loss: 0.5470273626595735, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.439271869659424, eval loss: [NA]
Epoch: 1, loss: 6.402252802848816, eval loss: [NA]
Epoch: 2, loss: 6.402465898990631, eval loss: [NA]
Epoch: 3, loss: 6.422431802749633, eval loss: [NA]
Epoch: 4, loss: 6.4098007369041445, eval loss: [NA]
Epoch: 5, loss: 6.440907101631165, eval loss: [NA]
Epoch: 6, loss: 6.383356683254242, eval loss: [NA]
Epoch: 7, loss: 6.389833507537841, eval loss: [NA]
Epoch: 8, loss: 6.412426896095276, eval loss: [NA]
Epoch: 9, loss: 6.406166484355927, eval loss: [NA]
Epoch: 10, loss: 6.398197984695434, eval loss: [NA]
Epoch: 11, loss: 6.384458329677582, eval loss: [NA]
Epoch: 12, loss: 6.392586793899536, eval loss: [NA]
Epoch: 13, loss: 6.390349793434143, eval loss: [NA]
Epoch: 14, loss: 6.418975372314453, eval loss: [NA]
Epoch: 15, loss: 6.392442195415497, eval loss: [NA]
Epoch: 16, loss: 6.391117103099823, eval loss: [NA]
Epoch: 17, loss: 6.395070056915284, eval loss: [NA]
Epoch: 18, loss: 6.3910618805885315, eval loss: [NA]
Epoch: 19, loss: 6.389713649749756, eval loss: [NA]
Epoch: 20, loss: 6.380429692268372, eval loss: [NA]
Epoch: 21, loss: 6.37050660610199, eval loss: [NA]
Epoch: 22, loss: 6.393265135288239, eval loss: [NA]
Epoch: 23, loss: 6.368392679691315, eval loss: [NA]
Epoch: 24, loss: 6.386062169075013, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.6049618194580075, eval loss: [NA]
Epoch: 1, loss: 4.574745317077637, eval loss: [NA]
Epoch: 2, loss: 4.548577709960938, eval loss: [NA]
Epoch: 3, loss: 4.518187501525879, eval loss: [NA]
Epoch: 4, loss: 4.374907524108886, eval loss: [NA]
Epoch: 5, loss: 3.9080439102172853, eval loss: [NA]
Epoch: 6, loss: 3.740467614746094, eval loss: [NA]
Epoch: 7, loss: 3.64996502532959, eval loss: [NA]
Epoch: 8, loss: 3.6388807052612306, eval loss: [NA]
Epoch: 9, loss: 3.6391711044311523, eval loss: [NA]
Epoch: 10, loss: 3.6535680252075196, eval loss: [NA]
Epoch: 11, loss: 3.5769332763671877, eval loss: [NA]
Epoch: 12, loss: 3.5990251800537107, eval loss: [NA]
Epoch: 13, loss: 3.5507506912231444, eval loss: [NA]
Epoch: 14, loss: 3.597366665649414, eval loss: [NA]
Epoch: 15, loss: 3.56458341217041, eval loss: [NA]
Epoch: 16, loss: 3.555994061279297, eval loss: [NA]
Epoch: 17, loss: 3.5735526657104493, eval loss: [NA]
Epoch: 18, loss: 3.521889981079102, eval loss: [NA]
Epoch: 19, loss: 3.5907983139038087, eval loss: [NA]
Epoch: 20, loss: 3.5456748962402345, eval loss: [NA]
Epoch: 21, loss: 3.50650577545166, eval loss: [NA]
Epoch: 22, loss: 3.517177024841309, eval loss: [NA]
Epoch: 23, loss: 3.526954132080078, eval loss: [NA]
Epoch: 24, loss: 3.483265998840332, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.365972566604614, eval loss: [NA]
Epoch: 1, loss: 6.3501877903938295, eval loss: [NA]
Epoch: 2, loss: 6.331523900032043, eval loss: [NA]
Epoch: 3, loss: 6.357046065330505, eval loss: [NA]
Epoch: 4, loss: 6.342995750904083, eval loss: [NA]
Epoch: 5, loss: 6.332287769317627, eval loss: [NA]
Epoch: 6, loss: 6.331740961074829, eval loss: [NA]
Epoch: 7, loss: 6.319421856403351, eval loss: [NA]
Epoch: 8, loss: 6.3279401755332945, eval loss: [NA]
Epoch: 9, loss: 6.328114309310913, eval loss: [NA]
Epoch: 10, loss: 6.312770581245422, eval loss: [NA]
Epoch: 11, loss: 6.314297232627869, eval loss: [NA]
Epoch: 12, loss: 6.3472325491905215, eval loss: [NA]
Epoch: 13, loss: 6.333930702209472, eval loss: [NA]
Epoch: 14, loss: 6.319543905258179, eval loss: [NA]
Epoch: 15, loss: 6.343583178520203, eval loss: [NA]
Epoch: 16, loss: 6.303252234458923, eval loss: [NA]
Epoch: 17, loss: 6.3110293102264405, eval loss: [NA]
Epoch: 18, loss: 6.3386111116409305, eval loss: [NA]
Epoch: 19, loss: 6.297098281383515, eval loss: [NA]
Epoch: 20, loss: 6.328668587207794, eval loss: [NA]
Epoch: 21, loss: 6.320900840759277, eval loss: [NA]
Epoch: 22, loss: 6.310543360710144, eval loss: [NA]
Epoch: 23, loss: 6.30330689907074, eval loss: [NA]
Epoch: 24, loss: 6.349884133338929, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.573023011779785, eval loss: [NA]
Epoch: 1, loss: 3.526980827331543, eval loss: [NA]
Epoch: 2, loss: 3.497794938659668, eval loss: [NA]
Epoch: 3, loss: 3.5349547622680664, eval loss: [NA]
Epoch: 4, loss: 3.542196806335449, eval loss: [NA]
Epoch: 5, loss: 3.510977229309082, eval loss: [NA]
Epoch: 6, loss: 3.5635434524536134, eval loss: [NA]
Epoch: 7, loss: 3.522391355895996, eval loss: [NA]
Epoch: 8, loss: 3.5049157318115234, eval loss: [NA]
Epoch: 9, loss: 3.5169238494873047, eval loss: [NA]
Epoch: 10, loss: 3.521427606201172, eval loss: [NA]
Epoch: 11, loss: 3.528841744995117, eval loss: [NA]
Epoch: 12, loss: 3.508510302734375, eval loss: [NA]
Epoch: 13, loss: 3.5072538314819335, eval loss: [NA]
Epoch: 14, loss: 3.542029345703125, eval loss: [NA]
Epoch: 15, loss: 3.5174233642578123, eval loss: [NA]
Epoch: 16, loss: 3.4895045654296877, eval loss: [NA]
Epoch: 17, loss: 3.5195309692382812, eval loss: [NA]
Epoch: 18, loss: 3.525767317199707, eval loss: [NA]
Epoch: 19, loss: 3.509478952026367, eval loss: [NA]
Epoch: 20, loss: 3.4680337463378907, eval loss: [NA]
Epoch: 21, loss: 3.5059272064208984, eval loss: [NA]
Epoch: 22, loss: 3.497204135131836, eval loss: [NA]
Epoch: 23, loss: 3.527381005859375, eval loss: [NA]
Epoch: 24, loss: 3.533466372680664, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.092863380908966, eval loss: [NA]
Epoch: 1, loss: 6.123068301677704, eval loss: [NA]
Epoch: 2, loss: 6.108142776489258, eval loss: [NA]
Epoch: 3, loss: 6.084947967529297, eval loss: [NA]
Epoch: 4, loss: 6.107466530799866, eval loss: [NA]
Epoch: 5, loss: 6.087408456802368, eval loss: [NA]
Epoch: 6, loss: 6.120243465900421, eval loss: [NA]
Epoch: 7, loss: 6.08158287525177, eval loss: [NA]
Epoch: 8, loss: 6.108051588535309, eval loss: [NA]
Epoch: 9, loss: 6.089153988361359, eval loss: [NA]
Epoch: 10, loss: 6.120327355861664, eval loss: [NA]
Epoch: 11, loss: 6.08001540184021, eval loss: [NA]
Epoch: 12, loss: 6.1004898381233215, eval loss: [NA]
Epoch: 13, loss: 6.100853047370911, eval loss: [NA]
Epoch: 14, loss: 6.101540534496308, eval loss: [NA]
Epoch: 15, loss: 6.1020006608963016, eval loss: [NA]
Epoch: 16, loss: 6.113181004524231, eval loss: [NA]
Epoch: 17, loss: 6.080276215076447, eval loss: [NA]
Epoch: 18, loss: 6.108529508113861, eval loss: [NA]
Epoch: 19, loss: 6.081220982074737, eval loss: [NA]
Epoch: 20, loss: 6.1240549921989444, eval loss: [NA]
Epoch: 21, loss: 6.09370985031128, eval loss: [NA]
Epoch: 22, loss: 6.109378364086151, eval loss: [NA]
Epoch: 23, loss: 6.083571183681488, eval loss: [NA]
Epoch: 24, loss: 6.091190533638001, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.562281980895996, eval loss: [NA]
Epoch: 1, loss: 3.5014454788208007, eval loss: [NA]
Epoch: 2, loss: 3.5164015396118162, eval loss: [NA]
Epoch: 3, loss: 3.5011761596679687, eval loss: [NA]
Epoch: 4, loss: 3.5282025787353515, eval loss: [NA]
Epoch: 5, loss: 3.5116995529174804, eval loss: [NA]
Epoch: 6, loss: 3.5261720275878905, eval loss: [NA]
Epoch: 7, loss: 3.5433187911987303, eval loss: [NA]
Epoch: 8, loss: 3.5118014739990233, eval loss: [NA]
Epoch: 9, loss: 3.516939161682129, eval loss: [NA]
Epoch: 10, loss: 3.515372331237793, eval loss: [NA]
Epoch: 11, loss: 3.504420474243164, eval loss: [NA]
Epoch: 12, loss: 3.506334490966797, eval loss: [NA]
Epoch: 13, loss: 3.534645735168457, eval loss: [NA]
Epoch: 14, loss: 3.4964232604980467, eval loss: [NA]
Epoch: 15, loss: 3.5186008407592775, eval loss: [NA]
Epoch: 16, loss: 3.4776023254394532, eval loss: [NA]
Epoch: 17, loss: 3.493380470275879, eval loss: [NA]
Epoch: 18, loss: 3.508920539855957, eval loss: [NA]
Epoch: 19, loss: 3.4587347229003904, eval loss: [NA]
Epoch: 20, loss: 3.516623599243164, eval loss: [NA]
Epoch: 21, loss: 3.477441923522949, eval loss: [NA]
Epoch: 22, loss: 3.4917860824584963, eval loss: [NA]
Epoch: 23, loss: 3.4619327682495116, eval loss: [NA]
Epoch: 24, loss: 3.5248021453857423, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.9189005994796755, eval loss: [NA]
Epoch: 1, loss: 5.940973162651062, eval loss: [NA]
Epoch: 2, loss: 5.954115662574768, eval loss: [NA]
Epoch: 3, loss: 5.958864212036133, eval loss: [NA]
Epoch: 4, loss: 5.9569749474525455, eval loss: [NA]
Epoch: 5, loss: 5.945977013111115, eval loss: [NA]
Epoch: 6, loss: 5.942422325611115, eval loss: [NA]
Epoch: 7, loss: 5.958203117847443, eval loss: [NA]
Epoch: 8, loss: 5.9404285883903505, eval loss: [NA]
Epoch: 9, loss: 5.9469543957710265, eval loss: [NA]
Epoch: 10, loss: 5.945567452907563, eval loss: [NA]
Epoch: 11, loss: 5.949054863452911, eval loss: [NA]
Epoch: 12, loss: 5.964651601314545, eval loss: [NA]
Epoch: 13, loss: 5.941266012191773, eval loss: [NA]
Epoch: 14, loss: 5.931149868965149, eval loss: [NA]
Epoch: 15, loss: 5.939092013835907, eval loss: [NA]
Epoch: 16, loss: 5.938034656047821, eval loss: [NA]
Epoch: 17, loss: 5.9456637716293335, eval loss: [NA]
Epoch: 18, loss: 5.936676836013794, eval loss: [NA]
Epoch: 19, loss: 5.94870171546936, eval loss: [NA]
Epoch: 20, loss: 5.9572212958335875, eval loss: [NA]
Epoch: 21, loss: 5.9527086687088016, eval loss: [NA]
Epoch: 22, loss: 5.953870875835419, eval loss: [NA]
Epoch: 23, loss: 5.944107367992401, eval loss: [NA]
Epoch: 24, loss: 5.956791899204254, eval loss: [NA]

Runtime:415.53
[3.27242751320657e+17, 0.4833, 0.1109, 0.2048]
[2.7552, 0.823, 0.8879, 0.8781]
[2.1724, 0.8753, 0.7368, 0.7635]
tensor(0.7785, grad_fn=<MeanBackward0>)
tensor(0.8717, grad_fn=<MeanBackward0>)
tensor([2.7011, 0.2904, 2.6936, 0.3172, 3.6052, 1.2088, 2.8588, 0.3720, 3.9711,
        1.5804], grad_fn=<MeanBackward1>)
tensor([1.1988, 1.2294, 1.2284, 1.2294, 0.3402, 0.3404, 0.3202, 0.3344, 0.3158,
        0.3224], grad_fn=<StdBackward1>)
tensor([4.0212, 1.7001, 4.4372, 2.3203, 3.6942, 1.1774, 2.9750, 0.3447, 3.7581,
        1.9258])
KL div untrained: 3.435309805890523e+17
KL div trained: 0.0899
