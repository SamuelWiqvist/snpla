Input args:
Dim: 2
seed: 1
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(7.3163e+12, grad_fn=<MeanBackward0>)
tensor(4.7830e+13, grad_fn=<MeanBackward0>)
tensor([-4.6041e+05, -3.9589e+14, -5.0935e+13, -4.5217e+07, -2.3184e+06,
        -2.2383e+13,  8.8022e+12,  2.8637e+11, -8.3586e+09, -7.1864e+07],
       grad_fn=<MeanBackward1>)
tensor([1.0768e+07, 1.2517e+16, 1.6105e+15, 1.0750e+09, 5.5489e+07, 7.0771e+14,
        2.7831e+14, 9.0546e+12, 2.6428e+11, 2.2722e+09],
       grad_fn=<StdBackward1>)
tensor([ 2.2575,  1.4950,  1.5514,  0.8996,  0.9468, -0.0109, -0.3141, -1.1053,
         0.2689, -0.8532])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 17.899057388305664, eval loss: [NA]
Epoch: 1, loss: 12.543257069587707, eval loss: [NA]
Epoch: 2, loss: 10.942695574760437, eval loss: [NA]
Epoch: 3, loss: 10.563428630828858, eval loss: [NA]
Epoch: 4, loss: 10.45095281124115, eval loss: [NA]
Epoch: 5, loss: 10.362071895599366, eval loss: [NA]
Epoch: 6, loss: 10.356957640647888, eval loss: [NA]
Epoch: 7, loss: 10.309047560691834, eval loss: [NA]
Epoch: 8, loss: 10.295744619369508, eval loss: [NA]
Epoch: 9, loss: 10.275967469215393, eval loss: [NA]
Epoch: 10, loss: 10.27361445426941, eval loss: [NA]
Epoch: 11, loss: 10.25140410900116, eval loss: [NA]
Epoch: 12, loss: 10.248990545272827, eval loss: [NA]
Epoch: 13, loss: 10.241164836883545, eval loss: [NA]
Epoch: 14, loss: 10.24613781452179, eval loss: [NA]
Epoch: 15, loss: 10.217105331420898, eval loss: [NA]
Epoch: 16, loss: 10.205856113433837, eval loss: [NA]
Epoch: 17, loss: 10.210979657173157, eval loss: [NA]
Epoch: 18, loss: 10.19429265975952, eval loss: [NA]
Epoch: 19, loss: 10.220410089492798, eval loss: [NA]
Epoch: 20, loss: 10.197458257675171, eval loss: [NA]
Epoch: 21, loss: 10.1833012008667, eval loss: [NA]
Epoch: 22, loss: 10.192274460792541, eval loss: [NA]
Epoch: 23, loss: 10.185261855125427, eval loss: [NA]
Epoch: 24, loss: 10.17883635044098, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 443.172514629364, eval loss: [NA]
Epoch: 1, loss: 12.815849633216859, eval loss: [NA]
Epoch: 2, loss: 12.022075934410095, eval loss: [NA]
Epoch: 3, loss: 11.761772608757019, eval loss: [NA]
Epoch: 4, loss: 11.605843811035156, eval loss: [NA]
Epoch: 5, loss: 11.498438577651978, eval loss: [NA]
Epoch: 6, loss: 11.426402525901795, eval loss: [NA]
Epoch: 7, loss: 11.374334692955017, eval loss: [NA]
Epoch: 8, loss: 11.345303559303284, eval loss: [NA]
Epoch: 9, loss: 11.327817401885987, eval loss: [NA]
Epoch: 10, loss: 11.32271101474762, eval loss: [NA]
Epoch: 11, loss: 11.320202589035034, eval loss: [NA]
Epoch: 12, loss: 11.316324191093445, eval loss: [NA]
Epoch: 13, loss: 11.315054783821106, eval loss: [NA]
Epoch: 14, loss: 11.314815721511842, eval loss: [NA]
Epoch: 15, loss: 11.315578417778015, eval loss: [NA]
Epoch: 16, loss: 11.313098869323731, eval loss: [NA]
Epoch: 17, loss: 11.313821449279786, eval loss: [NA]
Epoch: 18, loss: 11.315310444831848, eval loss: [NA]
Epoch: 19, loss: 11.3146302652359, eval loss: [NA]
Epoch: 20, loss: 11.313177757263183, eval loss: [NA]
Epoch: 21, loss: 11.31463707447052, eval loss: [NA]
Epoch: 22, loss: 11.315210585594178, eval loss: [NA]
Epoch: 23, loss: 11.316721081733704, eval loss: [NA]
Epoch: 24, loss: 11.315128560066222, eval loss: [NA]
Epoch: 25, loss: 11.314221410751342, eval loss: [NA]
Epoch: 26, loss: 11.314059805870055, eval loss: [NA]
Epoch: 27, loss: 11.312973999977112, eval loss: [NA]
Epoch: 28, loss: 11.318584322929382, eval loss: [NA]
Epoch: 29, loss: 11.316116590499878, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 10.120415949821473, eval loss: [NA]
Epoch: 1, loss: 10.114117379188537, eval loss: [NA]
Epoch: 2, loss: 10.110262522697449, eval loss: [NA]
Epoch: 3, loss: 10.107163610458374, eval loss: [NA]
Epoch: 4, loss: 10.109052896499634, eval loss: [NA]
Epoch: 5, loss: 10.113511757850647, eval loss: [NA]
Epoch: 6, loss: 10.111667923927307, eval loss: [NA]
Epoch: 7, loss: 10.113732924461365, eval loss: [NA]
Epoch: 8, loss: 10.11668981552124, eval loss: [NA]
Epoch: 9, loss: 10.1033247423172, eval loss: [NA]
Epoch: 10, loss: 10.10006268978119, eval loss: [NA]
Epoch: 11, loss: 10.097283058166504, eval loss: [NA]
Epoch: 12, loss: 10.0989138174057, eval loss: [NA]
Epoch: 13, loss: 10.107800517082214, eval loss: [NA]
Epoch: 14, loss: 10.09287651538849, eval loss: [NA]
Epoch: 15, loss: 10.09503189086914, eval loss: [NA]
Epoch: 16, loss: 10.100234026908874, eval loss: [NA]
Epoch: 17, loss: 10.095809378623962, eval loss: [NA]
Epoch: 18, loss: 10.09832582950592, eval loss: [NA]
Epoch: 19, loss: 10.100291810035706, eval loss: [NA]
Epoch: 20, loss: 10.090113983154296, eval loss: [NA]
Epoch: 21, loss: 10.0987327003479, eval loss: [NA]
Epoch: 22, loss: 10.086409912109374, eval loss: [NA]
Epoch: 23, loss: 10.100181674957275, eval loss: [NA]
Epoch: 24, loss: 10.075627546310425, eval loss: [NA]
Epoch: 25, loss: 10.082933177947998, eval loss: [NA]
Epoch: 26, loss: 10.077709045410156, eval loss: [NA]
Epoch: 27, loss: 10.086699905395507, eval loss: [NA]
Epoch: 28, loss: 10.083252687454223, eval loss: [NA]
Epoch: 29, loss: 10.070679173469543, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.316653265953065, eval loss: [NA]
Epoch: 1, loss: 11.31859631061554, eval loss: [NA]
Epoch: 2, loss: 11.316444482803345, eval loss: [NA]
Epoch: 3, loss: 11.313639206886291, eval loss: [NA]
Epoch: 4, loss: 11.312825045585633, eval loss: [NA]
Epoch: 5, loss: 11.313733620643616, eval loss: [NA]
Epoch: 6, loss: 11.31433909893036, eval loss: [NA]
Epoch: 7, loss: 11.31244553565979, eval loss: [NA]
Epoch: 8, loss: 11.312452840805054, eval loss: [NA]
Epoch: 9, loss: 11.313536882400513, eval loss: [NA]
Epoch: 10, loss: 11.312467474937439, eval loss: [NA]
Epoch: 11, loss: 11.314932932853699, eval loss: [NA]
Epoch: 12, loss: 11.310440030097961, eval loss: [NA]
Epoch: 13, loss: 11.317524547576904, eval loss: [NA]
Epoch: 14, loss: 11.31395483493805, eval loss: [NA]
Epoch: 15, loss: 11.31157663822174, eval loss: [NA]
Epoch: 16, loss: 11.312905917167663, eval loss: [NA]
Epoch: 17, loss: 11.31316692829132, eval loss: [NA]
Epoch: 18, loss: 11.317561240196229, eval loss: [NA]
Epoch: 19, loss: 11.312672419548035, eval loss: [NA]
Epoch: 20, loss: 11.312172069549561, eval loss: [NA]
Epoch: 21, loss: 11.313773665428162, eval loss: [NA]
Epoch: 22, loss: 11.312117710113526, eval loss: [NA]
Epoch: 23, loss: 11.318242416381835, eval loss: [NA]
Epoch: 24, loss: 11.31304262161255, eval loss: [NA]
Epoch: 25, loss: 11.312763748168946, eval loss: [NA]
Epoch: 26, loss: 11.318725175857544, eval loss: [NA]
Epoch: 27, loss: 11.317874360084534, eval loss: [NA]
Epoch: 28, loss: 11.315916447639465, eval loss: [NA]
Epoch: 29, loss: 11.313908648490905, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 10.062817525863647, eval loss: [NA]
Epoch: 1, loss: 10.04532353401184, eval loss: [NA]
Epoch: 2, loss: 10.036095967292786, eval loss: [NA]
Epoch: 3, loss: 10.03190960407257, eval loss: [NA]
Epoch: 4, loss: 10.02988763332367, eval loss: [NA]
Epoch: 5, loss: 10.028101196289063, eval loss: [NA]
Epoch: 6, loss: 10.025011911392212, eval loss: [NA]
Epoch: 7, loss: 10.021655988693237, eval loss: [NA]
Epoch: 8, loss: 10.013828430175781, eval loss: [NA]
Epoch: 9, loss: 10.01811179637909, eval loss: [NA]
Epoch: 10, loss: 10.012760338783265, eval loss: [NA]
Epoch: 11, loss: 10.012372980117798, eval loss: [NA]
Epoch: 12, loss: 10.010116539001466, eval loss: [NA]
Epoch: 13, loss: 10.018547525405884, eval loss: [NA]
Epoch: 14, loss: 10.011130084991455, eval loss: [NA]
Epoch: 15, loss: 10.00479700088501, eval loss: [NA]
Epoch: 16, loss: 9.995998125076294, eval loss: [NA]
Epoch: 17, loss: 10.000523929595948, eval loss: [NA]
Epoch: 18, loss: 9.994216604232788, eval loss: [NA]
Epoch: 19, loss: 10.004347143173218, eval loss: [NA]
Epoch: 20, loss: 9.989549341201782, eval loss: [NA]
Epoch: 21, loss: 9.985532636642455, eval loss: [NA]
Epoch: 22, loss: 9.993233575820923, eval loss: [NA]
Epoch: 23, loss: 9.997675895690918, eval loss: [NA]
Epoch: 24, loss: 9.989864206314087, eval loss: [NA]
Epoch: 25, loss: 9.988324656486512, eval loss: [NA]
Epoch: 26, loss: 9.98830189704895, eval loss: [NA]
Epoch: 27, loss: 9.98911657333374, eval loss: [NA]
Epoch: 28, loss: 9.97762354850769, eval loss: [NA]
Epoch: 29, loss: 9.97601697921753, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.036797947883606, eval loss: [NA]
Epoch: 1, loss: 11.032325348854066, eval loss: [NA]
Epoch: 2, loss: 11.033007822036744, eval loss: [NA]
Epoch: 3, loss: 11.039475898742676, eval loss: [NA]
Epoch: 4, loss: 11.039204845428467, eval loss: [NA]
Epoch: 5, loss: 11.03420838356018, eval loss: [NA]
Epoch: 6, loss: 11.032754688262939, eval loss: [NA]
Epoch: 7, loss: 11.032687406539917, eval loss: [NA]
Epoch: 8, loss: 11.036113195419311, eval loss: [NA]
Epoch: 9, loss: 11.033738532066344, eval loss: [NA]
Epoch: 10, loss: 11.035768613815307, eval loss: [NA]
Epoch: 11, loss: 11.03462239742279, eval loss: [NA]
Epoch: 12, loss: 11.0382634973526, eval loss: [NA]
Epoch: 13, loss: 11.036336770057678, eval loss: [NA]
Epoch: 14, loss: 11.039088459014893, eval loss: [NA]
Epoch: 15, loss: 11.034683690071105, eval loss: [NA]
Epoch: 16, loss: 11.036621041297913, eval loss: [NA]
Epoch: 17, loss: 11.036893463134765, eval loss: [NA]
Epoch: 18, loss: 11.037492814064025, eval loss: [NA]
Epoch: 19, loss: 11.038985457420349, eval loss: [NA]
Epoch: 20, loss: 11.035504488945007, eval loss: [NA]
Epoch: 21, loss: 11.033789672851562, eval loss: [NA]
Epoch: 22, loss: 11.03849398136139, eval loss: [NA]
Epoch: 23, loss: 11.036397314071655, eval loss: [NA]
Epoch: 24, loss: 11.043428058624267, eval loss: [NA]
Epoch: 25, loss: 11.035302305221558, eval loss: [NA]
Epoch: 26, loss: 11.032777943611144, eval loss: [NA]
Epoch: 27, loss: 11.037504625320434, eval loss: [NA]
Epoch: 28, loss: 11.038786630630494, eval loss: [NA]
Epoch: 29, loss: 11.03939610004425, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 10.091685442924499, eval loss: [NA]
Epoch: 1, loss: 10.06980251789093, eval loss: [NA]
Epoch: 2, loss: 10.058848204612731, eval loss: [NA]
Epoch: 3, loss: 10.050368132591247, eval loss: [NA]
Epoch: 4, loss: 10.051340169906616, eval loss: [NA]
Epoch: 5, loss: 10.051839938163758, eval loss: [NA]
Epoch: 6, loss: 10.044437403678893, eval loss: [NA]
Epoch: 7, loss: 10.040339012145996, eval loss: [NA]
Epoch: 8, loss: 10.045647740364075, eval loss: [NA]
Epoch: 9, loss: 10.035958828926086, eval loss: [NA]
Epoch: 10, loss: 10.038929457664489, eval loss: [NA]
Epoch: 11, loss: 10.041622653007508, eval loss: [NA]
Epoch: 12, loss: 10.041069822311401, eval loss: [NA]
Epoch: 13, loss: 10.034701557159424, eval loss: [NA]
Epoch: 14, loss: 10.038233780860901, eval loss: [NA]
Epoch: 15, loss: 10.032923669815064, eval loss: [NA]
Epoch: 16, loss: 10.029547033309937, eval loss: [NA]
Epoch: 17, loss: 10.031268963813782, eval loss: [NA]
Epoch: 18, loss: 10.027686729431153, eval loss: [NA]
Epoch: 19, loss: 10.018972139358521, eval loss: [NA]
Epoch: 20, loss: 10.025849084854126, eval loss: [NA]
Epoch: 21, loss: 10.016969594955444, eval loss: [NA]
Epoch: 22, loss: 10.027126369476319, eval loss: [NA]
Epoch: 23, loss: 10.019761691093445, eval loss: [NA]
Epoch: 24, loss: 10.018361158370972, eval loss: [NA]
Epoch: 25, loss: 10.014866724014283, eval loss: [NA]
Epoch: 26, loss: 10.013729782104493, eval loss: [NA]
Epoch: 27, loss: 10.01854859828949, eval loss: [NA]
Epoch: 28, loss: 10.011985659599304, eval loss: [NA]
Epoch: 29, loss: 10.002456316947937, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 11.0735422372818, eval loss: [NA]
Epoch: 1, loss: 11.078392634391784, eval loss: [NA]
Epoch: 2, loss: 11.076855692863464, eval loss: [NA]
Epoch: 3, loss: 11.07258614063263, eval loss: [NA]
Epoch: 4, loss: 11.074872779846192, eval loss: [NA]
Epoch: 5, loss: 11.077906012535095, eval loss: [NA]
Epoch: 6, loss: 11.075246238708496, eval loss: [NA]
Epoch: 7, loss: 11.068298616409301, eval loss: [NA]
Epoch: 8, loss: 11.072573857307434, eval loss: [NA]
Epoch: 9, loss: 11.07178668498993, eval loss: [NA]
Epoch: 10, loss: 11.070818314552307, eval loss: [NA]
Epoch: 11, loss: 11.076146864891053, eval loss: [NA]
Epoch: 12, loss: 11.083869605064391, eval loss: [NA]
Epoch: 13, loss: 11.073467478752136, eval loss: [NA]
Epoch: 14, loss: 11.075976490974426, eval loss: [NA]
Epoch: 15, loss: 11.070795731544495, eval loss: [NA]
Epoch: 16, loss: 11.071393237113952, eval loss: [NA]
Epoch: 17, loss: 11.079451427459716, eval loss: [NA]
Epoch: 18, loss: 11.071232919692994, eval loss: [NA]
Epoch: 19, loss: 11.075196967124938, eval loss: [NA]
Epoch: 20, loss: 11.070731682777405, eval loss: [NA]
Epoch: 21, loss: 11.072576074600219, eval loss: [NA]
Epoch: 22, loss: 11.071283502578735, eval loss: [NA]
Epoch: 23, loss: 11.0754363155365, eval loss: [NA]
Epoch: 24, loss: 11.075156030654908, eval loss: [NA]
Epoch: 25, loss: 11.07665427684784, eval loss: [NA]
Epoch: 26, loss: 11.071865305900573, eval loss: [NA]
Epoch: 27, loss: 11.077502765655517, eval loss: [NA]
Epoch: 28, loss: 11.06952021598816, eval loss: [NA]
Epoch: 29, loss: 11.06744393825531, eval loss: [NA]

Runtime:574.65
[755821.0036, 0.0197, 0.006, 0.0059]
[47830295117824.0, 1.3212, 1.3509, 1.315]
[7316262879232.0, 1.3911, 1.3984, 1.4187]
KL div untrained: 15773200.5221
KL div trained: 0.0179
