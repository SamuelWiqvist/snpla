/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian/2d w 5 obs/lunarc
/home/samwiq/spa/seq-posterior-approx-w-nf-dev/mv_gaussian
tensor(2.1688, grad_fn=<MeanBackward0>)
tensor(1.5733, grad_fn=<MeanBackward0>)
tensor([-0.1680,  0.3307,  0.0192, -0.0703, -0.1006,  0.2060, -0.0345,  0.1356,
        -0.0340,  0.1783], grad_fn=<MeanBackward1>)
tensor([0.9249, 0.9368, 0.9876, 1.0175, 0.8775, 0.9649, 0.9486, 0.9269, 1.0288,
        1.0838], grad_fn=<StdBackward1>)
tensor([-0.5011,  1.8690,  0.7865,  2.4942,  1.6625,  3.4749, -0.7470,  1.7802,
        -0.1656,  1.3073])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 12.122295654296876, eval loss: [NA]
Epoch: 1, loss: 7.106868576049805, eval loss: [NA]
Epoch: 2, loss: 7.0014042449951175, eval loss: [NA]
Epoch: 3, loss: 6.9670001953125, eval loss: [NA]
Epoch: 4, loss: 6.894577206420898, eval loss: [NA]
Epoch: 5, loss: 6.699035971069336, eval loss: [NA]
Epoch: 6, loss: 6.352935479736328, eval loss: [NA]
Epoch: 7, loss: 6.126541177368164, eval loss: [NA]
Epoch: 8, loss: 5.929164012145996, eval loss: [NA]
Epoch: 9, loss: 5.6761598358154295, eval loss: [NA]
Epoch: 10, loss: 5.384083195495606, eval loss: [NA]
Epoch: 11, loss: 5.109355027770996, eval loss: [NA]
Epoch: 12, loss: 4.579288581848145, eval loss: [NA]
Epoch: 13, loss: 4.175587861633301, eval loss: [NA]
Epoch: 14, loss: 3.986164875793457, eval loss: [NA]
Epoch: 15, loss: 3.9122348175048827, eval loss: [NA]
Epoch: 16, loss: 3.8840613540649414, eval loss: [NA]
Epoch: 17, loss: 3.8549282638549807, eval loss: [NA]
Epoch: 18, loss: 3.7654927810668943, eval loss: [NA]
Epoch: 19, loss: 3.751957516479492, eval loss: [NA]
Epoch: 20, loss: 3.74592619934082, eval loss: [NA]
Epoch: 21, loss: 3.725137649536133, eval loss: [NA]
Epoch: 22, loss: 3.7237812805175783, eval loss: [NA]
Epoch: 23, loss: 3.684294873046875, eval loss: [NA]
Epoch: 24, loss: 3.6501238906860354, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 1.8909535557031631, eval loss: [NA]
Epoch: 1, loss: 0.8598492875695228, eval loss: [NA]
Epoch: 2, loss: 0.6576865997910499, eval loss: [NA]
Epoch: 3, loss: 0.6086617266386747, eval loss: [NA]
Epoch: 4, loss: 0.536911066249013, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.932259705066681, eval loss: [NA]
Epoch: 1, loss: 5.928230090141296, eval loss: [NA]
Epoch: 2, loss: 5.902019510269165, eval loss: [NA]
Epoch: 3, loss: 5.900725431442261, eval loss: [NA]
Epoch: 4, loss: 5.903462126255035, eval loss: [NA]
Epoch: 5, loss: 5.9115780115127565, eval loss: [NA]
Epoch: 6, loss: 5.927213451862335, eval loss: [NA]
Epoch: 7, loss: 5.911477420330048, eval loss: [NA]
Epoch: 8, loss: 5.902435004711151, eval loss: [NA]
Epoch: 9, loss: 5.891980588436127, eval loss: [NA]
Epoch: 10, loss: 5.932406756877899, eval loss: [NA]
Epoch: 11, loss: 5.917566783428192, eval loss: [NA]
Epoch: 12, loss: 5.905469613075256, eval loss: [NA]
Epoch: 13, loss: 5.933700804710388, eval loss: [NA]
Epoch: 14, loss: 5.9023109364509585, eval loss: [NA]
Epoch: 15, loss: 5.9301615858078005, eval loss: [NA]
Epoch: 16, loss: 5.910286500453949, eval loss: [NA]
Epoch: 17, loss: 5.898282496929169, eval loss: [NA]
Epoch: 18, loss: 5.911157422065735, eval loss: [NA]
Epoch: 19, loss: 5.919785902500153, eval loss: [NA]
Epoch: 20, loss: 5.914831187725067, eval loss: [NA]
Epoch: 21, loss: 5.8990650510787965, eval loss: [NA]
Epoch: 22, loss: 5.915075962543487, eval loss: [NA]
Epoch: 23, loss: 5.9197003817558285, eval loss: [NA]
Epoch: 24, loss: 5.891534354686737, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 3.665398222351074, eval loss: [NA]
Epoch: 1, loss: 3.654145361328125, eval loss: [NA]
Epoch: 2, loss: 3.6177749069213867, eval loss: [NA]
Epoch: 3, loss: 3.629697885131836, eval loss: [NA]
Epoch: 4, loss: 3.5974010818481443, eval loss: [NA]
Epoch: 5, loss: 3.6078295623779297, eval loss: [NA]
Epoch: 6, loss: 3.5727513259887695, eval loss: [NA]
Epoch: 7, loss: 3.6054960891723633, eval loss: [NA]
Epoch: 8, loss: 3.581261375427246, eval loss: [NA]
Epoch: 9, loss: 3.631367958068848, eval loss: [NA]
Epoch: 10, loss: 3.602487986755371, eval loss: [NA]
Epoch: 11, loss: 3.60700632019043, eval loss: [NA]
Epoch: 12, loss: 3.5823537322998047, eval loss: [NA]
Epoch: 13, loss: 3.5704226486206054, eval loss: [NA]
Epoch: 14, loss: 3.5898157440185545, eval loss: [NA]
Epoch: 15, loss: 3.6251777938842773, eval loss: [NA]
Epoch: 16, loss: 3.59571337890625, eval loss: [NA]
Epoch: 17, loss: 3.576299203491211, eval loss: [NA]
Epoch: 18, loss: 3.589085665893555, eval loss: [NA]
Epoch: 19, loss: 3.577016191101074, eval loss: [NA]
Epoch: 20, loss: 3.5770049087524414, eval loss: [NA]
Epoch: 21, loss: 3.542198735046387, eval loss: [NA]
Epoch: 22, loss: 3.5891635162353515, eval loss: [NA]
Epoch: 23, loss: 3.558216470336914, eval loss: [NA]
Epoch: 24, loss: 3.5634145446777343, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.556097431182861, eval loss: [NA]
Epoch: 1, loss: 5.582717294692993, eval loss: [NA]
Epoch: 2, loss: 5.569427483081817, eval loss: [NA]
Epoch: 3, loss: 5.579817600250244, eval loss: [NA]
Epoch: 4, loss: 5.563692629337311, eval loss: [NA]
Epoch: 5, loss: 5.562414610385895, eval loss: [NA]
Epoch: 6, loss: 5.560350267887116, eval loss: [NA]
Epoch: 7, loss: 5.568089106082916, eval loss: [NA]
Epoch: 8, loss: 5.5784774684906, eval loss: [NA]
Epoch: 9, loss: 5.567118647098542, eval loss: [NA]
Epoch: 10, loss: 5.581769275665283, eval loss: [NA]
Epoch: 11, loss: 5.585667133331299, eval loss: [NA]
Epoch: 12, loss: 5.546340954303742, eval loss: [NA]
Epoch: 13, loss: 5.568853652477264, eval loss: [NA]
Epoch: 14, loss: 5.5511142349243165, eval loss: [NA]
Epoch: 15, loss: 5.598718464374542, eval loss: [NA]
Epoch: 16, loss: 5.619266231060028, eval loss: [NA]
Epoch: 17, loss: 5.600770342350006, eval loss: [NA]
Epoch: 18, loss: 5.568862669467926, eval loss: [NA]
Epoch: 19, loss: 5.562776699066162, eval loss: [NA]
Epoch: 20, loss: 5.557210114002228, eval loss: [NA]
Epoch: 21, loss: 5.576950705051422, eval loss: [NA]
Epoch: 22, loss: 5.559828898906708, eval loss: [NA]
Epoch: 23, loss: 5.5658373498916625, eval loss: [NA]
Epoch: 24, loss: 5.571910939216614, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5572427917480467, eval loss: [NA]
Epoch: 1, loss: 3.5647861022949217, eval loss: [NA]
Epoch: 2, loss: 3.565825843811035, eval loss: [NA]
Epoch: 3, loss: 3.5530119369506834, eval loss: [NA]
Epoch: 4, loss: 3.519392039489746, eval loss: [NA]
Epoch: 5, loss: 3.5278689102172853, eval loss: [NA]
Epoch: 6, loss: 3.5403980056762694, eval loss: [NA]
Epoch: 7, loss: 3.5350918060302736, eval loss: [NA]
Epoch: 8, loss: 3.568839764404297, eval loss: [NA]
Epoch: 9, loss: 3.5499220809936523, eval loss: [NA]
Epoch: 10, loss: 3.4988779861450197, eval loss: [NA]
Epoch: 11, loss: 3.5447768646240236, eval loss: [NA]
Epoch: 12, loss: 3.5449485595703125, eval loss: [NA]
Epoch: 13, loss: 3.53901174621582, eval loss: [NA]
Epoch: 14, loss: 3.5580152450561524, eval loss: [NA]
Epoch: 15, loss: 3.565483229064941, eval loss: [NA]
Epoch: 16, loss: 3.541730714416504, eval loss: [NA]
Epoch: 17, loss: 3.503385388183594, eval loss: [NA]
Epoch: 18, loss: 3.537898742675781, eval loss: [NA]
Epoch: 19, loss: 3.500169723510742, eval loss: [NA]
Epoch: 20, loss: 3.5386342315673827, eval loss: [NA]
Epoch: 21, loss: 3.530278926086426, eval loss: [NA]
Epoch: 22, loss: 3.538526823425293, eval loss: [NA]
Epoch: 23, loss: 3.559627145385742, eval loss: [NA]
Epoch: 24, loss: 3.5452644439697267, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.660119071006775, eval loss: [NA]
Epoch: 1, loss: 5.66167361497879, eval loss: [NA]
Epoch: 2, loss: 5.636355471611023, eval loss: [NA]
Epoch: 3, loss: 5.637998337745667, eval loss: [NA]
Epoch: 4, loss: 5.661809782981873, eval loss: [NA]
Epoch: 5, loss: 5.664431643486023, eval loss: [NA]
Epoch: 6, loss: 5.6695426654815675, eval loss: [NA]
Epoch: 7, loss: 5.659041681289673, eval loss: [NA]
Epoch: 8, loss: 5.641733090877533, eval loss: [NA]
Epoch: 9, loss: 5.644563817977906, eval loss: [NA]
Epoch: 10, loss: 5.642966959476471, eval loss: [NA]
Epoch: 11, loss: 5.658416826725006, eval loss: [NA]
Epoch: 12, loss: 5.65224395275116, eval loss: [NA]
Epoch: 13, loss: 5.669512422084808, eval loss: [NA]
Epoch: 14, loss: 5.640142843723297, eval loss: [NA]
Epoch: 15, loss: 5.640571713447571, eval loss: [NA]
Epoch: 16, loss: 5.662446274757385, eval loss: [NA]
Epoch: 17, loss: 5.656048150062561, eval loss: [NA]
Epoch: 18, loss: 5.663190755844116, eval loss: [NA]
Epoch: 19, loss: 5.665612106323242, eval loss: [NA]
Epoch: 20, loss: 5.655065023899079, eval loss: [NA]
Epoch: 21, loss: 5.649943633079529, eval loss: [NA]
Epoch: 22, loss: 5.653479838371277, eval loss: [NA]
Epoch: 23, loss: 5.652107806205749, eval loss: [NA]
Epoch: 24, loss: 5.650017027854919, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.4740811752319334, eval loss: [NA]
Epoch: 1, loss: 3.4599649963378907, eval loss: [NA]
Epoch: 2, loss: 3.480940592956543, eval loss: [NA]
Epoch: 3, loss: 3.4749595626831056, eval loss: [NA]
Epoch: 4, loss: 3.436017286682129, eval loss: [NA]
Epoch: 5, loss: 3.4601854751586916, eval loss: [NA]
Epoch: 6, loss: 3.4782364181518552, eval loss: [NA]
Epoch: 7, loss: 3.451635954284668, eval loss: [NA]
Epoch: 8, loss: 3.448693455505371, eval loss: [NA]
Epoch: 9, loss: 3.437218812561035, eval loss: [NA]
Epoch: 10, loss: 3.4542432174682616, eval loss: [NA]
Epoch: 11, loss: 3.4713088943481445, eval loss: [NA]
Epoch: 12, loss: 3.4789382934570314, eval loss: [NA]
Epoch: 13, loss: 3.4707314697265623, eval loss: [NA]
Epoch: 14, loss: 3.4632863525390625, eval loss: [NA]
Epoch: 15, loss: 3.449992756652832, eval loss: [NA]
Epoch: 16, loss: 3.434194091796875, eval loss: [NA]
Epoch: 17, loss: 3.4416405563354493, eval loss: [NA]
Epoch: 18, loss: 3.454450526428223, eval loss: [NA]
Epoch: 19, loss: 3.4557244842529298, eval loss: [NA]
Epoch: 20, loss: 3.4490427169799807, eval loss: [NA]
Epoch: 21, loss: 3.4468408950805665, eval loss: [NA]
Epoch: 22, loss: 3.470324980163574, eval loss: [NA]
Epoch: 23, loss: 3.473133038330078, eval loss: [NA]
Epoch: 24, loss: 3.459362203979492, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 5.66266610622406, eval loss: [NA]
Epoch: 1, loss: 5.628931026458741, eval loss: [NA]
Epoch: 2, loss: 5.650860450267792, eval loss: [NA]
Epoch: 3, loss: 5.648733613491058, eval loss: [NA]
Epoch: 4, loss: 5.660849740505219, eval loss: [NA]
Epoch: 5, loss: 5.673495683670044, eval loss: [NA]
Epoch: 6, loss: 5.646321308612824, eval loss: [NA]
Epoch: 7, loss: 5.6587942242622375, eval loss: [NA]
Epoch: 8, loss: 5.6370475339889525, eval loss: [NA]
Epoch: 9, loss: 5.634883680343628, eval loss: [NA]
Epoch: 10, loss: 5.651444251537323, eval loss: [NA]
Epoch: 11, loss: 5.664797761440277, eval loss: [NA]
Epoch: 12, loss: 5.656962125301361, eval loss: [NA]
Epoch: 13, loss: 5.676875541210174, eval loss: [NA]
Epoch: 14, loss: 5.664015810489655, eval loss: [NA]
Epoch: 15, loss: 5.665483088493347, eval loss: [NA]
Epoch: 16, loss: 5.634883196353912, eval loss: [NA]
Epoch: 17, loss: 5.61845577955246, eval loss: [NA]
Epoch: 18, loss: 5.64350111246109, eval loss: [NA]
Epoch: 19, loss: 5.6349420070648195, eval loss: [NA]
Epoch: 20, loss: 5.6483814144134525, eval loss: [NA]
Epoch: 21, loss: 5.659590964317322, eval loss: [NA]
Epoch: 22, loss: 5.633177134990692, eval loss: [NA]
Epoch: 23, loss: 5.6715841031074525, eval loss: [NA]
Epoch: 24, loss: 5.639669349193573, eval loss: [NA]

Runtime:455.51
[2710.9055, 0.1889, 0.1202, 0.265]
[1.5733, 0.6235, 0.5888, 0.5867]
[2.1688, 0.7543, 0.7441, 0.7492]
tensor(0.7455, grad_fn=<MeanBackward0>)
tensor(0.6035, grad_fn=<MeanBackward0>)
tensor([-0.3813,  1.7321,  0.5325,  2.7476,  1.4322,  3.6828, -0.3631,  1.8293,
        -0.2938,  1.8084], grad_fn=<MeanBackward1>)
tensor([0.3184, 0.3357, 0.3080, 0.3402, 0.3104, 0.3346, 1.3051, 1.2888, 1.1613,
        1.2914], grad_fn=<StdBackward1>)
tensor([-0.5011,  1.8690,  0.7865,  2.4942,  1.6625,  3.4749, -0.7470,  1.7802,
        -0.1656,  1.3073])
KL div untrained: 12508.5209
KL div trained: 0.1246
