Input args:
Dim: 2
seed: 15
seed_data: 10
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev/mv_gaussian/low_dim_w_five_obs/lunarc
/home/samwiq/snpla/seq-posterior-approx-w-nf-dev
tensor(2.1881, grad_fn=<MeanBackward0>)
tensor(1.6957, grad_fn=<MeanBackward0>)
tensor([-0.1219,  0.0679,  0.0659,  0.0811,  0.0062,  0.1933, -0.1069, -0.0446,
        -0.1564,  0.1311], grad_fn=<MeanBackward1>)
tensor([1.0338, 0.9286, 0.9379, 0.9452, 0.9247, 1.0570, 1.0638, 1.0066, 0.9834,
        0.9596], grad_fn=<StdBackward1>)
tensor([-2.4087,  0.9012, -2.2200,  1.1820, -0.3202,  2.8520, -3.0795, -0.1006,
        -0.3906,  2.1908])
start full training
Iteration: 1
start update likelihood model
Epoch: 0, loss: 11.612361303710937, eval loss: [NA]
Epoch: 1, loss: 7.09415739440918, eval loss: [NA]
Epoch: 2, loss: 6.968926303100586, eval loss: [NA]
Epoch: 3, loss: 6.895586071777344, eval loss: [NA]
Epoch: 4, loss: 6.879916229248047, eval loss: [NA]
Epoch: 5, loss: 6.881780276489258, eval loss: [NA]
Epoch: 6, loss: 6.811370071411133, eval loss: [NA]
Epoch: 7, loss: 6.693567514038086, eval loss: [NA]
Epoch: 8, loss: 6.551251171875, eval loss: [NA]
Epoch: 9, loss: 6.2526982955932615, eval loss: [NA]
Epoch: 10, loss: 5.9821795486450196, eval loss: [NA]
Epoch: 11, loss: 5.8556677490234375, eval loss: [NA]
Epoch: 12, loss: 5.862561154174805, eval loss: [NA]
Epoch: 13, loss: 5.783483180236816, eval loss: [NA]
Epoch: 14, loss: 5.752118113708496, eval loss: [NA]
Epoch: 15, loss: 5.364387506103515, eval loss: [NA]
Epoch: 16, loss: 4.870600598144531, eval loss: [NA]
Epoch: 17, loss: 4.761649082946778, eval loss: [NA]
Epoch: 18, loss: 4.674097477722168, eval loss: [NA]
Epoch: 19, loss: 4.635420468139649, eval loss: [NA]
Epoch: 20, loss: 4.633406695556641, eval loss: [NA]
Epoch: 21, loss: 4.636342402648926, eval loss: [NA]
Epoch: 22, loss: 4.60466275177002, eval loss: [NA]
Epoch: 23, loss: 4.575085539245605, eval loss: [NA]
Epoch: 24, loss: 4.564472013854981, eval loss: [NA]
start update posterior model from prior pred - hot start
Epoch: 0, loss: 2.089569785296917, eval loss: [NA]
Epoch: 1, loss: 0.8844330184161663, eval loss: [NA]
Epoch: 2, loss: 0.6901763078570365, eval loss: [NA]
Epoch: 3, loss: 0.606617195084691, eval loss: [NA]
Epoch: 4, loss: 0.5457015614956617, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.66401483297348, eval loss: [NA]
Epoch: 1, loss: 6.624881453514099, eval loss: [NA]
Epoch: 2, loss: 6.630741546154022, eval loss: [NA]
Epoch: 3, loss: 6.629568176269531, eval loss: [NA]
Epoch: 4, loss: 6.622961614131928, eval loss: [NA]
Epoch: 5, loss: 6.638047170639038, eval loss: [NA]
Epoch: 6, loss: 6.633441758155823, eval loss: [NA]
Epoch: 7, loss: 6.624992899894714, eval loss: [NA]
Epoch: 8, loss: 6.631994359493255, eval loss: [NA]
Epoch: 9, loss: 6.633166034221649, eval loss: [NA]
Epoch: 10, loss: 6.595478150844574, eval loss: [NA]
Epoch: 11, loss: 6.660282375812531, eval loss: [NA]
Epoch: 12, loss: 6.617942721843719, eval loss: [NA]
Epoch: 13, loss: 6.612186741828919, eval loss: [NA]
Epoch: 14, loss: 6.631071293354035, eval loss: [NA]
Epoch: 15, loss: 6.637150824069977, eval loss: [NA]
Epoch: 16, loss: 6.620000381469726, eval loss: [NA]
Epoch: 17, loss: 6.625922162532806, eval loss: [NA]
Epoch: 18, loss: 6.636541502475739, eval loss: [NA]
Epoch: 19, loss: 6.607441401481628, eval loss: [NA]
Epoch: 20, loss: 6.604861912727356, eval loss: [NA]
Epoch: 21, loss: 6.618807048797607, eval loss: [NA]
Epoch: 22, loss: 6.616882221698761, eval loss: [NA]
Epoch: 23, loss: 6.6388049530982975, eval loss: [NA]
Epoch: 24, loss: 6.608501081466675, eval loss: [NA]
Iteration: 2
start update likelihood model
Epoch: 0, loss: 4.562786534118652, eval loss: [NA]
Epoch: 1, loss: 4.533149162292481, eval loss: [NA]
Epoch: 2, loss: 4.552574430847168, eval loss: [NA]
Epoch: 3, loss: 4.559012545776367, eval loss: [NA]
Epoch: 4, loss: 4.532797085571289, eval loss: [NA]
Epoch: 5, loss: 4.512154360961914, eval loss: [NA]
Epoch: 6, loss: 4.542385678100586, eval loss: [NA]
Epoch: 7, loss: 4.564756773376465, eval loss: [NA]
Epoch: 8, loss: 4.542496366882324, eval loss: [NA]
Epoch: 9, loss: 4.510910804748535, eval loss: [NA]
Epoch: 10, loss: 4.532696040344239, eval loss: [NA]
Epoch: 11, loss: 4.52340154876709, eval loss: [NA]
Epoch: 12, loss: 4.516172399902343, eval loss: [NA]
Epoch: 13, loss: 4.4825006820678714, eval loss: [NA]
Epoch: 14, loss: 4.202722314453125, eval loss: [NA]
Epoch: 15, loss: 3.9670211364746093, eval loss: [NA]
Epoch: 16, loss: 3.835349293518066, eval loss: [NA]
Epoch: 17, loss: 3.708388719177246, eval loss: [NA]
Epoch: 18, loss: 3.6370182647705076, eval loss: [NA]
Epoch: 19, loss: 3.600758804321289, eval loss: [NA]
Epoch: 20, loss: 3.5809618728637695, eval loss: [NA]
Epoch: 21, loss: 3.6074685928344725, eval loss: [NA]
Epoch: 22, loss: 3.5870777282714843, eval loss: [NA]
Epoch: 23, loss: 3.570833628845215, eval loss: [NA]
Epoch: 24, loss: 3.556497636413574, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 7.07062058210373, eval loss: [NA]
Epoch: 1, loss: 7.054001729488373, eval loss: [NA]
Epoch: 2, loss: 7.0713458824157716, eval loss: [NA]
Epoch: 3, loss: 7.061218552589416, eval loss: [NA]
Epoch: 4, loss: 7.074025974273682, eval loss: [NA]
Epoch: 5, loss: 7.036043837070465, eval loss: [NA]
Epoch: 6, loss: 7.055116176605225, eval loss: [NA]
Epoch: 7, loss: 7.044965326786041, eval loss: [NA]
Epoch: 8, loss: 7.042736406326294, eval loss: [NA]
Epoch: 9, loss: 7.035432388782501, eval loss: [NA]
Epoch: 10, loss: 7.029007117748261, eval loss: [NA]
Epoch: 11, loss: 7.039177951812744, eval loss: [NA]
Epoch: 12, loss: 7.064423043727874, eval loss: [NA]
Epoch: 13, loss: 7.037767798900604, eval loss: [NA]
Epoch: 14, loss: 7.060485248565674, eval loss: [NA]
Epoch: 15, loss: 7.039858238697052, eval loss: [NA]
Epoch: 16, loss: 7.034085083007812, eval loss: [NA]
Epoch: 17, loss: 7.063924148082733, eval loss: [NA]
Epoch: 18, loss: 7.049866578578949, eval loss: [NA]
Epoch: 19, loss: 7.067787156105042, eval loss: [NA]
Epoch: 20, loss: 7.008432791233063, eval loss: [NA]
Epoch: 21, loss: 7.048341364860534, eval loss: [NA]
Epoch: 22, loss: 7.047605619430542, eval loss: [NA]
Epoch: 23, loss: 7.048526532649994, eval loss: [NA]
Epoch: 24, loss: 7.076005711555481, eval loss: [NA]
Iteration: 3
start update likelihood model
Epoch: 0, loss: 3.5131229278564455, eval loss: [NA]
Epoch: 1, loss: 3.4817752365112304, eval loss: [NA]
Epoch: 2, loss: 3.4988345870971678, eval loss: [NA]
Epoch: 3, loss: 3.48494637298584, eval loss: [NA]
Epoch: 4, loss: 3.4590993438720705, eval loss: [NA]
Epoch: 5, loss: 3.4710563552856444, eval loss: [NA]
Epoch: 6, loss: 3.4332516235351562, eval loss: [NA]
Epoch: 7, loss: 3.4732302642822264, eval loss: [NA]
Epoch: 8, loss: 3.4934354400634766, eval loss: [NA]
Epoch: 9, loss: 3.4584469604492187, eval loss: [NA]
Epoch: 10, loss: 3.452586666870117, eval loss: [NA]
Epoch: 11, loss: 3.4504553054809572, eval loss: [NA]
Epoch: 12, loss: 3.453361798095703, eval loss: [NA]
Epoch: 13, loss: 3.453708494567871, eval loss: [NA]
Epoch: 14, loss: 3.4692822769165037, eval loss: [NA]
Epoch: 15, loss: 3.45297958984375, eval loss: [NA]
Epoch: 16, loss: 3.4631415878295897, eval loss: [NA]
Epoch: 17, loss: 3.4237150817871096, eval loss: [NA]
Epoch: 18, loss: 3.441829995727539, eval loss: [NA]
Epoch: 19, loss: 3.442423455810547, eval loss: [NA]
Epoch: 20, loss: 3.4302849716186525, eval loss: [NA]
Epoch: 21, loss: 3.445964668273926, eval loss: [NA]
Epoch: 22, loss: 3.4345939697265626, eval loss: [NA]
Epoch: 23, loss: 3.401544650268555, eval loss: [NA]
Epoch: 24, loss: 3.4165574111938475, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.834615070819854, eval loss: [NA]
Epoch: 1, loss: 6.878811972141266, eval loss: [NA]
Epoch: 2, loss: 6.827016448974609, eval loss: [NA]
Epoch: 3, loss: 6.824493584632873, eval loss: [NA]
Epoch: 4, loss: 6.805016791820526, eval loss: [NA]
Epoch: 5, loss: 6.834175171852112, eval loss: [NA]
Epoch: 6, loss: 6.817039670944214, eval loss: [NA]
Epoch: 7, loss: 6.789781751632691, eval loss: [NA]
Epoch: 8, loss: 6.813145787715912, eval loss: [NA]
Epoch: 9, loss: 6.833164350986481, eval loss: [NA]
Epoch: 10, loss: 6.826681518554688, eval loss: [NA]
Epoch: 11, loss: 6.834574222564697, eval loss: [NA]
Epoch: 12, loss: 6.828902275562286, eval loss: [NA]
Epoch: 13, loss: 6.8256935787200925, eval loss: [NA]
Epoch: 14, loss: 6.814340004920959, eval loss: [NA]
Epoch: 15, loss: 6.81665468454361, eval loss: [NA]
Epoch: 16, loss: 6.818654861450195, eval loss: [NA]
Epoch: 17, loss: 6.822389769554138, eval loss: [NA]
Epoch: 18, loss: 6.821378879547119, eval loss: [NA]
Epoch: 19, loss: 6.803755435943604, eval loss: [NA]
Epoch: 20, loss: 6.833826053142547, eval loss: [NA]
Epoch: 21, loss: 6.820616490840912, eval loss: [NA]
Epoch: 22, loss: 6.84172824382782, eval loss: [NA]
Epoch: 23, loss: 6.82855813741684, eval loss: [NA]
Epoch: 24, loss: 6.825527112483979, eval loss: [NA]
Iteration: 4
start update likelihood model
Epoch: 0, loss: 3.556979949951172, eval loss: [NA]
Epoch: 1, loss: 3.5582309188842776, eval loss: [NA]
Epoch: 2, loss: 3.5092454132080078, eval loss: [NA]
Epoch: 3, loss: 3.579097041320801, eval loss: [NA]
Epoch: 4, loss: 3.5503115798950193, eval loss: [NA]
Epoch: 5, loss: 3.536493521118164, eval loss: [NA]
Epoch: 6, loss: 3.561277803039551, eval loss: [NA]
Epoch: 7, loss: 3.517151715087891, eval loss: [NA]
Epoch: 8, loss: 3.560276968383789, eval loss: [NA]
Epoch: 9, loss: 3.5650323760986327, eval loss: [NA]
Epoch: 10, loss: 3.524385614013672, eval loss: [NA]
Epoch: 11, loss: 3.5587089080810546, eval loss: [NA]
Epoch: 12, loss: 3.5744798904418946, eval loss: [NA]
Epoch: 13, loss: 3.517215281677246, eval loss: [NA]
Epoch: 14, loss: 3.5478223770141604, eval loss: [NA]
Epoch: 15, loss: 3.52513371887207, eval loss: [NA]
Epoch: 16, loss: 3.511511347961426, eval loss: [NA]
Epoch: 17, loss: 3.5001309768676756, eval loss: [NA]
Epoch: 18, loss: 3.53431590423584, eval loss: [NA]
Epoch: 19, loss: 3.543089991760254, eval loss: [NA]
Epoch: 20, loss: 3.523516632080078, eval loss: [NA]
Epoch: 21, loss: 3.539254066467285, eval loss: [NA]
Epoch: 22, loss: 3.544781433105469, eval loss: [NA]
Epoch: 23, loss: 3.526647668457031, eval loss: [NA]
Epoch: 24, loss: 3.5200840728759766, eval loss: [NA]
start update posterior model
Epoch: 0, loss: 6.971115806102753, eval loss: [NA]
Epoch: 1, loss: 6.966056652069092, eval loss: [NA]
Epoch: 2, loss: 6.937694129943847, eval loss: [NA]
Epoch: 3, loss: 6.957034807205201, eval loss: [NA]
Epoch: 4, loss: 6.970496423244477, eval loss: [NA]
Epoch: 5, loss: 6.961290311813355, eval loss: [NA]
Epoch: 6, loss: 6.9561475157737735, eval loss: [NA]
Epoch: 7, loss: 6.972364294528961, eval loss: [NA]
Epoch: 8, loss: 6.973416786193848, eval loss: [NA]
Epoch: 9, loss: 6.961366076469421, eval loss: [NA]
Epoch: 10, loss: 6.958707978725434, eval loss: [NA]
Epoch: 11, loss: 6.937127821445465, eval loss: [NA]
Epoch: 12, loss: 6.961404461860656, eval loss: [NA]
Epoch: 13, loss: 6.968044197559356, eval loss: [NA]
Epoch: 14, loss: 6.934295978546142, eval loss: [NA]
Epoch: 15, loss: 6.963240106105804, eval loss: [NA]
Epoch: 16, loss: 6.949052066802978, eval loss: [NA]
Epoch: 17, loss: 6.959934709072113, eval loss: [NA]
Epoch: 18, loss: 6.958190593719483, eval loss: [NA]
Epoch: 19, loss: 6.952607834339142, eval loss: [NA]
Epoch: 20, loss: 6.942709133625031, eval loss: [NA]
Epoch: 21, loss: 6.985440728664398, eval loss: [NA]
Epoch: 22, loss: 6.949072906970978, eval loss: [NA]
Epoch: 23, loss: 6.994472901821137, eval loss: [NA]
Epoch: 24, loss: 6.974446902275085, eval loss: [NA]

Runtime:390.25
[342218230830.3012, 0.5651, 0.1423, 0.1377]
[1.6957, 0.7495, 0.7391, 0.7035]
[2.1881, 0.8708, 0.7538, 0.7538]
tensor(0.7630, grad_fn=<MeanBackward0>)
tensor(0.7169, grad_fn=<MeanBackward0>)
tensor([-2.2508,  0.7484, -1.7287,  1.4168, -0.4122,  2.7320, -1.6647,  1.4786,
        -0.6362,  2.5219], grad_fn=<MeanBackward1>)
tensor([0.3101, 0.3308, 1.1645, 1.2862, 0.3224, 0.3387, 1.1737, 1.2791, 0.3187,
        0.3349], grad_fn=<StdBackward1>)
tensor([-2.4087,  0.9012, -2.2200,  1.1820, -0.3202,  2.8520, -3.0795, -0.1006,
        -0.3906,  2.1908])
KL div untrained: 473802522380.7914
KL div trained: 0.1803
